<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>MySQL_12进阶_视图/存储过程/触发器 | Miraclo</title><meta name="author" content="Miraclo"><meta name="copyright" content="Miraclo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MySQL 视图&#x2F;存储过程&#x2F;触发器 视图介绍 视图（View）是一种虚拟存在的表。视图中的数据并不在数据库中实际存在，行和列数据来自定义视图的查询中使用的表，并且是在使用视图时动态生成的。 通俗的讲，视图只保存了查询的SQL逻辑，不保存查询结果。所以我们在创建视图的时候，主要的工作就落在创建这条SQL查询语句上。 视图语法  创建视图  1CREATE [OR REPLACE] VIEW 视图名称"><meta property="og:type" content="article"><meta property="og:title" content="MySQL_12进阶_视图&#x2F;存储过程&#x2F;触发器"><meta property="og:url" content="http://unicorn-acc.github.io/posts/60264.html"><meta property="og:site_name" content="Miraclo"><meta property="og:description" content="MySQL 视图&#x2F;存储过程&#x2F;触发器 视图介绍 视图（View）是一种虚拟存在的表。视图中的数据并不在数据库中实际存在，行和列数据来自定义视图的查询中使用的表，并且是在使用视图时动态生成的。 通俗的讲，视图只保存了查询的SQL逻辑，不保存查询结果。所以我们在创建视图的时候，主要的工作就落在创建这条SQL查询语句上。 视图语法  创建视图  1CREATE [OR REPLACE] VIEW 视图名称"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://w.wallhaven.cc/full/kx/wallhaven-kx3p1q.jpg"><meta property="article:published_time" content="2022-11-02T23:42:33.000Z"><meta property="article:modified_time" content="2022-12-13T14:47:27.640Z"><meta property="article:author" content="Miraclo"><meta property="article:tag" content="Mysql"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://w.wallhaven.cc/full/kx/wallhaven-kx3p1q.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://unicorn-acc.github.io/posts/60264"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:2e3},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:800,languages:{author:"作者: Miraclo",link:"链接: ",source:"来源: Miraclo",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"MySQL_12进阶_视图/存储过程/触发器",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-12-13 14:47:27"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,a){0!==a&&(a=864e5*a,t={value:t,expiry:(new Date).getTime()+a},localStorage.setItem(e,JSON.stringify(t)))},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);if(!((new Date).getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=o=>new Promise((t,e)=>{const a=document.createElement("script");a.src=o,a.async=!0,a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme"),"dark"===e?activateDarkMode():"light"===e&&activateLightMode(),e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/mouth.css"><link rel="stylesheet" href="/css/codecolor.css"><link rel="stylesheet" href="//s1.hdslb.com/bfs/static/jinkela/long/font/medium.css"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload='this.media="screen"'><meta name="generator" content="Hexo 6.0.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">128</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">23</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-film"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:randomPost();"><i class="fa-fw fa-solid fa-shuffle"></i><span></span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://w.wallhaven.cc/full/kx/wallhaven-kx3p1q.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Miraclo</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-film"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:randomPost();"><i class="fa-fw fa-solid fa-shuffle"></i><span></span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MySQL_12进阶_视图/存储过程/触发器</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2022-11-02T23:42:33.000Z" title="发表于 2022-11-02 23:42:33">2022-11-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93/">关系型数据库</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93/1%E3%80%81Mysql/">1、Mysql</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="MySQL_12进阶_视图/存储过程/触发器"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="mysql-视图存储过程触发器">MySQL 视图/存储过程/触发器</h1><h2 id="视图介绍">视图介绍</h2><p>视图（View）是一种虚拟存在的表。视图中的数据并不在数据库中实际存在，行和列数据来自定义视图的查询中使用的表，并且是在使用视图时动态生成的。</p><p>通俗的讲，视图只保存了查询的SQL逻辑，不保存查询结果。所以我们在创建视图的时候，主要的工作就落在创建这条SQL查询语句上。</p><h2 id="视图语法">视图语法</h2><ol type="1"><li>创建视图</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> [<span class="hljs-keyword">OR</span> REPLACE] <span class="hljs-keyword">VIEW</span> 视图名称[(列名列表)] <span class="hljs-keyword">AS</span> <span class="hljs-keyword">SELECT</span>语句 [ <span class="hljs-keyword">WITH</span> [ <span class="hljs-keyword">CASCADED</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">LOCAL</span> ] <span class="hljs-keyword">CHECK</span> OPTION ]<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>查询视图</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">查看创建视图语句：<span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> 视图名称;<br>查看视图数据：<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> 视图名称 ...... ;<br></code></pre></td></tr></table></figure><ol start="3" type="1"><li>删除视图</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">VIEW</span> [IF <span class="hljs-keyword">EXISTS</span>] 视图名称 [,视图名称] ...<br></code></pre></td></tr></table></figure><p>演示实例：</p><figure class="highlight sql"><figcaption><span>&#123;2,6,14&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--创建视图</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">or</span> replace <span class="hljs-keyword">view</span> user_v_1 <span class="hljs-keyword">as</span> <span class="hljs-keyword">select</span> id,name <span class="hljs-keyword">from</span> tb_user <span class="hljs-keyword">where</span> id <span class="hljs-operator">&lt;=</span> <span class="hljs-number">10</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.01</span> sec)<br><br><span class="hljs-comment">--查询视图</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">view</span> user_v_1;<br><span class="hljs-operator">+</span><span class="hljs-comment">----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">View</span>     <span class="hljs-operator">|</span> <span class="hljs-keyword">Create</span> <span class="hljs-keyword">View</span>                                                                                                                                                                                        <span class="hljs-operator">|</span> character_set_client <span class="hljs-operator">|</span> collation_connection <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+</span><br><span class="hljs-operator">|</span> user_v_1 <span class="hljs-operator">|</span> <span class="hljs-keyword">CREATE</span> ALGORITHM<span class="hljs-operator">=</span>UNDEFINED DEFINER<span class="hljs-operator">=</span>`root`@`localhost` <span class="hljs-keyword">SQL</span> SECURITY DEFINER <span class="hljs-keyword">VIEW</span> `user_v_1` <span class="hljs-keyword">AS</span> <span class="hljs-keyword">select</span> `tb_user`.`id` <span class="hljs-keyword">AS</span> `id`,`tb_user`.`name` <span class="hljs-keyword">AS</span> `name` <span class="hljs-keyword">from</span> `tb_user` <span class="hljs-keyword">where</span> (`tb_user`.`id` <span class="hljs-operator">&lt;=</span> <span class="hljs-number">10</span>) <span class="hljs-operator">|</span> utf8mb4              <span class="hljs-operator">|</span> utf8mb4_0900_ai_ci   <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> user_v_1;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> 吕布      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">2</span> <span class="hljs-operator">|</span> 曹操      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">3</span> <span class="hljs-operator">|</span> 赵云      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">4</span> <span class="hljs-operator">|</span> 孙悟空    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">5</span> <span class="hljs-operator">|</span> 花木兰    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">6</span> <span class="hljs-operator">|</span> 大乔      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">7</span> <span class="hljs-operator">|</span> 露娜      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">8</span> <span class="hljs-operator">|</span> 程咬金    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">9</span> <span class="hljs-operator">|</span> 项羽      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">10</span> <span class="hljs-operator">|</span> 白起      <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-----------+</span><br><span class="hljs-number">10</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br><br><span class="hljs-comment">--修改视图</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">or</span> replace <span class="hljs-keyword">view</span> user_v_1 <span class="hljs-keyword">as</span> <span class="hljs-keyword">select</span> id,name,<span class="hljs-keyword">no</span> <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> id <span class="hljs-operator">&lt;=</span> <span class="hljs-number">10</span>;	<span class="hljs-comment">--或者下面这条语句</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">view</span> user_v_1 <span class="hljs-keyword">as</span> <span class="hljs-keyword">select</span> id,name,profession <span class="hljs-keyword">from</span> tb_user <span class="hljs-keyword">where</span> id <span class="hljs-operator">&lt;=</span> <span class="hljs-number">10</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br><br><span class="hljs-comment">--删除视图</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">drop</span> <span class="hljs-keyword">view</span> if <span class="hljs-keyword">exists</span> user_v_1;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><p>上述我们演示了，视图应该如何创建、查询、修改、删除，那么我们能不能通过视图来插入、更新数据呢？ 接下来，做一个测试。</p><figure class="highlight sql"><figcaption><span>&#123;1,4,21,24,42&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">or</span> replace <span class="hljs-keyword">view</span> stu_v_1 <span class="hljs-keyword">as</span> <span class="hljs-keyword">select</span> id,name <span class="hljs-keyword">from</span> student <span class="hljs-keyword">where</span> id<span class="hljs-operator">&lt;=</span><span class="hljs-number">10</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> stu_v_1;<br><span class="hljs-operator">+</span><span class="hljs-comment">------+-----------+</span><br><span class="hljs-operator">|</span> id   <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+-----------+</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">1</span> <span class="hljs-operator">|</span> 杨过      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">2</span> <span class="hljs-operator">|</span> 小龙女    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">3</span> <span class="hljs-operator">|</span> 小龙女    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">4</span> <span class="hljs-operator">|</span> 小龙女    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">5</span> <span class="hljs-operator">|</span> 丘处机    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">6</span> <span class="hljs-operator">|</span> 郭靖      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">6</span> <span class="hljs-operator">|</span> 孙悟空    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">7</span> <span class="hljs-operator">|</span> 猪八戒    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">8</span> <span class="hljs-operator">|</span> 唐僧      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">9</span> <span class="hljs-operator">|</span> 沙和尚    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>   <span class="hljs-number">10</span> <span class="hljs-operator">|</span> 张无忌    <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+-----------+</span><br><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> stu_v_1 <span class="hljs-keyword">values</span>(<span class="hljs-number">5</span>,<span class="hljs-string">&#x27;frx&#x27;</span>);<br>Query OK, <span class="hljs-number">1</span> <span class="hljs-type">row</span> affected (<span class="hljs-number">0.00</span> sec)<br><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> stu_v_1 <span class="hljs-keyword">values</span>(<span class="hljs-number">13</span>,<span class="hljs-string">&#x27;xustudyxu&#x27;</span>);<br>Query OK, <span class="hljs-number">1</span> <span class="hljs-type">row</span> affected (<span class="hljs-number">0.01</span> sec)<br><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> stu_v_1;<br><span class="hljs-operator">+</span><span class="hljs-comment">------+-----------+</span><br><span class="hljs-operator">|</span> id   <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+-----------+</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">1</span> <span class="hljs-operator">|</span> 杨过      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">2</span> <span class="hljs-operator">|</span> 小龙女    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">3</span> <span class="hljs-operator">|</span> 小龙女    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">4</span> <span class="hljs-operator">|</span> 小龙女    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">5</span> <span class="hljs-operator">|</span> 丘处机    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">6</span> <span class="hljs-operator">|</span> 郭靖      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">6</span> <span class="hljs-operator">|</span> 孙悟空    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">7</span> <span class="hljs-operator">|</span> 猪八戒    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">8</span> <span class="hljs-operator">|</span> 唐僧      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">9</span> <span class="hljs-operator">|</span> 沙和尚    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>   <span class="hljs-number">10</span> <span class="hljs-operator">|</span> 张无忌    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">5</span> <span class="hljs-operator">|</span> frx       <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+-----------+</span><br><span class="hljs-number">12</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><p>执行上述的SQL，我们会发现，id为5和13的数据都是可以成功插入的。 但是我们执行查询，查询出来的数据，却没有id为13的记录。</p><p>因为我们在创建视图的时候，指定的条件为 <code>id&lt;=10</code>, <code>id</code>为<code>13</code>的数据，是不符合条件的，所以没有查询出来，但是这条数据确实是已经成功的插入到了基表中。</p><figure class="highlight sql"><figcaption><span>&#123;1,17,18&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> student;<br><span class="hljs-operator">+</span><span class="hljs-comment">------+-----------+-------+</span><br><span class="hljs-operator">|</span> id   <span class="hljs-operator">|</span> name      <span class="hljs-operator">|</span> stuId <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+-----------+-------+</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">1</span> <span class="hljs-operator">|</span> 杨过      <span class="hljs-operator">|</span>     <span class="hljs-number">1</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">2</span> <span class="hljs-operator">|</span> 小龙女    <span class="hljs-operator">|</span>     <span class="hljs-number">2</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">3</span> <span class="hljs-operator">|</span> 小龙女    <span class="hljs-operator">|</span>     <span class="hljs-number">3</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">4</span> <span class="hljs-operator">|</span> 小龙女    <span class="hljs-operator">|</span>     <span class="hljs-number">4</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">5</span> <span class="hljs-operator">|</span> 丘处机    <span class="hljs-operator">|</span>     <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">6</span> <span class="hljs-operator">|</span> 郭靖      <span class="hljs-operator">|</span>     <span class="hljs-number">6</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">6</span> <span class="hljs-operator">|</span> 孙悟空    <span class="hljs-operator">|</span>     <span class="hljs-number">6</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">7</span> <span class="hljs-operator">|</span> 猪八戒    <span class="hljs-operator">|</span>     <span class="hljs-number">7</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">8</span> <span class="hljs-operator">|</span> 唐僧      <span class="hljs-operator">|</span>     <span class="hljs-number">8</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">9</span> <span class="hljs-operator">|</span> 沙和尚    <span class="hljs-operator">|</span>     <span class="hljs-number">9</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>   <span class="hljs-number">10</span> <span class="hljs-operator">|</span> 张无忌    <span class="hljs-operator">|</span>    <span class="hljs-number">10</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>   <span class="hljs-number">11</span> <span class="hljs-operator">|</span> 刘备      <span class="hljs-operator">|</span>    <span class="hljs-number">11</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">5</span> <span class="hljs-operator">|</span> frx       <span class="hljs-operator">|</span>  <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>   <span class="hljs-number">13</span> <span class="hljs-operator">|</span> xustudyxu <span class="hljs-operator">|</span>  <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+-----------+-------+</span><br><span class="hljs-number">14</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><p>如果我们定义视图时，如果指定了条件，然后我们在插入、修改、删除数据时，<strong>是否可以做到必须满足条件才能操作，否则不能够操作呢</strong>？答案是可以的，这就需要借助于<mark>视图的检查选项</mark>了。</p><h2 id="检查选项">检查选项</h2><p>当使用WITH CHECK OPTION子句创建视图时，MySQL会通过视图检查正在更改的每个行，例如 插入，更新，删除，以使其符合视图的定义。 MySQL允许基于另一个视图创建视图，它还会检查依赖视图中的规则以保持一致性。为了确定检查的范围，mysql提供了两个选项： <code>CASCADED</code> 和<code>LOCAL</code>，<mark>默认值为 CASCADED</mark> 。</p><ol type="1"><li><code>CASCADED</code> 级联</li></ol><p>比如，v2视图是基于v1视图的，如果在v2视图创建的时候指定了检查选项为 cascaded，但是v1视图创建时<font color="red">未</font>指定检查选项。 则在执行检查时，<strong>不仅会检查v2，还会级联检查v2的关联视图v1</strong>。</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs/202211111645662.webp" style="zoom:80%"></p><ol start="2" type="1"><li><code>LOCAL</code> 本地</li></ol><p>比如，v2视图是基于v1视图的，如果在v2视图创建的时候指定了检查选项为 local ，但是v1视图创建时<font color="red">未</font>指定检查选项。 则在执行检查时，<strong>只会检查v2，不会检查v2的关联视图v1</strong>。如果<strong>v1视图创建时指令检查选项，则会执行检查</strong>。</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs/202211111645959.webp" style="zoom:80%"></p><h2 id="视图的更新">视图的更新</h2><p>要使视图可更新，<strong>视图中的行与基础表中的行之间必须存在一对一的关系</strong>。如果视图包含以下任何一项，则该视图不可更新：</p><ol type="1"><li>聚合函数或窗口函数（SUM()、 MIN()、 MAX()、 COUNT()等）</li><li>DISTINCT</li><li>GROUP BY</li><li>HAVING</li><li>UNION 或者 UNION ALL</li></ol><p>案例演示:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">view</span> stu_v_count <span class="hljs-keyword">as</span> <span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> student;<br></code></pre></td></tr></table></figure><p>上述的视图中，就只有一个单行单列的数据，如果我们对这个视图进行更新或插入的，将会报错。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> stu_v_count <span class="hljs-keyword">values</span>(<span class="hljs-number">10</span>);<br></code></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs/202211111646593.webp"></p><h2 id="视图作用">视图作用</h2><ol type="1"><li>简单</li></ol><p>视图不仅可以简化用户对数据的理解，也可以简化他们的操作。那些被经常使用的查询可以被定义为视图，从而使得用户不必为以后的操作每次指定全部的条件。</p><ol start="2" type="1"><li>安全</li></ol><p>数据库可以授权，但不能授权到数据库特定行和特定的列上。通过视图用户只能查询和修改他们所能见到的数据。</p><ol start="3" type="1"><li>数据独立</li></ol><p>视图可帮助用户屏蔽真实表结构变化带来的影响。</p><h2 id="案例">案例</h2><ol type="1"><li>为了保证数据库表的安全性，开发人员在操作tb_user表时，只能看到的用户的基本字段，屏蔽手机号和邮箱两个字段。</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">view</span> tb_user_view <span class="hljs-keyword">as</span> <span class="hljs-keyword">select</span> id,name,profession,age,gender,status,createtime <span class="hljs-keyword">from</span> tb_user;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> tb_user_view;<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>查询每个学生所选修的课程（三张表联查），这个功能在很多的业务中都有使用到，为了简化操作，定义一个视图。</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">view</span> tb_stu_course_view <span class="hljs-keyword">as</span> <span class="hljs-keyword">select</span> s.name student_name , s.no student_no , c.name course_name <span class="hljs-keyword">from</span> student s, student_course sc , course c <span class="hljs-keyword">where</span> s.id <span class="hljs-operator">=</span> sc.studentid <span class="hljs-keyword">and</span> sc.courseid <span class="hljs-operator">=</span> c.id;<br><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> tb_stu_course_view;<br></code></pre></td></tr></table></figure><h2 id="存储过程">存储过程</h2><h3 id="介绍">介绍</h3><p>存储过程是事先经过编译并存储在数据库中的一段 SQL 语句的集合，调用存储过程可以简化应用开发人员的很多工作，减少数据在数据库和应用服务器之间的传输，对于提高数据处理的效率是有好处的。</p><p>存储过程思想上很简单，就是数据库 SQL 语言层面的代码封装与重用。</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs/202211111646772.webp" style="zoom:80%"></p><p>特点:</p><ul><li>封装，复用 --------------------------------------&gt; 可以把某一业务SQL封装在存储过程中，需要用到的时候直接调用即可。</li><li>可以接收参数，也可以返回数据 ----------&gt; 再存储过程中，可以传递参数，也可以接收返回值。</li><li>减少网络交互，效率提升 -------------------&gt; 如果涉及到多条SQL，每执行一次都是一次网络传输。 而如果封装在存储过程中，我们只需要网络交互一次可能就可以了。</li></ul><h3 id="基本语法">基本语法</h3><ol type="1"><li>创建</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> 存储过程名称 ([ 参数列表 ])<br><span class="hljs-keyword">BEGIN</span><br>	<span class="hljs-comment">-- SQL语句</span><br><span class="hljs-keyword">END</span> ;<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>调用</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CALL</span> 名称 ([ 参数 ]);<br></code></pre></td></tr></table></figure><ol start="3" type="1"><li>查看</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> INFORMATION_SCHEMA.ROUTINES <span class="hljs-keyword">WHERE</span> ROUTINE_SCHEMA <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;xxx&#x27;</span>; <span class="hljs-comment">-- 查询指定数据库的存储过程及状态信息</span><br><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> 存储过程名称 ; <span class="hljs-comment">-- 查询某个存储过程的定义</span><br></code></pre></td></tr></table></figure><ol start="4" type="1"><li>删除</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">PROCEDURE</span> [ IF <span class="hljs-keyword">EXISTS</span> ] 存储过程名称 ；<br></code></pre></td></tr></table></figure><blockquote><p>tip 注意:</p><p>在命令行中，执行创建存储过程的SQL时，需要通过关键字 <code>delimiter</code> 指定SQL语句的结束符。</p></blockquote><ul><li>演示案例</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 存储过程基本语法</span><br><span class="hljs-comment">-- 创建</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span> p1()<br><span class="hljs-keyword">begin</span><br>	<span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> student;<br><span class="hljs-keyword">end</span>;<br><span class="hljs-comment">-- 调用</span><br><span class="hljs-keyword">call</span> p1()<br><br><span class="hljs-comment">-- 查看</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> information_schema.ROUTINES <span class="hljs-keyword">where</span> ROUTINE_SCHEMA <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;MySQL_Advanced&#x27;</span>;<br><br><span class="hljs-keyword">show</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span> p1;<br><br><span class="hljs-comment">-- 删除</span><br><span class="hljs-keyword">drop</span> <span class="hljs-keyword">procedure</span> if <span class="hljs-keyword">exists</span> p1;<br></code></pre></td></tr></table></figure><h3 id="变量">变量</h3><p>在MySQL中变量分为三种类型: 系统变量、用户定义变量、局部变量。</p><h4 id="系统变量">系统变量</h4><p>系统变量 是MySQL服务器提供，不是用户定义的，属于服务器层面。分为全局变量（<code>GLOBAL</code>）、会话变量（<code>SESSION</code>）。</p><ol type="1"><li>查看系统变量</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SHOW</span> [ SESSION <span class="hljs-operator">|</span> <span class="hljs-keyword">GLOBAL</span> ] VARIABLES ;               <span class="hljs-comment">-- 查看所有系统变量</span><br><span class="hljs-keyword">SHOW</span> [ SESSION <span class="hljs-operator">|</span> <span class="hljs-keyword">GLOBAL</span> ] VARIABLES <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;......&#x27;</span>;  <span class="hljs-comment">-- 可以通过LIKE模糊匹配方式查找变量</span><br><span class="hljs-keyword">SELECT</span> @@[SESSION <span class="hljs-operator">|</span> <span class="hljs-keyword">GLOBAL</span>] 系统变量名;               <span class="hljs-comment">-- 查看指定变量的值</span><br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>设置系统变量</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SET</span> [ SESSION <span class="hljs-operator">|</span> <span class="hljs-keyword">GLOBAL</span> ] 系统变量名 <span class="hljs-operator">=</span> 值 ;<br><span class="hljs-keyword">SET</span> @@[SESSION <span class="hljs-operator">|</span> <span class="hljs-keyword">GLOBAL</span>]系统变量名 <span class="hljs-operator">=</span> 值 ;<br></code></pre></td></tr></table></figure><p>::: tip 注意:</p><p>如果没有指定<code>SESSION/GLOBAL</code>，默认是<code>SESSION</code>，会话变量。</p><p>mysql服务重新启动之后，所设置的全局参数会失效，要想不失效，可以在 <code>/etc/my.cnf</code>中配置。</p><ul><li>全局变量(GLOBAL): 全局变量针对于所有的会话。</li><li>会话变量(SESSION): 会话变量针对于单个会话，在另外一个会话窗口就不生效了。</li></ul><p>:::</p><p>演示案例：</p><figure class="highlight sql"><figcaption><span>&#123;10,14&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 查看全局系统变量</span><br><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">GLOBAL</span> VARIABLES;<br><span class="hljs-keyword">SHOW</span> SESSION VARIABLES;<br><br><span class="hljs-comment">-- 查看事务提交的开关</span><br><span class="hljs-keyword">SHOW</span> SESSION VARIABLES <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;auto%&#x27;</span>;<br><br><span class="hljs-comment">-- 查看指定变量</span><br><span class="hljs-keyword">SELECT</span> @<span class="hljs-variable">@SESSION</span>.autocommit;<br><span class="hljs-keyword">SET</span> SESSION autocommit<span class="hljs-operator">=</span><span class="hljs-number">0</span>;<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> student <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">18</span>,&quot;小红&quot;,<span class="hljs-number">18</span>);<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> student;<br><span class="hljs-comment">-- 只有手动提交事务后，其他的会话才能查询到小红这条记录</span><br><span class="hljs-keyword">COMMIT</span>;<br></code></pre></td></tr></table></figure><h4 id="用户定义变量">用户定义变量</h4><p>用户定义变量 是用户根据需要自己定义的变量，用户变量不用提前声明，在用的时候直接用 "<span class="citation" data-cites="变量名">@变量名</span>" 使用就可以。其<mark>作用域为当前连接</mark>。</p><ol type="1"><li>赋值</li></ol><p>方式一:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SET</span> <span class="hljs-variable">@var</span>_name <span class="hljs-operator">=</span> expr [, <span class="hljs-variable">@var</span>_name <span class="hljs-operator">=</span> expr] ... ;<br><span class="hljs-keyword">SET</span> <span class="hljs-variable">@var</span>_name :<span class="hljs-operator">=</span> expr [, <span class="hljs-variable">@var</span>_name :<span class="hljs-operator">=</span> expr] ... ;<br></code></pre></td></tr></table></figure><p>赋值时，可以使用<code>=</code> ，也可以使用<code>:=</code> ,推荐使用<code>:=</code>。</p><p>方式二:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@var</span>_name :<span class="hljs-operator">=</span> expr [, <span class="hljs-variable">@var</span>_name :<span class="hljs-operator">=</span> expr] ... ;<br><span class="hljs-keyword">SELECT</span> 字段名 <span class="hljs-keyword">INTO</span> <span class="hljs-variable">@var</span>_name <span class="hljs-keyword">FROM</span> 表名;<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>使用</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@var</span>_name ;<br></code></pre></td></tr></table></figure><p>::: tip 注意:</p><p>用户定义的变量无需对其进行声明或初始化，只不过获取到的值为NULL。</p><p>:::</p><p>演示案例:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 用户变量</span><br><span class="hljs-keyword">SET</span> <span class="hljs-variable">@myname</span> <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;xustudyxu&#x27;</span>;<br><span class="hljs-keyword">set</span> <span class="hljs-variable">@myage</span> :<span class="hljs-operator">=</span> <span class="hljs-number">21</span>;<br><span class="hljs-keyword">set</span> <span class="hljs-variable">@mygender</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;男&#x27;</span>,<span class="hljs-variable">@myhobby</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;java&#x27;</span>;<br><br><span class="hljs-keyword">select</span> <span class="hljs-variable">@mycolor</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;red&#x27;</span>;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">into</span> <span class="hljs-variable">@mycount</span> <span class="hljs-keyword">from</span> student;<br><br><span class="hljs-comment">-- 使用</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@myname</span>,<span class="hljs-variable">@myage</span>,<span class="hljs-variable">@mygender</span>;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@mycolor</span>,<span class="hljs-variable">@mycount</span>;<br></code></pre></td></tr></table></figure><h4 id="局部变量">局部变量</h4><p><mark>局部变量</mark>是根据需要定义的在局部生效的变量，访问之前，需要<code>DECLARE</code>声明。可用作存储过程内的局部变量和输入参数，局部变量的范围是在其内声明的BEGIN ... END块。</p><ol type="1"><li>声明</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DECLARE</span> 变量名 变量类型 [<span class="hljs-keyword">DEFAULT</span> ... ] ;<br></code></pre></td></tr></table></figure><p>变量类型就是数据库字段类型：INT、BIGINT、CHAR、VARCHAR、DATE、TIME等。</p><ol start="2" type="1"><li>赋值</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SET</span> 变量名 <span class="hljs-operator">=</span> 值 ;<br><span class="hljs-keyword">SET</span> 变量名 :<span class="hljs-operator">=</span> 值 ;<br><span class="hljs-keyword">SELECT</span> 字段名 <span class="hljs-keyword">INTO</span> 变量名 <span class="hljs-keyword">FROM</span> 表名 ... ;<br></code></pre></td></tr></table></figure><p>演示实例:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 声明局部变量 - declare</span><br><span class="hljs-comment">-- 赋值</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">PROCEDURE</span> p2()<br><span class="hljs-keyword">begin</span><br>		<span class="hljs-keyword">declare</span> stu_count <span class="hljs-type">int</span> <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>;<br>		<span class="hljs-keyword">set</span> stu_count :<span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<br>		<span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">into</span> stu_count <span class="hljs-keyword">from</span> student;<br>		<span class="hljs-keyword">select</span> stu_count;<br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">call</span> p2();<br></code></pre></td></tr></table></figure><h3 id="if-判断">if 判断</h3><ol type="1"><li>介绍</li></ol><p>if 用于做条件判断，具体的语法结构为：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">IF 条件<span class="hljs-number">1</span> <span class="hljs-keyword">THEN</span><br>	.....<br>ELSEIF 条件<span class="hljs-number">2</span> <span class="hljs-keyword">THEN</span>     <span class="hljs-comment">-- 可选</span><br>	.....<br><span class="hljs-keyword">ELSE</span> 				 <span class="hljs-comment">-- 可选</span><br>	.....<br><span class="hljs-keyword">END</span> IF;<br></code></pre></td></tr></table></figure><p>在if条件判断的结构中，ELSE IF 结构可以有多个，也可以没有。 ELSE结构可以有，也可以没有。</p><ol start="2" type="1"><li>案例</li></ol><p>根据定义的分数score变量，判定当前分数对应的分数等级。</p><ul><li>score &gt;= 85分，等级为优秀。</li><li>score &gt;= 60分 且 score &lt; 85分，等级为及格。</li><li>score &lt; 60分，等级为不及格。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">PROCEDURE</span> p3()<br><span class="hljs-keyword">begin</span> <br>		<span class="hljs-keyword">declare</span> score <span class="hljs-type">int</span> <span class="hljs-keyword">default</span> <span class="hljs-number">68</span>;<br>		<span class="hljs-keyword">declare</span> <span class="hljs-keyword">result</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>);<br>		<br>		if score <span class="hljs-operator">&lt;</span> <span class="hljs-number">60</span> <span class="hljs-keyword">then</span><br>				<span class="hljs-keyword">set</span> <span class="hljs-keyword">result</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;不及格&#x27;</span>;<br>		elseif score <span class="hljs-operator">&lt;</span> <span class="hljs-number">85</span> <span class="hljs-keyword">then</span><br>				<span class="hljs-keyword">set</span> <span class="hljs-keyword">result</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;及格&#x27;</span>;<br>		<span class="hljs-keyword">else</span><br>				<span class="hljs-keyword">set</span> <span class="hljs-keyword">result</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;优秀&#x27;</span>;<br>		<span class="hljs-keyword">end</span> if;<br>		<br>		<span class="hljs-keyword">select</span> <span class="hljs-keyword">result</span>;<br><span class="hljs-keyword">end</span>;<br><br><span class="hljs-keyword">call</span> p3();<br></code></pre></td></tr></table></figure><p>上述的需求我们虽然已经实现了，但是也存在一些问题，比如：score 分数我们是在存储过程中定义死的，而且最终计算出来的分数等级，我们也仅仅是最终查询展示出来而已。</p><p>那么我们能不能，把score分数动态的传递进来，计算出来的分数等级是否可以作为返回值返回呢？答案是肯定的，我们可以通过接下来所学习的 参数 来解决上述的问题。</p><h3 id="参数">参数</h3><ol type="1"><li>介绍</li></ol><p>参数的类型，主要分为以下三种：IN、OUT、INOUT。 具体的含义如下：</p><table><thead><tr class="header"><th>类型</th><th>含义</th><th>备注</th></tr></thead><tbody><tr class="odd"><td>IN</td><td>该类参数作为输入，也就是需要调用时传入值</td><td>默认</td></tr><tr class="even"><td>OUT</td><td>该类参数作为输出，也就是该参数可以作为返回值</td><td></td></tr><tr class="odd"><td>INOUT</td><td>既可以作为输入参数，也可以作为输出参数</td><td></td></tr></tbody></table><p>用法：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> 存储过程名称 ([ <span class="hljs-keyword">IN</span><span class="hljs-operator">/</span><span class="hljs-keyword">OUT</span><span class="hljs-operator">/</span><span class="hljs-keyword">INOUT</span> 参数名 参数类型 ])<br><span class="hljs-keyword">BEGIN</span><br>	<span class="hljs-comment">-- SQL语句</span><br><span class="hljs-keyword">END</span> ;<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>案例一</li></ol><p>根据传入参数score，判定当前分数对应的分数等级，并返回。 + score &gt;= 85分，等级为优秀。 + score &gt;= 60分 且 score &lt; 85分，等级为及格。 + score &lt; 60分，等级为不及格。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span> p4(<span class="hljs-keyword">in</span> score <span class="hljs-type">int</span>,<span class="hljs-keyword">out</span> <span class="hljs-keyword">result</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>))<br><span class="hljs-keyword">begin</span> <br>		if score <span class="hljs-operator">&lt;</span> <span class="hljs-number">60</span> <span class="hljs-keyword">then</span><br>				<span class="hljs-keyword">set</span> <span class="hljs-keyword">result</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;不及格&#x27;</span>;<br>		elseif score <span class="hljs-operator">&lt;</span> <span class="hljs-number">85</span> <span class="hljs-keyword">then</span><br>				<span class="hljs-keyword">set</span> <span class="hljs-keyword">result</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;及格&#x27;</span>;<br>		<span class="hljs-keyword">else</span><br>				<span class="hljs-keyword">set</span> <span class="hljs-keyword">result</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;优秀&#x27;</span>;<br>		<span class="hljs-keyword">end</span> if;<br><span class="hljs-keyword">end</span>;<br><br><span class="hljs-comment">-- 定义用户变量 @result来接收返回的数据, 用户变量可以不用声明</span><br><span class="hljs-keyword">call</span> p4(<span class="hljs-number">76</span>,<span class="hljs-variable">@result</span>);<br><br><span class="hljs-keyword">select</span> <span class="hljs-variable">@result</span>;<br></code></pre></td></tr></table></figure><ol start="3" type="1"><li>案例二</li></ol><p>将<strong>传入</strong>的200分制的分数，进行换算，换算成百分制，然后<strong>返回</strong>。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span> p5(<span class="hljs-keyword">inout</span> score <span class="hljs-keyword">double</span>)<br><span class="hljs-keyword">begin</span> <br>	<span class="hljs-keyword">set</span> score :<span class="hljs-operator">=</span> score<span class="hljs-operator">*</span><span class="hljs-number">0.5</span>;<br><span class="hljs-keyword">end</span>;<br><br><span class="hljs-keyword">set</span> <span class="hljs-variable">@score</span> :<span class="hljs-operator">=</span> <span class="hljs-number">198</span>;<br><span class="hljs-keyword">call</span> p5(<span class="hljs-variable">@score</span>);<br><br><span class="hljs-keyword">select</span> <span class="hljs-variable">@score</span>;<br></code></pre></td></tr></table></figure><h3 id="case">case</h3><ol type="1"><li>语法</li></ol><p>case结构及作用，和我们在基础篇中所讲解的流程控制函数很类似。有两种语法格式：</p><p>语法1：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 含义： 当case_value的值为 when_value1时，执行statement_list1，当值为 when_value2时，执行statement_list2， 否则就执行 statement_list</span><br><span class="hljs-keyword">CASE</span> case_value<br>	<span class="hljs-keyword">WHEN</span> when_value1 <span class="hljs-keyword">THEN</span> statement_list1<br>	[ <span class="hljs-keyword">WHEN</span> when_value2 <span class="hljs-keyword">THEN</span> statement_list2] ...<br>	[ <span class="hljs-keyword">ELSE</span> statement_list ]<br><span class="hljs-keyword">END</span> <span class="hljs-keyword">CASE</span>;<br></code></pre></td></tr></table></figure><p>语法2：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 含义： 当条件search_condition1成立时，执行statement_list1，当条件search_condition2成立时，执行statement_list2， 否则就执行 statement_list</span><br><span class="hljs-keyword">CASE</span><br>	<span class="hljs-keyword">WHEN</span> search_condition1 <span class="hljs-keyword">THEN</span> statement_list1<br>	[<span class="hljs-keyword">WHEN</span> search_condition2 <span class="hljs-keyword">THEN</span> statement_list2] ...<br>	[<span class="hljs-keyword">ELSE</span> statement_list]<br><span class="hljs-keyword">END</span> <span class="hljs-keyword">CASE</span>;<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>案例</li></ol><p>根据传入的月份，判定月份所属的季节（要求采用case结构）。</p><ul><li>1-3月份，为第一季度</li><li>4-6月份，为第二季度</li><li>7-9月份，为第三季度</li><li>10-12月份，为第四季度</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span> p6(<span class="hljs-keyword">in</span> <span class="hljs-keyword">month</span> <span class="hljs-type">int</span>)<br><span class="hljs-keyword">begin</span><br>		<span class="hljs-keyword">declare</span> <span class="hljs-keyword">result</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>);<br>		<span class="hljs-keyword">case</span><br>		<span class="hljs-keyword">when</span> <span class="hljs-keyword">month</span> <span class="hljs-operator">&gt;=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">month</span> <span class="hljs-operator">&lt;=</span><span class="hljs-number">3</span> <span class="hljs-keyword">then</span><br>				<span class="hljs-keyword">set</span> <span class="hljs-keyword">result</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;第一季度&#x27;</span>;<br>		<span class="hljs-keyword">when</span> <span class="hljs-keyword">month</span> <span class="hljs-operator">&gt;=</span><span class="hljs-number">4</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">month</span> <span class="hljs-operator">&lt;=</span><span class="hljs-number">6</span> <span class="hljs-keyword">then</span><br>				<span class="hljs-keyword">set</span> <span class="hljs-keyword">result</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;第二季度&#x27;</span>;<br>		<span class="hljs-keyword">when</span> <span class="hljs-keyword">month</span> <span class="hljs-operator">&gt;=</span><span class="hljs-number">7</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">month</span> <span class="hljs-operator">&lt;=</span><span class="hljs-number">9</span> <span class="hljs-keyword">then</span> <br>				<span class="hljs-keyword">set</span> <span class="hljs-keyword">result</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;第三季度&#x27;</span>;<br>		<span class="hljs-keyword">when</span> <span class="hljs-keyword">month</span><span class="hljs-operator">&gt;=</span><span class="hljs-number">10</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">month</span> <span class="hljs-operator">&lt;=</span><span class="hljs-number">12</span> <span class="hljs-keyword">then</span><br>				<span class="hljs-keyword">set</span> <span class="hljs-keyword">result</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;第四季度&#x27;</span>;<br>		<span class="hljs-keyword">else</span><br>				<span class="hljs-keyword">set</span> <span class="hljs-keyword">result</span> :<span class="hljs-operator">=</span> <span class="hljs-string">&#x27;非法参数&#x27;</span>;<br>		<span class="hljs-keyword">end</span> <span class="hljs-keyword">case</span>;<br>		<br>		<span class="hljs-keyword">select</span> concat(<span class="hljs-string">&#x27;您输入的月份:&#x27;</span>,<span class="hljs-keyword">month</span>,<span class="hljs-string">&#x27;,所属的季度为:&#x27;</span>,<span class="hljs-keyword">result</span>);<br><span class="hljs-keyword">end</span>;<br><br><span class="hljs-keyword">call</span> p6(<span class="hljs-number">11</span>);<br></code></pre></td></tr></table></figure><div class="tip"><p>注意：如果判定条件有多个，多个条件之间，可以使用 and 或 or 进行连接。</p></div><h3 id="while">while</h3><ol type="1"><li>介绍</li></ol><p>while 循环是有条件的循环控制语句。满足条件后，再执行循环体中的SQL语句。具体语法为：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 先判定条件，如果条件为true，则执行逻辑，否则，不执行逻辑</span><br>WHILE 条件 DO<br>	<span class="hljs-keyword">SQL</span>逻辑...<br><span class="hljs-keyword">END</span> WHILE;<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>案例</li></ol><p>计算从1累加到n的值，n为传入的参数值。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- A. 定义局部变量, 记录累加之后的值;</span><br><span class="hljs-comment">-- B. 每循环一次, 就会对n进行减1 , 如果n减到0, 则退出循环</span><br><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span> p7(<span class="hljs-keyword">in</span> n <span class="hljs-type">int</span>)<br><span class="hljs-keyword">begin</span><br>		<span class="hljs-keyword">declare</span> total <span class="hljs-type">int</span> <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>;<br>		<br>		while n<span class="hljs-operator">&gt;</span><span class="hljs-number">0</span> do<br>			<span class="hljs-keyword">set</span> total :<span class="hljs-operator">=</span> total <span class="hljs-operator">+</span> n;<br>			<span class="hljs-keyword">set</span> n :<span class="hljs-operator">=</span> n<span class="hljs-number">-1</span>;<br>		<span class="hljs-keyword">end</span> while;<br>		<br>		<span class="hljs-keyword">select</span> total;<br><span class="hljs-keyword">end</span>;<br><br><span class="hljs-keyword">call</span> p7(<span class="hljs-number">100</span>);<br></code></pre></td></tr></table></figure><h3 id="repeat">repeat</h3><ol type="1"><li>介绍</li></ol><p>repeat是有条件的循环控制语句, 当满足<code>until</code>声明的条件的时候，则退出循环 。具体语法为：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 先执行一次逻辑，然后判定UNTIL条件是否满足，如果满足，则退出。如果不满足，则继续下一次循环</span><br>REPEAT<br>	<span class="hljs-keyword">SQL</span>逻辑...<br>	UNTIL 条件<br><span class="hljs-keyword">END</span> REPEAT;<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>案例</li></ol><p>计算从1累加到n的值，n为传入的参数值。(使用repeat实现)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- A. 定义局部变量, 记录累加之后的值;</span><br><span class="hljs-comment">-- B. 每循环一次, 就会对n进行-1 , 如果n减到0, 则退出循环</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span> p8(<span class="hljs-keyword">in</span> n <span class="hljs-type">int</span>)<br><span class="hljs-keyword">begin</span><br>	<span class="hljs-keyword">declare</span> total <span class="hljs-type">int</span> <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>;<br>	<br>	repeat<br>			<span class="hljs-keyword">set</span> total :<span class="hljs-operator">=</span> total <span class="hljs-operator">+</span> n;<br>			<span class="hljs-keyword">set</span> n :<span class="hljs-operator">=</span> n <span class="hljs-operator">-</span> <span class="hljs-number">1</span>;<br>	until n <span class="hljs-operator">&lt;=</span><span class="hljs-number">0</span><br>	<span class="hljs-keyword">end</span> repeat;<br>	<br>	<span class="hljs-keyword">select</span> total;<br><span class="hljs-keyword">end</span>;<br><br><span class="hljs-keyword">call</span> p8(<span class="hljs-number">100</span>);		<br></code></pre></td></tr></table></figure><h3 id="loop">loop</h3><ol type="1"><li>介绍</li></ol><p>LOOP 实现简单的循环，如果不在SQL逻辑中增加退出循环的条件，可以用其来实现简单的死循环。LOOP可以配合一下两个语句使用：</p><ul><li>LEAVE ：配合循环使用，退出循环。</li><li>ITERATE：必须用在循环中，作用是跳过当前循环剩下的语句，直接进入下一次循环。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">[begin_label:] LOOP<br>	<span class="hljs-keyword">SQL</span>逻辑...<br><span class="hljs-keyword">END</span> LOOP [end_label];<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">LEAVE label; 		<span class="hljs-comment">-- 退出指定标记的循环体</span><br>ITERATE label; 		<span class="hljs-comment">-- 直接进入下一次循环</span><br></code></pre></td></tr></table></figure><p>上述语法中出现的 begin_label，end_label，label 指的都是我们所自定义的标记。</p><ol start="2" type="1"><li><p>案例一</p><p>计算从1累加到n的值，n为传入的参数值。</p></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- A. 定义局部变量, 记录累加之后的值;</span><br><span class="hljs-comment">-- B. 每循环一次, 就会对n进行-1 , 如果n减到0, 则退出循环 ----&gt; leave x</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span> p9(<span class="hljs-keyword">in</span> n <span class="hljs-type">int</span>)<br><span class="hljs-keyword">begin</span> <br>		<span class="hljs-keyword">declare</span> total <span class="hljs-type">int</span> <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>;<br>		<br>		sum:loop<br>				if n<span class="hljs-operator">&lt;=</span><span class="hljs-number">0</span> <span class="hljs-keyword">then</span><br>						leave sum;<br>				<span class="hljs-keyword">end</span> if;<br>				<br>				<span class="hljs-keyword">set</span> total :<span class="hljs-operator">=</span> total <span class="hljs-operator">+</span> n;<br>				<span class="hljs-keyword">set</span> n :<span class="hljs-operator">=</span> n <span class="hljs-operator">-</span> <span class="hljs-number">1</span>;<br>		<span class="hljs-keyword">end</span> loop sum;<br>		<br>		<span class="hljs-keyword">select</span> total;<br><span class="hljs-keyword">end</span>;<br><br><span class="hljs-keyword">call</span> p9(<span class="hljs-number">10</span>);<br></code></pre></td></tr></table></figure><ol start="3" type="1"><li><p>案例二</p><p>计算从1到n之间的偶数累加的值，n为传入的参数值。</p></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- A. 定义局部变量, 记录累加之后的值;</span><br><span class="hljs-comment">-- B. 每循环一次, 就会对n进行-1 , 如果n减到0, 则退出循环 ----&gt; leave xx</span><br><span class="hljs-comment">-- C. 如果当次累加的数据是奇数, 则直接进入下一次循环. --------&gt; iterate xx</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span> p10(<span class="hljs-keyword">in</span> n <span class="hljs-type">int</span>)<br><span class="hljs-keyword">begin</span><br>		<span class="hljs-keyword">declare</span> total <span class="hljs-type">int</span> <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>;<br>		sum:loop<br>				if n<span class="hljs-operator">&lt;=</span><span class="hljs-number">0</span> <span class="hljs-keyword">then</span><br>					leave sum;<br>				<span class="hljs-keyword">end</span> if;						<br>				if n<span class="hljs-operator">%</span><span class="hljs-number">2</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">then</span><br>					<span class="hljs-keyword">set</span> n :<span class="hljs-operator">=</span> n <span class="hljs-operator">-</span> <span class="hljs-number">1</span>;<br>					iterate sum;<br>				<span class="hljs-keyword">end</span> if;	<br>				<span class="hljs-keyword">set</span> total :<span class="hljs-operator">=</span> total <span class="hljs-operator">+</span> n;<br>				<span class="hljs-keyword">set</span> n :<span class="hljs-operator">=</span> n <span class="hljs-operator">-</span> <span class="hljs-number">1</span>;<br>		<span class="hljs-keyword">end</span> loop sum;<br>		<span class="hljs-keyword">select</span> total;<br><span class="hljs-keyword">end</span>;<br><br><span class="hljs-keyword">call</span> p10(<span class="hljs-number">10</span>);<br></code></pre></td></tr></table></figure><h3 id="游标">游标</h3><ol type="1"><li>介绍</li></ol><p><strong>游标（CURSOR）</strong>是用来存储<mark>查询结果集</mark>的<strong>数据类型</strong> , 在存储过程和函数中可以使用游标对结果集进行循环的处理。游标的使用包括游标的声明、<code>OPEN</code>、<code>FETCH</code> 和 <code>CLOSE</code>，其语法分别如下。</p><ol type="A"><li>声明游标</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DECLARE</span> 游标名称 <span class="hljs-keyword">CURSOR</span> <span class="hljs-keyword">FOR</span> 查询语句 ;<br></code></pre></td></tr></table></figure><p>B. 打开游标</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">OPEN</span> 游标名称 ;<br></code></pre></td></tr></table></figure><p>C. 获取游标记录</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">FETCH</span> 游标名称 <span class="hljs-keyword">INTO</span> 变量 [, 变量 ] ;<br></code></pre></td></tr></table></figure><p>D. 关闭游标</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CLOSE</span> 游标名称 ;<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>案例</li></ol><p>根据传入的参数uage，来查询用户表tb_user中，所有的用户年龄小于等于uage的用户姓名（name）和专业（profession），并将用户的姓名和专业插入到所创建的一张新表(id,name,profession)中。</p><figure class="highlight sql"><figcaption><span>&#123;12,15,21,23,35,27&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 逻辑:</span><br><span class="hljs-comment">-- A. 声明游标, 存储查询结果集</span><br><span class="hljs-comment">-- B. 准备: 创建表结构</span><br><span class="hljs-comment">-- C. 开启游标</span><br><span class="hljs-comment">-- D. 获取游标中的记录</span><br><span class="hljs-comment">-- E. 插入数据到新表中</span><br><span class="hljs-comment">-- F. 关闭游标</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span>  p11(<span class="hljs-keyword">in</span> uage <span class="hljs-type">int</span>)<br><span class="hljs-keyword">begin</span> <br>		<span class="hljs-keyword">declare</span> uname <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>);<br>		<span class="hljs-keyword">declare</span> upro <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>);<br>		<span class="hljs-keyword">declare</span> u_cursor <span class="hljs-keyword">cursor</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">select</span> name,profession <span class="hljs-keyword">from</span> tb_user <span class="hljs-keyword">where</span> age <span class="hljs-operator">&lt;=</span> uage;<br>		<br>		<span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> if <span class="hljs-keyword">exists</span> tb_user_pro;<br>		<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> if <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> tb_user_pro(<br>				id <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key auto_increment,<br>				name <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>),<br>				profession <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>)<br>		);<br>		<br>		<span class="hljs-keyword">open</span> u_cursor;<br>		while <span class="hljs-literal">true</span> do<br>				<span class="hljs-keyword">fetch</span> u_cursor <span class="hljs-keyword">into</span> uname,upro;<br>				<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> tb_user <span class="hljs-keyword">values</span> (<span class="hljs-keyword">null</span>,uname,upro);<br>		<span class="hljs-keyword">end</span> while;<br>		<br>		<span class="hljs-keyword">close</span> u_cursor;<br><span class="hljs-keyword">end</span>;<br><br><span class="hljs-keyword">call</span> p11(<span class="hljs-number">40</span>);<br></code></pre></td></tr></table></figure><p><code>tip</code></p><p><code>注意，声明自定义变量要写在声明游标前面。</code></p><p>上述的存储过程，最终我们在调用的过程中，会报错，之所以报错是因为上面的while循环中，并没有退出条件。当游标的数据集获取完毕之后，再次获取数据，就会报错，从而终止了程序的执行。</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="E:\hexoblog\source\_posts\Database\MySQL\MySQL_Advanced_View.assets\202211111647769.webp" style="zoom:80%"></p><p>但是此时，tb_user_pro表结构及其数据都已经插入成功了，我们可以直接刷新表结构，检查表结构中的数据。</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs/202211111647927.webp" style="zoom:80%"></p><p>上述的功能，虽然我们实现了，但是逻辑并不完善，而且程序执行完毕，获取不到数据，数据库还报错。 接下来，我们就需要来完成这个存储过程，并且解决这个问题。</p><p>要想解决这个问题，就需要通过MySQL中提供的 条件处理程序 <code>Handler</code> 来解决。</p><h3 id="条件处理程序">条件处理程序</h3><ol type="1"><li>介绍</li></ol><p><mark>条件处理程序（Handler）</mark>可以用来定义在流程控制结构执行过程中遇到问题时相应的处理步骤。具体语法为：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DECLARE</span> handler_action HANDLER <span class="hljs-keyword">FOR</span> condition_value [, condition_value] ... statement ;<br><br>handler_action 的取值：<br>	CONTINUE: 继续执行当前程序<br>	EXIT: 终止执行当前程序<br>	<br>condition_value 的取值：<br>	<span class="hljs-keyword">SQLSTATE</span> sqlstate_value: 状态码，如 <span class="hljs-number">02000</span><br>	<span class="hljs-keyword">SQLWARNING</span>: 所有以<span class="hljs-number">01</span>开头的<span class="hljs-keyword">SQLSTATE</span>代码的简写<br>	<span class="hljs-keyword">NOT</span> FOUND: 所有以<span class="hljs-number">02</span>开头的<span class="hljs-keyword">SQLSTATE</span>代码的简写<br>	<span class="hljs-keyword">SQLEXCEPTION</span>: 所有没有被<span class="hljs-keyword">SQLWARNING</span> 或 <span class="hljs-keyword">NOT</span> FOUND捕获的<span class="hljs-keyword">SQLSTATE</span>代码的简写<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>案例</li></ol><p>我们继续来完成在上一小节提出的这个需求，并解决其中的问题。</p><p>根据传入的参数uage，来查询用户表tb_user中，所有的用户年龄小于等于uage的用户姓名（name）和专业（profession），并将用户的姓名和专业插入到所创建的一张新表(id,name,profession)中。</p><p>A. 通过SQLSTATE指定具体的状态码</p><figure class="highlight sql"><figcaption><span>&#123;6&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span>  p12(<span class="hljs-keyword">in</span> uage <span class="hljs-type">int</span>)<br><span class="hljs-keyword">begin</span> <br>		<span class="hljs-keyword">declare</span> uname <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>);<br>		<span class="hljs-keyword">declare</span> upro <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>);<br>		<span class="hljs-keyword">declare</span> u_cursor <span class="hljs-keyword">cursor</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">select</span> name,profession <span class="hljs-keyword">from</span> tb_user <span class="hljs-keyword">where</span> age <span class="hljs-operator">&lt;=</span> uage;<br>		<span class="hljs-comment">-- 声明条件处理程序 ： 当SQL语句执行抛出的状态码为02000时，将关闭游标u_cursor，并退出</span><br>		<span class="hljs-keyword">declare</span> exit hander <span class="hljs-keyword">for</span> <span class="hljs-keyword">sqlstate</span> <span class="hljs-string">&#x27;02000&#x27;</span> <span class="hljs-keyword">close</span> u_cursor;<br>		<br>		<span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> if <span class="hljs-keyword">exists</span> tb_user_pro;<br>		<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> if <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> tb_user_pro(<br>				id <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key auto_increment,<br>				name <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>),<br>				profession <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>)<br>		);<br>		<br>		<span class="hljs-keyword">open</span> u_cursor;<br>		while <span class="hljs-literal">true</span> do<br>				<span class="hljs-keyword">fetch</span> u_cursor <span class="hljs-keyword">into</span> uname,upro;<br>				<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> tb_user_pro <span class="hljs-keyword">values</span> (<span class="hljs-keyword">null</span>,uname,upro);<br>		<span class="hljs-keyword">end</span> while;<br>		<br>		<span class="hljs-keyword">close</span> u_cursor;<br><span class="hljs-keyword">end</span>;<br><br><span class="hljs-keyword">call</span> p12(<span class="hljs-number">40</span>);<br></code></pre></td></tr></table></figure><p>B. 通过SQLSTATE的代码简写方式 NOT FOUND</p><p>02 开头的状态码，代码简写为 NOT FOUND</p><figure class="highlight sql"><figcaption><span>&#123;7&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">procedure</span>  p12(<span class="hljs-keyword">in</span> uage <span class="hljs-type">int</span>)<br><span class="hljs-keyword">begin</span> <br>		<span class="hljs-keyword">declare</span> uname <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>);<br>		<span class="hljs-keyword">declare</span> upro <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>);<br>		<span class="hljs-keyword">declare</span> u_cursor <span class="hljs-keyword">cursor</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">select</span> name,profession <span class="hljs-keyword">from</span> tb_user <span class="hljs-keyword">where</span> age <span class="hljs-operator">&lt;=</span> uage;<br>		<span class="hljs-comment">-- 声明条件处理程序 ： 当SQL语句执行抛出的状态码为02000时，将关闭游标u_cursor，并退出</span><br>		<span class="hljs-keyword">declare</span> exit hander <span class="hljs-keyword">for</span> <span class="hljs-keyword">sqlstate</span> <span class="hljs-keyword">not</span> found <span class="hljs-keyword">close</span> u_cursor;<br>		<br>		<span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> if <span class="hljs-keyword">exists</span> tb_user_pro;<br>		<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> if <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> tb_user_pro(<br>				id <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key auto_increment,<br>				name <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>),<br>				profession <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>)<br>		);<br>		<br>		<span class="hljs-keyword">open</span> u_cursor;<br>		while <span class="hljs-literal">true</span> do<br>				<span class="hljs-keyword">fetch</span> u_cursor <span class="hljs-keyword">into</span> uname,upro;<br>				<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> tb_user_pro <span class="hljs-keyword">values</span> (<span class="hljs-keyword">null</span>,uname,upro);<br>		<span class="hljs-keyword">end</span> while;<br>		<br>		<span class="hljs-keyword">close</span> u_cursor;<br><span class="hljs-keyword">end</span>;<br><br><span class="hljs-keyword">call</span> p12(<span class="hljs-number">40</span>);<br></code></pre></td></tr></table></figure><p>具体的错误状态码，可以参考官方文档：</p><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/declare-handler.html">https://dev.mysql.com/doc/refman/8.0/en/declare-handler.html</a></p><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/declare-handler.html">https://dev.mysql.com/doc/mysql-errors/8.0/en/server-error-reference.html</a></p><h2 id="存储函数">存储函数</h2><ol type="1"><li>介绍</li></ol><p>存储函数是有返回值的存储过程，存储函数的参数<code>只能是IN类型</code>的。具体语法如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> 存储函数名称 ([ 参数列表 ])<br><span class="hljs-keyword">RETURNS</span> type [characteristic ...]<br><span class="hljs-keyword">BEGIN</span><br>	<span class="hljs-comment">-- SQL语句</span><br>	<span class="hljs-keyword">RETURN</span> ...;<br><span class="hljs-keyword">END</span> ;<br></code></pre></td></tr></table></figure><p>characteristic说明：</p><ul><li>DETERMINISTIC：相同的输入参数总是产生相同的结果</li><li>NO SQL ：不包含 SQL 语句。</li><li>READS SQL DATA：包含读取数据的语句，但不包含写入数据的语句。</li></ul><ol start="2" type="1"><li>案例</li></ol><p>计算从1累加到n的值，n为传入的参数值。</p><figure class="highlight sql"><figcaption><span>&#123;2&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> fun1(n <span class="hljs-type">int</span>)<br><span class="hljs-keyword">returns</span> <span class="hljs-type">int</span> <span class="hljs-keyword">deterministic</span><br><span class="hljs-keyword">begin</span><br>	<span class="hljs-keyword">declare</span> total <span class="hljs-type">int</span> <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>;<br>	while n<span class="hljs-operator">&gt;</span><span class="hljs-number">0</span> do<br>		<span class="hljs-keyword">set</span> total :<span class="hljs-operator">=</span> total <span class="hljs-operator">+</span> n;<br>		<span class="hljs-keyword">set</span> n :<span class="hljs-operator">=</span> n <span class="hljs-operator">-</span> <span class="hljs-number">1</span>;<br>	<span class="hljs-keyword">end</span> while;<br>	<span class="hljs-keyword">return</span> total;<br><span class="hljs-keyword">end</span>;<br><br><span class="hljs-keyword">select</span> fun1(<span class="hljs-number">50</span>);<br></code></pre></td></tr></table></figure><p>在mysql8.0版本中binlog默认是开启的，一旦开启了，mysql就要求在定义存储过程时，需要指定<code>characteristic</code>特性，否则就会报如下错误：</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.staticaly.com/gh/xustudyxu/image-hosting1@master/20220930/image.47h1umf49aa0.webp" style="zoom:80%"></p><h2 id="触发器">触发器</h2><h3 id="介绍-1">介绍</h3><p>触发器是与表有关的数据库对象，指在<code>insert/update/delete</code>之前(<code>BEFORE</code>)或之后(<code>AFTER</code>)，触发并执行触发器中定义的SQL语句集合。触发器的这种特性可以协助应用在数据库端确保数据的完整性, 日志记录 , 数据校验等操作 。</p><p>使用别名<code>OLD</code>和<code>NEW</code>来引用触发器中发生变化的记录内容，这与其他的数据库是相似的。现在触发器还只支持行级触发，不支持语句级触发。</p><table><thead><tr class="header"><th>触发器类型</th><th>NEW和OLD</th></tr></thead><tbody><tr class="odd"><td>INSERT 型触发器</td><td>NEW 表示将要或者已经新增的数据</td></tr><tr class="even"><td>UPDATE 型触发器</td><td>OLD 表示修改之前的数据 , NEW 表示将要或已经修改后的数据</td></tr><tr class="odd"><td>DELETE 型触发器</td><td>OLD 表示将要或者已经删除的数据</td></tr></tbody></table><h3 id="语法">语法</h3><ol type="1"><li>创建</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TRIGGER</span> trigger_name<br>BEFORE<span class="hljs-operator">/</span>AFTER <span class="hljs-keyword">INSERT</span><span class="hljs-operator">/</span><span class="hljs-keyword">UPDATE</span><span class="hljs-operator">/</span><span class="hljs-keyword">DELETE</span><br><span class="hljs-keyword">ON</span> tbl_name <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-type">ROW</span> <span class="hljs-comment">-- 行级触发器</span><br><span class="hljs-keyword">BEGIN</span><br>	trigger_stmt ;<br><span class="hljs-keyword">END</span>;<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>查看</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SHOW</span> TRIGGERS;<br></code></pre></td></tr></table></figure><ol start="3" type="1"><li>删除</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TRIGGER</span> [schema_name.]trigger_name ; <span class="hljs-comment">-- 如果没有指定 schema_name，默认为当前数据库 。</span><br></code></pre></td></tr></table></figure><h3 id="案例-1">案例</h3><p>通过触发器记录 tb_user 表的数据变更日志，将变更日志插入到日志表user_logs中, 包含增加,修改 , 删除 ;</p><p>表结构准备:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 准备工作 : 日志表 user_logs</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> user_logs(<br>id <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> auto_increment,<br>	operation <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> comment <span class="hljs-string">&#x27;操作类型, insert/update/delete&#x27;</span>,<br>	operate_time datetime <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> comment <span class="hljs-string">&#x27;操作时间&#x27;</span>,<br>	operate_id <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> comment <span class="hljs-string">&#x27;操作的ID&#x27;</span>,<br>	operate_params <span class="hljs-type">varchar</span>(<span class="hljs-number">500</span>) comment <span class="hljs-string">&#x27;操作参数&#x27;</span>,<br>	<span class="hljs-keyword">primary</span> key(`id`)<br>)engine<span class="hljs-operator">=</span>innodb <span class="hljs-keyword">default</span> charset<span class="hljs-operator">=</span>utf8;<br></code></pre></td></tr></table></figure><p>A. 插入数据触发器</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">trigger</span> tb_user_insert_trigger<br>		after <span class="hljs-keyword">insert</span> <span class="hljs-keyword">on</span> tb_user <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> <span class="hljs-type">row</span><br><span class="hljs-keyword">begin</span><br>		<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> user_logs(id, operation, operate_time, operate_id, operate_params) <span class="hljs-keyword">values</span><br>		(<span class="hljs-keyword">null</span>,<span class="hljs-string">&#x27;insert&#x27;</span>,now(),new.id,concat(<span class="hljs-string">&#x27;插入的数据内容为:id=&#x27;</span>,new.id,<span class="hljs-string">&#x27;,name=&#x27;</span>,new.name,<span class="hljs-string">&#x27;,phone=&#x27;</span>,new.phone,<span class="hljs-string">&#x27;,email=&#x27;</span>,new.email,<span class="hljs-string">&#x27;,profession=&#x27;</span>,new.profession));<br><span class="hljs-keyword">end</span><br><br></code></pre></td></tr></table></figure><p>测试</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--查看</span><br><span class="hljs-keyword">show</span> triggers;<br><br><br><span class="hljs-comment">-- 插入数据到tb_user表</span><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> tb_user(id, name, phone, email, profession, age, gender, status, createtime) <span class="hljs-keyword">VALUES</span> (<span class="hljs-keyword">null</span>,<span class="hljs-string">&#x27;三皇子&#x27;</span>,<span class="hljs-string">&#x27;18809091212&#x27;</span>,<span class="hljs-string">&#x27;erhuangzi@163.com&#x27;</span>,<span class="hljs-string">&#x27;软件工程&#x27;</span>,<span class="hljs-number">23</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,now());<br></code></pre></td></tr></table></figure><p>测试完毕之后，检查日志表中的数据是否可以正常插入，以及插入数据的正确性。</p><p>B. 修改数据触发器</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--修改数据的触发器</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">trigger</span> tb_user_update_trigger<br>		after <span class="hljs-keyword">update</span> <span class="hljs-keyword">on</span> tb_user <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> <span class="hljs-type">row</span><br><span class="hljs-keyword">begin</span><br>		<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> user_logs(id, operation, operate_time, operate_id, operate_params) <span class="hljs-keyword">values</span><br>		(<span class="hljs-keyword">null</span>,<span class="hljs-string">&#x27;update&#x27;</span>,now(),new.id,concat(<span class="hljs-string">&#x27;更新之前的数据内容为:id=&#x27;</span>,old.id,<span class="hljs-string">&#x27;,name=&#x27;</span>,old.name,<span class="hljs-string">&#x27;,phone=&#x27;</span>,old.phone,<span class="hljs-string">&#x27;,email=&#x27;</span>,old.email,<span class="hljs-string">&#x27;,profession=&#x27;</span>,old.profession,<br>		<span class="hljs-string">&#x27;| 更新之后的数据内容为:id=&#x27;</span>,new.id,<span class="hljs-string">&#x27;,name=&#x27;</span>,new.name,<span class="hljs-string">&#x27;,phone=&#x27;</span>,new.phone,<span class="hljs-string">&#x27;,email=&#x27;</span>,new.email,<span class="hljs-string">&#x27;,profession=&#x27;</span>,new.profession));<br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><p>测试：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> triggers;<br><br><span class="hljs-comment">-- 更新</span><br><span class="hljs-keyword">update</span> tb_user <span class="hljs-keyword">set</span> profession <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;会计&#x27;</span> <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">23</span>;<br><span class="hljs-keyword">update</span> tb_user <span class="hljs-keyword">set</span> profession <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;会计&#x27;</span> <span class="hljs-keyword">where</span> id <span class="hljs-operator">&lt;=</span> <span class="hljs-number">5</span>;<br></code></pre></td></tr></table></figure><p>测试完毕之后，检查日志表中的数据是否可以正常插入，以及插入数据的正确性。</p><p>C. 删除数据触发器</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--删除数据的触发器</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">trigger</span> tb_user_delete_trigger<br>		after <span class="hljs-keyword">delete</span> <span class="hljs-keyword">on</span> tb_user <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> <span class="hljs-type">row</span><br><span class="hljs-keyword">begin</span><br>		<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> user_logs(id, operation, operate_time, operate_id, operate_params) <span class="hljs-keyword">values</span><br>		(<span class="hljs-keyword">null</span>,<span class="hljs-string">&#x27;delete&#x27;</span>,now(),old.id,concat(<span class="hljs-string">&#x27;删除之前的数据内容为:id=&#x27;</span>,old.id,<span class="hljs-string">&#x27;,name=&#x27;</span>,old.name,<span class="hljs-string">&#x27;,phone=&#x27;</span>,old.phone,<span class="hljs-string">&#x27;,email=&#x27;</span>,old.email,<span class="hljs-string">&#x27;,profession=&#x27;</span>,old.profession));<br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><p>测试:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"> <span class="hljs-comment">--查看</span><br><span class="hljs-keyword">show</span> triggers;<br><br><span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> tb_user <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">24</span>;<br></code></pre></td></tr></table></figure><p>测试完毕之后，检查日志表中的数据是否可以正常插入，以及插入数据的正确性。</p><p>details</p><p>user_logs表中的数据:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span>	<span class="hljs-keyword">insert</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">01</span>:<span class="hljs-number">31</span>	<span class="hljs-number">25</span>	插入的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">25</span>,name<span class="hljs-operator">=</span>三皇子,phone<span class="hljs-operator">=</span><span class="hljs-number">18809091212</span>,email<span class="hljs-operator">=</span>erhuangzi<span class="hljs-variable">@163</span>.com,profession<span class="hljs-operator">=</span>软件工程<br><span class="hljs-number">2</span>	<span class="hljs-keyword">update</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">11</span>:<span class="hljs-number">10</span>	<span class="hljs-number">23</span>	更新之前的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">23</span>,name<span class="hljs-operator">=</span>后羿,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990022</span>,email<span class="hljs-operator">=</span>altycj2000<span class="hljs-variable">@139</span>.com,profession<span class="hljs-operator">=</span>城市园林<span class="hljs-operator">|</span> 更新之后的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">23</span>,name<span class="hljs-operator">=</span>后羿,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990022</span>,email<span class="hljs-operator">=</span>altycj2000<span class="hljs-variable">@139</span>.com,profession<span class="hljs-operator">=</span>会计<br><span class="hljs-number">3</span>	<span class="hljs-keyword">update</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">11</span>:<span class="hljs-number">10</span>	<span class="hljs-number">1</span>	更新之前的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">1</span>,name<span class="hljs-operator">=</span>吕布,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990000</span>,email<span class="hljs-operator">=</span>lvbu666<span class="hljs-variable">@163</span>.com,profession<span class="hljs-operator">=</span>软件工程<span class="hljs-operator">|</span> 更新之后的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">1</span>,name<span class="hljs-operator">=</span>吕布,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990000</span>,email<span class="hljs-operator">=</span>lvbu666<span class="hljs-variable">@163</span>.com,profession<span class="hljs-operator">=</span>会计<br><span class="hljs-number">4</span>	<span class="hljs-keyword">update</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">11</span>:<span class="hljs-number">10</span>	<span class="hljs-number">2</span>	更新之前的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">2</span>,name<span class="hljs-operator">=</span>曹操,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990001</span>,email<span class="hljs-operator">=</span>caocao666<span class="hljs-variable">@qq</span>.com,profession<span class="hljs-operator">=</span>通讯工程<span class="hljs-operator">|</span> 更新之后的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">2</span>,name<span class="hljs-operator">=</span>曹操,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990001</span>,email<span class="hljs-operator">=</span>caocao666<span class="hljs-variable">@qq</span>.com,profession<span class="hljs-operator">=</span>会计<br><span class="hljs-number">5</span>	<span class="hljs-keyword">update</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">11</span>:<span class="hljs-number">10</span>	<span class="hljs-number">3</span>	更新之前的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">3</span>,name<span class="hljs-operator">=</span>赵云,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990002</span>,email<span class="hljs-operator">=</span><span class="hljs-number">17799990</span><span class="hljs-variable">@139</span>.com,profession<span class="hljs-operator">=</span>英语<span class="hljs-operator">|</span> 更新之后的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">3</span>,name<span class="hljs-operator">=</span>赵云,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990002</span>,email<span class="hljs-operator">=</span><span class="hljs-number">17799990</span><span class="hljs-variable">@139</span>.com,profession<span class="hljs-operator">=</span>会计<br><span class="hljs-number">6</span>	<span class="hljs-keyword">update</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">11</span>:<span class="hljs-number">10</span>	<span class="hljs-number">4</span>	更新之前的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">4</span>,name<span class="hljs-operator">=</span>孙悟空,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990003</span>,email<span class="hljs-operator">=</span><span class="hljs-number">17799990</span><span class="hljs-variable">@sina</span>.com,profession<span class="hljs-operator">=</span>工程造价<span class="hljs-operator">|</span> 更新之后的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">4</span>,name<span class="hljs-operator">=</span>孙悟空,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990003</span>,email<span class="hljs-operator">=</span><span class="hljs-number">17799990</span><span class="hljs-variable">@sina</span>.com,profession<span class="hljs-operator">=</span>会计<br><span class="hljs-number">7</span>	<span class="hljs-keyword">update</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">11</span>:<span class="hljs-number">10</span>	<span class="hljs-number">5</span>	更新之前的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">5</span>,name<span class="hljs-operator">=</span>花木兰,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990004</span>,email<span class="hljs-operator">=</span><span class="hljs-number">19980729</span><span class="hljs-variable">@sina</span>.com,profession<span class="hljs-operator">=</span>软件工程<span class="hljs-operator">|</span> 更新之后的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">5</span>,name<span class="hljs-operator">=</span>花木兰,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990004</span>,email<span class="hljs-operator">=</span><span class="hljs-number">19980729</span><span class="hljs-variable">@sina</span>.com,profession<span class="hljs-operator">=</span>会计<br><span class="hljs-number">8</span>	<span class="hljs-keyword">update</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">12</span>:<span class="hljs-number">47</span>	<span class="hljs-number">1</span>	更新之前的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">1</span>,name<span class="hljs-operator">=</span>吕布,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990000</span>,email<span class="hljs-operator">=</span>lvbu666<span class="hljs-variable">@163</span>.com,profession<span class="hljs-operator">=</span>会计<span class="hljs-operator">|</span> 更新之后的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">1</span>,name<span class="hljs-operator">=</span>吕布,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990000</span>,email<span class="hljs-operator">=</span>lvbu666<span class="hljs-variable">@163</span>.com,profession<span class="hljs-operator">=</span>会计<br><span class="hljs-number">9</span>	<span class="hljs-keyword">update</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">12</span>:<span class="hljs-number">47</span>	<span class="hljs-number">2</span>	更新之前的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">2</span>,name<span class="hljs-operator">=</span>曹操,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990001</span>,email<span class="hljs-operator">=</span>caocao666<span class="hljs-variable">@qq</span>.com,profession<span class="hljs-operator">=</span>会计<span class="hljs-operator">|</span> 更新之后的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">2</span>,name<span class="hljs-operator">=</span>曹操,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990001</span>,email<span class="hljs-operator">=</span>caocao666<span class="hljs-variable">@qq</span>.com,profession<span class="hljs-operator">=</span>会计<br><span class="hljs-number">10</span>	<span class="hljs-keyword">update</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">12</span>:<span class="hljs-number">47</span>	<span class="hljs-number">3</span>	更新之前的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">3</span>,name<span class="hljs-operator">=</span>赵云,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990002</span>,email<span class="hljs-operator">=</span><span class="hljs-number">17799990</span><span class="hljs-variable">@139</span>.com,profession<span class="hljs-operator">=</span>会计<span class="hljs-operator">|</span> 更新之后的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">3</span>,name<span class="hljs-operator">=</span>赵云,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990002</span>,email<span class="hljs-operator">=</span><span class="hljs-number">17799990</span><span class="hljs-variable">@139</span>.com,profession<span class="hljs-operator">=</span>会计<br><span class="hljs-number">11</span>	<span class="hljs-keyword">update</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">12</span>:<span class="hljs-number">47</span>	<span class="hljs-number">4</span>	更新之前的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">4</span>,name<span class="hljs-operator">=</span>孙悟空,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990003</span>,email<span class="hljs-operator">=</span><span class="hljs-number">17799990</span><span class="hljs-variable">@sina</span>.com,profession<span class="hljs-operator">=</span>会计<span class="hljs-operator">|</span> 更新之后的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">4</span>,name<span class="hljs-operator">=</span>孙悟空,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990003</span>,email<span class="hljs-operator">=</span><span class="hljs-number">17799990</span><span class="hljs-variable">@sina</span>.com,profession<span class="hljs-operator">=</span>会计<br><span class="hljs-number">12</span>	<span class="hljs-keyword">update</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">12</span>:<span class="hljs-number">47</span>	<span class="hljs-number">5</span>	更新之前的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">5</span>,name<span class="hljs-operator">=</span>花木兰,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990004</span>,email<span class="hljs-operator">=</span><span class="hljs-number">19980729</span><span class="hljs-variable">@sina</span>.com,profession<span class="hljs-operator">=</span>会计<span class="hljs-operator">|</span> 更新之后的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">5</span>,name<span class="hljs-operator">=</span>花木兰,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990004</span>,email<span class="hljs-operator">=</span><span class="hljs-number">19980729</span><span class="hljs-variable">@sina</span>.com,profession<span class="hljs-operator">=</span>会计<br><span class="hljs-number">13</span>	<span class="hljs-keyword">delete</span>	<span class="hljs-number">2022</span><span class="hljs-number">-10</span><span class="hljs-number">-01</span> <span class="hljs-number">15</span>:<span class="hljs-number">47</span>:<span class="hljs-number">46</span>	<span class="hljs-number">24</span>	删除之前的数据内容为:id<span class="hljs-operator">=</span><span class="hljs-number">24</span>,name<span class="hljs-operator">=</span>姜子牙,phone<span class="hljs-operator">=</span><span class="hljs-number">17799990023</span>,email<span class="hljs-operator">=</span><span class="hljs-number">37483844</span><span class="hljs-variable">@qq</span>.com,profession<span class="hljs-operator">=</span>工程造价<br></code></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://Unicorn-acc.github.io">Miraclo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://unicorn-acc.github.io/posts/60264.html">http://unicorn-acc.github.io/posts/60264.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://Unicorn-acc.github.io" target="_blank">Miraclo</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Mysql/">Mysql</a></div><div class="post_share"><div class="social-share" data-image="https://w.wallhaven.cc/full/kx/wallhaven-kx3p1q.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/33696.html"><img class="prev-cover" src="https://w.wallhaven.cc/full/x6/wallhaven-x619o3.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">黑马Redis实战篇</div></div></a></div><div class="next-post pull-right"><a href="/posts/13913.html"><img class="next-cover" src="https://w.wallhaven.cc/full/zy/wallhaven-zyxvqy.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MySQL_09进阶_三种存储引擎</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/11178.html" title="MySQL_04基础_多表查询"><img class="cover" src="https://w.wallhaven.cc/full/1p/wallhaven-1pjml1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-01</div><div class="title">MySQL_04基础_多表查询</div></div></a></div><div><a href="/posts/52716.html" title="MySQL_02基础_CRUD"><img class="cover" src="https://w.wallhaven.cc/full/x6/wallhaven-x619o3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-01</div><div class="title">MySQL_02基础_CRUD</div></div></a></div><div><a href="/posts/57704.html" title="MySQL_05基础_约束与自增长"><img class="cover" src="https://w.wallhaven.cc/full/d6/wallhaven-d65mzm.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-01</div><div class="title">MySQL_05基础_约束与自增长</div></div></a></div><div><a href="/posts/9826.html" title="MySQL_03基础_函数"><img class="cover" src="https://w.wallhaven.cc/full/d6/wallhaven-d65mzm.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-01</div><div class="title">MySQL_03基础_函数</div></div></a></div><div><a href="/posts/20424.html" title="MySQL_01_简介"><img class="cover" src="https://w.wallhaven.cc/full/d6/wallhaven-d65mzm.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-01</div><div class="title">MySQL_01_简介</div></div></a></div><div><a href="/posts/39434.html" title="MySQL_06基础_索引与事务"><img class="cover" src="https://w.wallhaven.cc/full/x6/wallhaven-x619o3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-01</div><div class="title">MySQL_06基础_索引与事务</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#mysql-%E8%A7%86%E5%9B%BE%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-text">MySQL 视图&#x2F;存储过程&#x2F;触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E4%BB%8B%E7%BB%8D"><span class="toc-text">视图介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E8%AF%AD%E6%B3%95"><span class="toc-text">视图语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E9%80%89%E9%A1%B9"><span class="toc-text">检查选项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E6%9B%B4%E6%96%B0"><span class="toc-text">视图的更新</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E4%BD%9C%E7%94%A8"><span class="toc-text">视图作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-text">案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-text">存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-text">基本语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-text">变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-text">系统变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="toc-text">用户定义变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="toc-text">局部变量</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#if-%E5%88%A4%E6%96%AD"><span class="toc-text">if 判断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0"><span class="toc-text">参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#case"><span class="toc-text">case</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#while"><span class="toc-text">while</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#repeat"><span class="toc-text">repeat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#loop"><span class="toc-text">loop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87"><span class="toc-text">游标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="toc-text">条件处理程序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-text">存储函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-text">触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-1"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-text">语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B-1"><span class="toc-text">案例</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Miraclo</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">人只有在走上坡路的时候才会累和迷茫。</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if(window.MathJax)MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset();else{window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],tags:"ams"},chtml:{scale:1.1},options:{renderActions:{findScript:[10,t=>{for(const n of document.querySelectorAll('script[type^="math/tex"]')){var e=!!n.type.match(/; *mode=display/),e=new t.options.MathItem(n.textContent,t.inputJax[0],e),a=document.createTextNode("");n.parentNode.replaceChild(a,n),e.start={node:a,delim:"",n:0},e.end={node:a,delim:"",n:0},t.math.push(e)}},""],insertScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(t=>{t.hasAttribute("display")?btf.wrap(t,"div",{class:"mathjax-overflow"}):btf.wrap(t,"span",{class:"mathjax-overflow"})})},"",!1]}}};const a=document.createElement("script");a.src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js",a.id="MathJax-script",a.async=!0,document.head.appendChild(a)}</script></div><link rel="stylesheet" href="/css/Lete.css"><script src="/js/custom.js"></script><script src="/js/mouth.js"></script><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script data-pjax>var parent,child;document.getElementById("recent-posts")&&"/"===location.pathname&&(parent=document.getElementById("recent-posts"),child='<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="http://Unicorn-acc.github.io/categories/Java技术栈/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📚 Java技术栈相关 (77)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="http://Unicorn-acc.github.io/categories/数据库/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">‍🎮 数据库相关 (36)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item" style="visibility: hidden"></div><a class="magnet_link_more"  href="http://Unicorn-acc.github.io/categories" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>',console.log("已挂载magnet"),parent.insertAdjacentHTML("afterbegin",child))</script><style>#catalog_magnet{flex-wrap:wrap;display:flex;width:100%;justify-content:space-between;padding:10px 10px 0 10px;align-content:flex-start}.magnet_item{flex-basis:calc(33.333333333333336% - 5px);background:#f2f2f2;margin-bottom:10px;border-radius:8px;transition:all .2s ease-in-out}.magnet_item:hover{background:#b30070}.magnet_link_more{color:#555}.magnet_link{color:#000}.magnet_link:hover{color:#fff}@media screen and (max-width:600px){.magnet_item{flex-basis:100%}}.magnet_link_context{display:flex;padding:10px;font-size:16px;transition:all .2s ease-in-out}.magnet_link_context:hover{padding:10px 20px}</style><style></style><div class="js-pjax"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration","1s"),arr[i].setAttribute("data-wow-delay","1ms"),arr[i].setAttribute("data-wow-offset","100"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script></body></html>
<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>ç›®æ ‡æ£€æµ‹-04-â‘ YOLO v1~v3ã€â‘¡YOLO v3 SPPçš„ç†è®ºè®²è§£ | Miracloâ€™s Blog</title><meta name="author" content="Miraclo"><meta name="copyright" content="Miraclo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="å‚è€ƒå†…å®¹æ¥è‡ªéœ¹é›³å§å•¦Wz upä¸»çš„bç«™é“¾æ¥ï¼šhttps:&#x2F;&#x2F;space.bilibili.com&#x2F;18161609&#x2F;channel&#x2F;index upä¸»çš„githubï¼šhttps:&#x2F;&#x2F;github.com&#x2F;WZMIAOMIAO&#x2F;deep-learning-for-image-processing upä¸»çš„CSDNåšå®¢ï¼šhttps:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_37541097&#x2F;articl"><meta property="og:type" content="article"><meta property="og:title" content="ç›®æ ‡æ£€æµ‹-04-â‘ YOLO v1~v3ã€â‘¡YOLO v3 SPPçš„ç†è®ºè®²è§£"><meta property="og:url" content="http://unicorn-acc.github.io/posts/62071.html"><meta property="og:site_name" content="Miracloâ€™s Blog"><meta property="og:description" content="å‚è€ƒå†…å®¹æ¥è‡ªéœ¹é›³å§å•¦Wz upä¸»çš„bç«™é“¾æ¥ï¼šhttps:&#x2F;&#x2F;space.bilibili.com&#x2F;18161609&#x2F;channel&#x2F;index upä¸»çš„githubï¼šhttps:&#x2F;&#x2F;github.com&#x2F;WZMIAOMIAO&#x2F;deep-learning-for-image-processing upä¸»çš„CSDNåšå®¢ï¼šhttps:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_37541097&#x2F;articl"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://w.wallhaven.cc/full/1p/wallhaven-1pjml1.jpg"><meta property="article:published_time" content="2022-11-18T10:20:03.000Z"><meta property="article:modified_time" content="2022-11-19T09:02:04.463Z"><meta property="article:author" content="Miraclo"><meta property="article:tag" content="DeepLearning"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://w.wallhaven.cc/full/1p/wallhaven-1pjml1.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://unicorn-acc.github.io/posts/62071"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,languages:{hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"prismjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:2e3},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!1,post:!1},runtime:"å¤©",date_suffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:{limitCount:500,languages:{author:"ä½œè€…: Miraclo",link:"é“¾æ¥: ",source:"æ¥æº: Miracloâ€™s Blog",info:"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"ç›®æ ‡æ£€æµ‹-04-â‘ YOLO v1~v3ã€â‘¡YOLO v3 SPPçš„ç†è®ºè®²è§£",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-11-19 09:02:04"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,a){0!==a&&(a=864e5*a,t={value:t,expiry:(new Date).getTime()+a},localStorage.setItem(e,JSON.stringify(t)))},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);if(!((new Date).getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=o=>new Promise((t,e)=>{const a=document.createElement("script");a.src=o,a.async=!0,a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme"),"dark"===e?activateDarkMode():"light"===e&&activateLightMode(),e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/mouth.css"><meta name="generator" content="Hexo 6.0.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">125</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">29</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-film"></i><span> å…¶ä»–</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/algor-record/"><i class="fa-fw fas fa-gamepad"></i><span> ç®—æ³•åˆ·é¢˜è®°å½•</span></a></li><li><a class="site-page child" href="/DL-record/"><i class="fa-fw fas fa-trophy"></i><span> æ·±åº¦å­¦ä¹ è®°å½•</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> é“¾æ¥</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:randomPost();"><i class="fa-fw fa-solid fa-shuffle"></i><span></span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://w.wallhaven.cc/full/1p/wallhaven-1pjml1.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Miracloâ€™s Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-film"></i><span> å…¶ä»–</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/algor-record/"><i class="fa-fw fas fa-gamepad"></i><span> ç®—æ³•åˆ·é¢˜è®°å½•</span></a></li><li><a class="site-page child" href="/DL-record/"><i class="fa-fw fas fa-trophy"></i><span> æ·±åº¦å­¦ä¹ è®°å½•</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> é“¾æ¥</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:randomPost();"><i class="fa-fw fa-solid fa-shuffle"></i><span></span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ç›®æ ‡æ£€æµ‹-04-â‘ YOLO v1~v3ã€â‘¡YOLO v3 SPPçš„ç†è®ºè®²è§£</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">å‘è¡¨äº</span><time datetime="2022-11-18T10:20:03.000Z" title="å‘è¡¨äº 2022-11-18 10:20:03">2022-11-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">æ·±åº¦å­¦ä¹ ç¬”è®°</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B/">ç½‘ç»œæ¨¡å‹</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B/2%E3%80%81%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E7%AF%87/">2ã€ç›®æ ‡æ£€æµ‹ç¯‡</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">9.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>35åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="ç›®æ ‡æ£€æµ‹-04-â‘ YOLO v1~v3ã€â‘¡YOLO v3 SPPçš„ç†è®ºè®²è§£"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote><p>å‚è€ƒå†…å®¹æ¥è‡ªéœ¹é›³å§å•¦Wz</p><p>upä¸»çš„bç«™é“¾æ¥ï¼šhttps://space.bilibili.com/18161609/channel/index</p><p>upä¸»çš„githubï¼šhttps://github.com/WZMIAOMIAO/deep-learning-for-image-processing</p><p>upä¸»çš„CSDNåšå®¢ï¼šhttps://blog.csdn.net/qq_37541097/article/details/103482003</p><p>å‚è€ƒåšæ–‡ï¼šhttps://blog.csdn.net/weixin_44878336/article/details/124759307</p></blockquote><h1 id="å¼•è¨€">0. å¼•è¨€</h1><h2 id="å®‰æ’">0.1 å®‰æ’</h2><ul><li>YOLO v1 ï¼ˆç®€å•ç†è®ºï¼‰</li><li>YOLO v2 ï¼ˆç®€å•ç†è®ºï¼‰</li><li>YOLO v3 ï¼ˆè¯¦ç»†ç†è®ºï¼‰</li><li>YOLO v3 SPP ï¼ˆtrickæ‰©å…… + ä»£ç è®²è§£ï¼‰<font color="#FF0000"><strong>è¿™ä¸ªä»¥åéœ€è¦å†çœ‹</strong></font></li><li>IoUã€GIoUã€DIoUã€CIoU</li><li>Focal Loss</li></ul><h2 id="å­¦ä¹ ä»£ç çš„æ­¥éª¤">0.2 å­¦ä¹ ä»£ç çš„æ­¥éª¤</h2><p>æƒ³å­¦ä¹ ä¸€ä¸ªæ–°çš„æ¨¡å‹</p><ol type="1"><li>æœè¯¥ç½‘ç»œçš„è®²è§£ â€”â€” å¤§æ¦‚æœ‰ä¸€ä¸ªå°è±¡</li><li><strong>è¯»åŸæ–‡ï¼ˆéå¸¸é‡è¦ï¼‰</strong> â€”â€” å¾ˆå¤šç»†èŠ‚éƒ½æ˜¯é€šè¿‡åŸè®ºæ–‡å®ç°çš„ â€”â€” å‘ç°æ›´å¤šåŸæ¥æ²¡æœ‰å‘ç°çš„çŸ¥è¯†ç‚¹</li><li>è¯»ä»£ç  â€”â€” githubå®˜æ–¹ä»£ç /å¤ç°çš„æºç ï¼ˆâ­ï¸å¤šçš„ï¼‰<ol type="1"><li>æ ¹æ®ä½œè€…çš„<code>README.md</code>å°†ä»£ç è·‘é€š â€”â€” <strong>è·‘é€šåªæ˜¯ç¬¬ä¸€æ­¥è€Œä¸æ˜¯æœ€åä¸€æ­¥</strong>ğŸ˜‚</li><li>åˆ†æç½‘ç»œæ­å»ºçš„éƒ¨åˆ† â€”â€” ç»“åˆåŸè®ºæ–‡ï¼Œè¿˜æ˜¯æ¯”è¾ƒå¥½ç†è§£çš„</li><li>åˆ†ææ•°æ®é¢„å¤„ç†å’ŒæŸå¤±è®¡ç®—è¿™<strong>ä¸¤å¤§</strong>éƒ¨åˆ† â€”â€” ä¸è¦å°çœ‹è¿™ä¸¤å¤§éƒ¨åˆ†ï¼Œæ¯”ç½‘ç»œæ­å»ºæœ‰éš¾åº¦</li><li>ç½‘ç»œæ­å»ºã€æ•°æ®é¢„å¤„ç†å’ŒæŸå¤±è®¡ç®—çœ‹å®Œä¹‹åï¼ŒåŸºæœ¬ä¸Šå°±æŒæ¡äº†è¿™ä¸ªç½‘ç»œçš„æ ¸å¿ƒæŠ€æœ¯ç‚¹</li><li>çœ‹ä»£ç çš„è¿‡ç¨‹ä¸­æ˜¯éœ€è¦ç»“åˆåŸè®ºæ–‡è¿›è¡Œå‚è€ƒçš„ã€‚åœ¨è¯»åŸè®ºæ–‡çš„æ—¶å€™ï¼Œæœ‰äº›åœ°æ–¹æ˜¯ä¸å¤ªå¥½ç†è§£çš„ï¼Œè€Œç»“åˆä»£ç å°±å¯ä»¥è¿›ä¸€æ­¥ç†è§£ä¹‹å‰å¾ˆéš¾ç†è§£çš„éƒ¨åˆ†</li></ol></li></ol><h1 id="yolo-v1">1. YOLO v1</h1><p>è®ºæ–‡é¢˜ç›®ï¼šYou Only Look Once: Unified, Real-Time Object Detection è®ºæ–‡åœ°å€ï¼šhttps://arxiv.org/abs/1506.02640</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181029462.png"> YOLOæ˜¯ç›®æ ‡æ£€æµ‹One-stageçš„ç»å…¸ç½‘ç»œã€‚YOLO v1ï¼š</p><ul><li>2016å¹´CVPRå‘è¡¨çš„è®ºæ–‡</li><li>PASCAL 2007çš„mAPä¸º63.4%ï¼ˆSSDä¸º74.3%ï¼ŒFaster R-CNNä¸º73.2%ï¼‰</li><li>è¾“å…¥å›¾ç‰‡å¤§å°ä¸º448Ã—448ï¼Œæ¨ç†é€Ÿåº¦ä¸º45 FPS ï¼ˆSSDä¸º300Ã—300ï¼Œ59FPSï¼‰</li></ul><blockquote><p>YOLO v1åœ¨mAPä¸Šæ¯”ä¸è¿‡åŒå¹´çš„SSDå’Œä¹‹å‰çš„Faster R-CNN åœ¨é€Ÿåº¦ä¸Šç§’æ€Faster R-CNNï¼Œä½†æ‰“ä¸è¿‡åŒå¹´çš„SSD ğŸ˜‚ YOLO v1ç›¸æ¯”åŒå¹´å‘å¸ƒçš„SSDæ˜¯æ²¡æœ‰ä»€ä¹ˆä¼˜åŠ¿çš„</p></blockquote><h2 id="æ ¸å¿ƒæ€æƒ³">1.1 æ ¸å¿ƒæ€æƒ³</h2><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181050597.png"></p><h2 id="ç¬¬ä¸€æ­¥åˆ’åˆ†grid-cell">1.2 ç¬¬ä¸€æ­¥ï¼šåˆ’åˆ†grid cell</h2><p>å°†è¾“å…¥å›¾ç‰‡åˆ†ä¸º 7Ã—7ä¸ªç½‘æ ¼(grid cell)ï¼Œå¦‚æœ<strong>æŸä¸ªç›®æ ‡GTBoxçš„ä¸­å¿ƒ</strong>è½åœ¨è¿™ä¸ªç½‘æ ¼å½“ä¸­ï¼Œåˆ™è¿™ä¸ªç½‘ç»œå°±è´Ÿè´£é¢„æµ‹è¿™ä¸ªç›®æ ‡ã€‚</p><h2 id="ç¬¬äºŒæ­¥æ¯ä¸ªgrid-celléœ€è¦åšçš„äº‹æƒ…">1.3 ç¬¬äºŒæ­¥ï¼šæ¯ä¸ªgrid celléœ€è¦åšçš„äº‹æƒ…</h2><p>æ¯ä¸ªç½‘ç»œ(grid cell)è¦é¢„æµ‹2ä¸ªBBox (Bounding Box)ï¼Œæ¯ä¸ªBBoxè¦<strong>é¢„æµ‹ç›®æ ‡çš„ä½ç½®ä¿¡æ¯</strong> <span class="math inline">\((x , y , w , h )\)</span> ä¹‹å¤–è¿˜è¦<strong>é¢„æµ‹ä¸€ä¸ªconfidenceå€¼</strong>ï¼ˆç›®æ ‡åˆ†ç±»å€¼ï¼Œå’Œç±»åˆ«æ²¡å…³ç³»ï¼Œæ˜¯IoUÃ—ä¸€ä¸ªç³»æ•°ï¼Œ<strong>æ˜¯ä¸€ä¸ªæ•°</strong>ï¼‰ã€‚æ¯ä¸ªç½‘ç»œè¿˜éœ€è¦<strong>é¢„æµ‹Cä¸ªç±»åˆ«åˆ†æ•°</strong>ï¼ˆ<strong>æ˜¯ä¸€ä¸ªå‘é‡</strong>[num_classes, ]ï¼‰ã€‚</p><blockquote><p><span class="math inline">\((x,y)\)</span>ï¼šç›¸å¯¹grid cellçš„ç›®æ ‡è¾¹ç•Œæ¡† â€”â€” ç›¸å¯¹å€¼ (grid cell) <span class="math inline">\(\in [0, 1]\)</span></p><p>$ (w, h)$ï¼šç›¸å¯¹æ•´å¼ å›¾ç‰‡çš„å®½åº¦å’Œé«˜åº¦ â€”â€” ç›¸å¯¹å€¼ (image) $ $</p><p>confidenceï¼šé¢„æµ‹æ¡†ä¸GTBoxçš„IoUå€¼ï¼Œå†ä¹˜$ $ã€‚</p><p>å…¶ä¸­ï¼Œ <img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181036004.png" style="zoom:80%"></p><p>Note:</p><ul><li><strong>YOLO v1ä¸­æ˜¯ç›´æ¥é¢„æµ‹BBoxçš„åæ ‡</strong>ï¼Œè€Œä¸åƒFaster R-CNNå’ŒSSDé‚£æ ·ï¼Œæ˜¯é¢„æµ‹Anchorçš„å›å½’å‚æ•°çš„ï¼</li><li>åœ¨YOLO v1ä¸­æ˜¯æ²¡æœ‰Anchorè¿™ä¸ªæ¦‚å¿µï¼ˆç›´æ¥é¢„æµ‹BBoxçš„åæ ‡ï¼Œè€Œä¸æ˜¯é¢„æµ‹å›å½’å‚æ•°ï¼‰</li></ul></blockquote><blockquote><p>åœ¨<code>eval()</code>æ—¶ï¼Œå¯¹äº<strong>æ¯ä¸ªç›®æ ‡çš„æ¦‚ç‡</strong>æ˜¯é€šè¿‡<strong>æ¡ä»¶ç±»åˆ«æ¦‚ç‡</strong>ä¹˜ä¸Šconfidenceå‚æ•°çš„</p><p>å¯¹äºæ¯ä¸€ä¸ªç½‘æ ¼è€Œè¨€ï¼Œå®ƒæœ‰ C ç±»åˆ«ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰ C ä¸ªç±»åˆ«åˆ†æ•°ï¼Œå³<strong>æ¡ä»¶ç±»åˆ«æ¦‚ç‡: <span class="math inline">\(Pr(Class_i | Object)\)</span>â€”â€” å®ƒæ˜¯ç›®æ ‡å‰æä¸‹çš„æ¦‚ç‡</strong>ã€‚è€Œconfidenceå°±æ˜¯<span class="math inline">\(Pr(Object) * IoU ^{\text{truth}}_{\text{pred}}\)</span>ã€‚<span class="math inline">\(Pr(Classi _ii | Object) * Pr(Object)\)</span>å°±å¯ä»¥å¾—åˆ°<span class="math inline">\(Pr(Class_i)\)</span>ï¼Œå…¬å¼å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181039208.png" style="zoom:80%"></p><p>é€šè¿‡è¿™ä¸ªè¡¨è¾¾å¼æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><ul><li>å®ƒä¸ºæŸä¸ªç›®æ ‡çš„æ¦‚ç‡</li><li>é¢„æµ‹çš„BBoxå’ŒGTBBoxçš„é‡åˆç¨‹åº¦ï¼ˆIoUï¼‰</li></ul></blockquote><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181043266.png" style="zoom:67%"></p><p>ä¸€ä¸ªç½‘æ ¼éœ€ç”Ÿæˆä¸¤ä¸ªBBoxï¼Œæ¯ä¸ªBBoxé™¤äº†è¦é¢„æµ‹4ä¸ªåæ ‡å¤–ï¼Œè¿˜éœ€è¦é¢„æµ‹ä¸€ä¸ªconfidenceï¼ˆç½®ä¿¡åº¦ï¼‰ï¼Œ</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181056221.png" style="zoom:80%"></p><p>ä»¥VOC2012 20ä¸ªç±»åˆ«ä¸¾ä¾‹ï¼Œæ¯ä¸ªç½‘æ ¼é¢„æµ‹2ä¸ªBBoxå’Œå¯¹åº”çš„confidenceï¼Œè¿˜æœ‰20ä¸ªç±»åˆ«å¾—åˆ†==&gt; å…±30ä¸ªchannel</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181043425.png" style="zoom:50%"></p><h2 id="ç½‘ç»œç»“æ„">1.4 ç½‘ç»œç»“æ„</h2><figure><img src="https://img-blog.csdnimg.cn/2ab62250d3864381803e990d47c4f25c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><figcaption aria-hidden="true">åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</figcaption></figure><blockquote><p>å¦‚æœæ²¡æœ‰æ ‡<code>s</code>ï¼Œé‚£ä¹ˆå®ƒé»˜è®¤çš„stride=1</p></blockquote><p>Q1ï¼š <code>fc(1470)</code>ä¸­çš„1470æ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿ A1ï¼šå› ä¸ºè¾“å‡ºæ˜¯[7, 7, 30]ï¼Œè€Œè¿™ä¸ªè¾“å‡ºç‰¹å¾å›¾æ˜¯ç»è¿‡reshapeå¾—åˆ°çš„ï¼Œæ‰€ä»¥ç»è¿‡FCä¹‹åï¼Œè¾“å‡ºçš„ä¸€ç»´å‘é‡shapeåº”è¯¥ä¸º1470ã€‚</p><p>Q2ï¼šä¸ºä»€ä¹ˆæ˜¯[7, 7, 30]ï¼Ÿ A2ï¼š7Ã—7ä»£è¡¨å°†å›¾ç‰‡åˆ’åˆ†ä¸º7Ã—7ä¸ªç½‘æ ¼ï¼Œ30ä¸ºæ¯ä¸ªç½‘æ ¼çš„ä¿¡æ¯ï¼ˆå‚æ•°ä¸ªæ•°ï¼‰ã€‚</p><h2 id="æŸå¤±å‡½æ•°">1.5 æŸå¤±å‡½æ•°</h2><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181100965.png" style="zoom:50%"></p><p>åœ¨è®¡ç®—è¿™äº›æŸå¤±æ—¶ï¼Œä¸»è¦ä½¿ç”¨çš„æ˜¯<strong>è¯¯å·®å¹³æ–¹å’Œ</strong>è¿™ä¸ªå‡½æ•°è¿›è¡Œçš„</p><p>è¯¯å·®å¹³æ–¹å’Œï¼š <span class="math display">\[ è¯¯å·®=(é¢„æµ‹çš„xâˆ’çœŸå®çš„x)^2+(é¢„æµ‹çš„yâˆ’çœŸå®çš„y)^2=(è¯¯å·®1)^2+(è¯¯å·®2)^2 \]</span> è¿™å°±æ˜¯è¯¯å·®å¹³æ–¹å’ŒğŸ˜‚</p><h3 id="bboxæŸå¤±">1.5.1 BBoxæŸå¤±</h3><p>â€‹ 1.5.1 BBoxæŸå¤±</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181105392.png" style="zoom:67%"></p><p>å…¶ä¸­ï¼š</p><ul><li><span class="math inline">\(x_i, y_i, w_i, h_i\)</span>ä¸ºé¢„æµ‹å€¼</li><li><span class="math inline">\(\hat{x_i}, \hat{y_i}, \hat{w_i}, \hat{h_i}\)</span>ä¸ºGTå€¼</li><li>$ ^{}_{ij}$è¡¨ç¤ºå½“å‰ä¸ºç›®æ ‡æ—¶ä¸º1ï¼Œä¸ä¸ºç›®æ ‡æ—¶ä¸º0 â€”â€” æ­£æ ·æœ¬ä¸º1ï¼Œè´Ÿæ ·æœ¬ä¸º0</li></ul><p>å¯¹äº<span class="math inline">\(w\)</span>å’Œ<span class="math inline">\(h\)</span>çš„æŸå¤±ï¼ŒåŠ çš„ç›®çš„æ˜¯<font color="#FF0000">æ”¾å¤§[å°ç›®æ ‡]çš„æŸå¤±</font>ï¼ˆä¸åŒå¤§å°çš„ç›®æ ‡ï¼Œåç§»ç›¸åŒçš„è·ç¦»å¾—åˆ°æŸå¤±æ˜¯ä¸ä¸€æ ·çš„ï¼‰</p><figure><img src="https://img-blog.csdnimg.cn/517a4c05eedb4ef78acdc43b750230df.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><figcaption aria-hidden="true">åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</figcaption></figure><p>å¦‚æœä½¿ç”¨<span class="math inline">\(y=x\)</span>è¿™æ ·çš„ç­–ç•¥ï¼Œé‚£ä¹ˆåœ¨ç›¸åŒåç§»é‡çš„æƒ…å†µä¸‹ï¼ŒäºŒè€…çš„lossæ˜¯ç›¸åŒçš„ã€‚çœ‹å³é¢çš„å›¾ï¼Œå¾ˆæ˜æ˜¾ï¼Œå¯¹äºå°ç›®æ ‡è€Œè¨€å®ƒä½ç§»ç›¸å¯¹æ›´å¤§ï¼Œç†åº”æœ‰æ›´å¤§çš„æŸå¤±ã€‚</p><p>ä¸ºäº†è¾¾åˆ°è¿™æ ·çš„æ•ˆæœï¼Œä½œè€…ä½¿ç”¨äº†å¼€æ ¹å·ï¼Œå¯¹äº<span class="math inline">\(y=\sqrt{x}\)</span>æ¥è¯´ï¼Œ<span class="math inline">\(x\)</span>è¶Šå¤§ï¼Œ<span class="math inline">\(y\)</span>è¶Šå¹³ç¼“ã€‚</p><h3 id="confidenceæŸå¤±">1.5.2 confidenceæŸå¤±</h3><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181107432.png" style="zoom:67%"></p><p>å…¶ä¸­ï¼š</p><ul><li><span class="math inline">\(\mathbb{1}^{\text{obj}}_{ij}\)</span>è¡¨ç¤ºå½“å‰ä¸ºç›®æ ‡æ—¶ä¸º1ï¼Œä¸ä¸ºç›®æ ‡æ—¶ä¸º0 â€”â€” æ­£æ ·æœ¬ä¸º1ï¼Œè´Ÿæ ·æœ¬ä¸º0</li><li><span class="math inline">\(\mathbb{1}^{\text{noobj}}_{ij}\)</span>è¡¨ç¤ºå½“å‰ä¸ä¸ºç›®æ ‡æ—¶ä¸º1ï¼Œæ˜¯ç›®æ ‡æ—¶ä¸º0 â€”â€” è´Ÿæ ·æœ¬ä¸º1ï¼Œæ­£æ ·æœ¬ä¸º0</li><li><span class="math inline">\(\lambda_{\text{noobj}}\)</span>è¡¨ç¤ºä¸ä¸ºç›®æ ‡æ—¶çš„ä¸€ä¸ªç³»æ•° â€”â€” <strong>è´Ÿæ ·æœ¬ç½®ä¿¡åº¦è¯¯å·®çš„æƒé‡</strong></li></ul><p>â€‹ å› ä¸ºä¹‹å‰å°±è¯´è¿‡äº†ï¼Œ<strong>è¿™é‡Œçš„confidenceç½®ä¿¡åº¦æŒ‡çš„æ˜¯å½“å‰é¢„æµ‹çš„BBoxå’ŒGTBoxçš„IoUå€¼ï¼Œå³è¯¥é¢„æµ‹BBoxä¸ºå¼ æ ·æœ¬çš„æ¦‚ç‡</strong>ã€‚è€Œä¸æ˜¯å½“å‰BBoxçš„ç±»åˆ«æ¦‚ç‡ã€‚</p><blockquote><p><span class="math inline">\(Confidence = Pr(Object) * IoU^{\text{truth}}_{\text{pred}}\)</span></p></blockquote><p>å¯¹äºæ­£æ ·æœ¬ï¼Œå®ƒçš„çœŸå®å€¼<span class="math inline">\(\hat{C_i}\)</span>ä¸º1ï¼›å¯¹äºè´Ÿæ ·æœ¬ï¼Œå®ƒçš„çœŸå®å€¼$ $åº”è¯¥ä¸º0ã€‚</p><h3 id="ç±»åˆ«æŸå¤±">1.5.3 ç±»åˆ«æŸå¤±</h3><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181110966.png" style="zoom:80%"> å…¶ä¸­ï¼š</p><ul><li><span class="math inline">\(p_i(c)\)</span>ä¸ºè¯¥grid cellçš„ç±»åˆ«é¢„æµ‹å€¼ä¸º<span class="math inline">\(c\)</span>ç±»åˆ«çš„æ¦‚ç‡</li><li><span class="math inline">\(\hat{p_i}(c)\)</span>ä¸ºè¯¥grid cellå¯¹åº”çš„GTBoxçš„<span class="math inline">\(c\)</span>ç±»åˆ«çš„æ¦‚ç‡ï¼ˆäºŒå€¼åŒ–ï¼Œåªèƒ½æ˜¯0æˆ–1ï¼‰</li></ul><h2 id="yolo-v1å­˜åœ¨çš„é—®é¢˜">1.6 YOLO v1å­˜åœ¨çš„é—®é¢˜</h2><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181111789.png" style="zoom:67%"></p><ol type="1"><li>å¯¹å¯†é›†ç›®æ ‡æ£€æµ‹æ•ˆæœå¾ˆå·® â€”â€” æ¯”å¦‚æœ‰ä¸€ç¾¤é¸Ÿ â€”â€” åŸå› æ˜¯grid cellæ•°é‡å°‘ä¸”æ¯ä¸ªgrid cellåªé¢„æµ‹ä¸¤ä¸ªBBox â€”â€” æœ€å¤šé¢„æµ‹7Ã—7Ã—2=98ä¸ªç›®æ ‡</li><li>å½“ç›®æ ‡å‡ºç°æ–°çš„å°ºå¯¸æˆ–é…ç½®æ—¶ï¼Œæ£€æµ‹æ•ˆæœä¹Ÿå¾ˆå·®</li><li>ä¸»è¦é”™è¯¯çš„åŸå› æ˜¯å®šä½é”™è¯¯ â€”â€” ä¸»è¦å› ä¸ºv1æ˜¯ç›´æ¥é¢„æµ‹ç›®æ ‡åæ ‡è€Œä¸åƒFaster R-CNNå’ŒSSDé‚£æ ·é¢„æµ‹å›å½’å‚æ•° â€”â€” åŸºäºæ­¤ï¼Œä»YOLO v2å¼€å§‹ï¼Œä½¿ç”¨åŸºäºAnchorçš„å›å½’é¢„æµ‹æœºåˆ¶ã€‚</li></ol><h2 id="yolo-v1ä¸­çš„bounding-box-å’Œ-anchor-æœ‰ä»€ä¹ˆåŒºåˆ«">1.7 YOLO v1ä¸­çš„Bounding Box å’Œ Anchor æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2><p>â€‹ Bounding Boxï¼ˆBBoxï¼‰è¯‘ä¸ºè¾¹ç•Œæ¡†ï¼Œåœ¨YOLO v1ä¸­å®ƒçš„ä¸­å¿ƒä½äºæ‰€å±çš„grid cellä¸­å¿ƒï¼Œå®ƒè¿›è¡Œå®šä½å›å½’æ—¶ï¼Œä¸æ˜¯ç”¨å›å½’å‚æ•°ä¸€ç‚¹ä¸€ç‚¹å»è¿›è¡Œè°ƒæ•´ï¼Œè€Œæ˜¯<strong>ç›´æ¥é¢„æµ‹ç›®æ ‡çš„å›¾åƒåæ ‡</strong>ï¼Œè¿™å°±å¯¼è‡´YOLO v1 BBoxçš„å®šä½å›å½’å¾ˆå·® â€”â€” é‡è›®ç”Ÿé•¿ã€‚</p><p>â€‹ Anchorè¯‘ä¸ºé”šæ¡†ï¼ŒåƒFaster R-CNNå’ŒSSDé‚£æ ·ï¼Œå…ˆç”ŸæˆAnchorï¼Œç„¶å<strong>åœ¨å®šä½å›å½’æ—¶é¢„æµ‹çš„æ˜¯å›å½’å‚æ•°ï¼Œå³anchorçš„ç§»åŠ¨å‚æ•°</strong>ã€‚ä¸æ˜¯ç›´æ¥è®©anchoré¢„æµ‹ç›®æ ‡çš„ä½ç½®ï¼Œæ‰€ä»¥å®šä½æ•ˆæœæ¯”YOLO v1è¦å¥½ â€”â€” å¾®è°ƒã€‚</p><h1 id="yolo-v2">2. YOLO v2</h1><p>è®ºæ–‡é¢˜ç›®ï¼šYOLO9000: Better, Faster, Stronger</p><p>è®ºæ–‡åœ°å€ï¼šhttps://arxiv.org/abs/1612.08242</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181113371.png" style="zoom:67%"></p><h2 id="yolo-v2-ä¸å…¶ä»–ç½‘ç»œçš„æ€§èƒ½å¯¹æ¯”">2.1 YOLO v2 ä¸å…¶ä»–ç½‘ç»œçš„æ€§èƒ½å¯¹æ¯”</h2><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181130195.png"></p><h2 id="yolo-v2ç›¸æ¯”v1çš„å°è¯•">2.2 YOLO v2ç›¸æ¯”v1çš„å°è¯•</h2><ul><li>Batch Normalization</li><li>High Resolution Classifier</li><li>Convolutional With Anchor Boxes</li><li>Dimension Clusters</li><li>Direct Location Prediction</li><li>Fine-Grained Features</li><li>Multi-scale Training</li></ul><h3 id="batch-normalization">2.2.1 Batch Normalization</h3><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181130323.png" style="zoom:80%"></p><p>åœ¨YOLO v1æ—¶æ²¡æœ‰ä½¿ç”¨BNå±‚ï¼Œåœ¨v2ä¸­æ¯ä¸ªå·ç§¯å±‚åé¢åŠ ä¸Šäº†BNå±‚ã€‚å¥½å¤„ï¼š</p><ol type="1"><li>åŠ é€Ÿæ¨¡å‹æ”¶æ•›</li><li>å‡å°‘æ‰€éœ€ä½¿ç”¨ä½¿ç”¨çš„æ­£åˆ™åŒ–æ“ä½œ â€”â€” BNå¯¹æ¨¡å‹èµ·åˆ°äº†æ­£åˆ™åŒ–ä½œç”¨</li><li>æå‡2%çš„mAP</li><li>ä½œè€…æå‡ºä¸€ä¸ªè§‚ç‚¹ï¼šä½¿ç”¨äº†BNå±‚å°±å¯ä»¥ä¸ç”¨Dropoutå±‚</li></ol><h3 id="high-resolution-classifieré«˜åˆ†è¾¨ç‡åˆ†ç±»å™¨">2.2.2 High Resolution Classifierï¼Œé«˜åˆ†è¾¨ç‡åˆ†ç±»å™¨</h3><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181132721.png" style="zoom:67%"> åœ¨YOLO v1ä¸­è®­ç»ƒbackboneçš„è¾“å…¥åƒç´ ä¸º224Ã—224ï¼ˆä¸»è¦æ˜¯é‚£ä¸ªæ—¶å€™è®­ç»ƒbackboneåŸºæœ¬ä¸Šéƒ½æ˜¯ç”¨224Ã—224çš„å›¾ç‰‡ï¼‰ï¼Œç„¶è€Œåœ¨YOLO v2ä¸­ä½œè€…ä½¿ç”¨äº†ä¸€ä¸ªæ›´å¤§è¾“å…¥å°ºå¯¸ â€”â€” 448Ã—448ã€‚å³ç½‘ç»œå…ˆç”¨224Ã—224çš„å›¾ç‰‡è¿›è¡Œè®­ç»ƒï¼Œè®­ç»ƒå®Œæ¯•åå†å¯¹å…¶è¿›è¡Œ10ä¸ªEpochçš„å¾®è°ƒï¼ˆè¿ç§»å­¦ä¹ ï¼‰ï¼Œæ­¤æ—¶è¾“å…¥å›¾ç‰‡å¤§å°ä¸º448Ã—448ã€‚</p><p>é‡‡ç”¨æ›´å¤§è¾“å…¥å›¾ç‰‡çš„åˆ†ç±»å™¨ç»™ç›®æ ‡æ£€æµ‹ç½‘ç»œå¸¦æ¥å“ªäº›å¥½å¤„å‘¢ï¼Ÿ4%mAP</p><h3 id="convolutional-with-anchor-boxesåŸºäºanchor-boxesçš„å·ç§¯">2.2.3 Convolutional With Anchor Boxesï¼ŒåŸºäºAnchor Boxesçš„å·ç§¯</h3><p>Convolutional With Anchor Boxesï¼ŒåŸºäºAnchor Boxesçš„å·ç§¯ï¼Œè¯´ç™½äº†å°±æ˜¯åŸºäºAnchorçš„ç›®æ ‡è¾¹ç•Œæ¡†é¢„æµ‹ï¼ˆä¸åƒv1ä¸­é‚£æ ·é‡è›®ç”Ÿé•¿äº†ï¼‰ã€‚</p><p>â€‹ YOLO predicts the coordinates of bounding boxes directly using fully connected layers on top of the convolutional feature extractor.Instead of predicting coordinates directly Faster R-CNN predicts bounding boxes using hand-picked priors. Using only convolutional layers the region proposal network (RPN) in Faster R-CNN predicts offsets and confidences for anchor boxes. Since the prediction layer is convolutional, the RPN predicts these offsets at every location in a feature map. Predicting offsets instead of coordinates simplifies the problem and makes it easier for the network to learn.</p><p>â€‹ YOLO v1ç›´æ¥ä½¿ç”¨å·ç§¯ç‰¹å¾æå–å™¨é¡¶éƒ¨çš„å…¨è¿æ¥å±‚ç›´æ¥é¢„æµ‹è¾¹ç•Œæ¡†çš„åæ ‡ã€‚<strong>Faster R-CNN ä½¿ç”¨æ‰‹å·¥æŒ‘é€‰çš„å…ˆéªŒé¢„æµ‹è¾¹ç•Œæ¡†</strong>ï¼Œè€Œä¸æ˜¯ç›´æ¥é¢„æµ‹åæ ‡ã€‚ Faster R-CNN ä¸­çš„åŒºåŸŸæè®®ç½‘ç»œ (RPN) ä»…ä½¿ç”¨å·ç§¯å±‚æ¥é¢„æµ‹é”šæ¡†çš„åç§»é‡å’Œç½®ä¿¡åº¦ã€‚ ç”±äºé¢„æµ‹å±‚æ˜¯å·ç§¯å±‚ï¼Œå› æ­¤ RPN ä¼šåœ¨ç‰¹å¾å›¾ä¸­çš„æ¯ä¸ªä½ç½®é¢„æµ‹è¿™äº›åç§»é‡ã€‚ <strong>é¢„æµ‹åç§»é‡è€Œä¸æ˜¯åæ ‡å¯ä»¥ç®€åŒ–é—®é¢˜å¹¶ä½¿ç½‘ç»œæ›´å®¹æ˜“å­¦ä¹ </strong>ã€‚</p><blockquote><p><strong>Faster R-CNN ä½¿ç”¨æ‰‹å·¥æŒ‘é€‰çš„å…ˆéªŒé¢„æµ‹è¾¹ç•Œæ¡†</strong>ï¼šFaster R-CNNå…ˆæŒ‘é€‰äº†é›†ä¸­å°ºå¯¸çš„é¢„æµ‹æ¡†ï¼Œç„¶åå¯¹äºæ¯ä¸ªé¢„æµ‹ç‰¹å¾å›¾ä¸Šçš„æ¯ä¸ªåƒç´ éƒ½ä¼šè¿›è¡Œanchorçš„ç”Ÿæˆï¼Œå³æ¯ä¸ªåƒç´ ä¸Šéƒ½ä¼šç”Ÿæˆè¿™äº›å…ˆéªŒçš„é¢„æµ‹æ¡†ï¼Œä¹‹åé€šè¿‡RPNç½‘ç»œé¢„æµ‹å…¶å›å½’çš„å‚æ•°å’Œç½®ä¿¡åº¦ï¼ˆè¿™é‡Œçš„ç½®ä¿¡åº¦æ˜¯è¯¥Anchorçš„ç±»åˆ«æ¦‚ç‡ï¼Œå’ŒYOLO v1ä¸­çš„confidenceä¸åŒï¼‰ã€‚ è¿™é‡Œä½œè€…å¯¹Faster R-CNNä¸­åæ ‡å›å½’è¡¨ç¤ºè‚¯å®š</p></blockquote><p>We remove the fully connected layers from YOLO and use anchor boxes to predict bounding boxes. First we eliminate one pooling layer to make the output of the networkâ€™s convolutional layers higher resolution. We also shrink the network to operate on 416 input images instead of 448Ã—448. We do this because we want an odd number of locations in our feature map so there is a single center cell. Objects, especially large objects, tend to occupy the center of the image so itâ€™s good to have a single location right at the center to predict these objects instead of four locations that are all nearby. YOLOâ€™s convolutional layers downsample the image by a factor of 32 so by using an input image of 416 we get an output feature map of 13 Ã— 13.</p><p>æˆ‘ä»¬ä» YOLO ä¸­ç§»é™¤å…¨è¿æ¥å±‚ï¼Œå¹¶ä½¿ç”¨é”šæ¡†æ¥é¢„æµ‹è¾¹ç•Œæ¡†ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬æ¶ˆé™¤äº†ä¸€ä¸ªæ± åŒ–å±‚ï¼Œä»¥ä½¿ç½‘ç»œå·ç§¯å±‚çš„è¾“å‡ºå…·æœ‰æ›´é«˜çš„åˆ†è¾¨ç‡ã€‚ æˆ‘ä»¬è¿˜ç¼©å°äº†ç½‘ç»œä»¥å¯¹ 416 ä¸ªè¾“å…¥å›¾åƒè€Œä¸æ˜¯ 448Ã—448 è¿›è¡Œæ“ä½œã€‚ æˆ‘ä»¬è¿™æ ·åšæ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è¦åœ¨æˆ‘ä»¬çš„ç‰¹å¾å›¾ä¸­æœ‰å¥‡æ•°ä¸ªä½ç½®ï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªä¸­å¿ƒå•å…ƒã€‚ ç›®æ ‡ï¼Œå°¤å…¶æ˜¯å¤§ç›®æ ‡ï¼Œå¾€å¾€å æ®å›¾åƒçš„ä¸­å¿ƒï¼Œå› æ­¤æœ€å¥½åœ¨ä¸­å¿ƒæœ‰ä¸€ä¸ªä½ç½®æ¥é¢„æµ‹è¿™äº›ç‰©ä½“ï¼Œè€Œä¸æ˜¯å››ä¸ªéƒ½åœ¨é™„è¿‘çš„ä½ç½®ã€‚ YOLO çš„å·ç§¯å±‚å°†å›¾åƒä¸‹é‡‡æ · 32 å€ï¼Œå› æ­¤é€šè¿‡ä½¿ç”¨ 416 çš„è¾“å…¥å›¾åƒï¼Œæˆ‘ä»¬å¾—åˆ° 13 Ã— 13 çš„è¾“å‡ºç‰¹å¾å›¾ã€‚</p><blockquote><p>è¿™é‡Œè¯´æ˜äº†YOLOçš„architectureæ”¹åŠ¨</p></blockquote><p>When we move to anchor boxes we also decouple the class prediction mechanism from the spatial location and instead predict class and objectness for every anchor box. Following YOLO, the objectness prediction still predicts the IOU of the ground truth and the proposed box and the class predictions predict the conditional probability of that class given that there is an object.</p><p>å½“æˆ‘ä»¬ç§»åŠ¨åˆ°é”šæ¡†æ—¶ï¼Œæˆ‘ä»¬è¿˜å°†ç±»é¢„æµ‹æœºåˆ¶ä¸ç©ºé—´ä½ç½®è§£è€¦ï¼Œè€Œæ˜¯ä¸ºæ¯ä¸ªé”šç›’é¢„æµ‹ç±»å’Œå¯¹è±¡ã€‚ åœ¨ YOLO ä¹‹åï¼Œobjectness prediction ä»ç„¶é¢„æµ‹ ground truth å’Œæå‡ºçš„ box çš„ IOUï¼Œå¹¶ä¸”ç±»é¢„æµ‹åœ¨ç»™å®šå¯¹è±¡çš„æƒ…å†µä¸‹é¢„æµ‹è¯¥ç±»çš„æ¡ä»¶æ¦‚ç‡ã€‚</p><p>Using anchor boxes we get a small decrease in accuracy. YOLO only predicts 98 boxes per image but with anchor boxes our model predicts more than a thousand. Without anchor boxes our intermediate model gets 69.5 mAP with a recall of 81%. With anchor boxes our model gets 69.2 mAP with a recall of 88%. Even though the mAP decreases, the increase in recall means that our model has more room to improve.</p><p>ä½¿ç”¨é”šæ¡†ï¼Œæˆ‘ä»¬çš„å‡†ç¡®æ€§ä¼šç•¥æœ‰ä¸‹é™ã€‚ YOLO v1ä»…é¢„æµ‹æ¯å¼ å›¾åƒ 98 ä¸ªæ¡†ï¼Œä½†ä½¿ç”¨é”šæ¡†ï¼Œæˆ‘ä»¬çš„æ¨¡å‹é¢„æµ‹è¶…è¿‡ 1000 ä¸ªæ¡†ã€‚</p><ul><li>åœ¨æ²¡æœ‰é”šæ¡†çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ä¸­é—´æ¨¡å‹å¾—åˆ° 69.5 mAPï¼Œå¬å›ç‡ä¸º 81%</li><li>ä½¿ç”¨é”šæ¡†ï¼Œæˆ‘ä»¬çš„æ¨¡å‹è·å¾— 69.2 mAPï¼Œå¬å›ç‡ä¸º 88%</li></ul><p>å°½ç®¡ mAP é™ä½äº†ï¼Œä½†<strong>å¬å›ç‡çš„å¢åŠ æ„å‘³ç€æˆ‘ä»¬çš„æ¨¡å‹è¿˜æœ‰æ›´å¤šçš„æ”¹è¿›ç©ºé—´</strong>ã€‚</p><h3 id="dimension-clustersç»´åº¦èšç±»-anchorå…ˆéªŒæ¡†çš„èšç±»">2.2.4 Dimension Clustersï¼Œç»´åº¦èšç±» â€”â€” anchorå…ˆéªŒæ¡†çš„èšç±»</h3><p>We encounter two issues with anchor boxes when using them with YOLO. The first is that the box dimensions are hand picked. The network can learn to adjust the boxes appropriately but if we pick better priors for the network to start with we can make it easier for the network to learn to predict good detections. <strong>Instead of choosing priors by hand, we run k-means clustering on the training set bounding boxes to automatically find good priors.</strong> If we use standard k-means with Euclidean distance larger boxes generate more error than smaller boxes. However, what we really want are priors that lead to good IOU scores, which is independent of the size of the box. Thus for our distance metric we use:</p><p>åœ¨å°†é”šæ¡†ä¸ YOLO ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬é‡åˆ°äº†ä¸¤ä¸ªé—®é¢˜ã€‚ é¦–å…ˆæ˜¯anchorå°ºå¯¸æ˜¯æ‰‹å·¥æŒ‘é€‰çš„ã€‚ ç½‘ç»œå¯ä»¥å­¦ä¹ é€‚å½“åœ°è°ƒæ•´æ¡†ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸ºç½‘ç»œé€‰æ‹©æ›´å¥½çš„å…ˆéªŒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç½‘ç»œæ›´å®¹æ˜“å­¦ä¹ é¢„æµ‹è‰¯å¥½çš„æ£€æµ‹ã€‚ æˆ‘ä»¬ä¸æ˜¯æ‰‹åŠ¨é€‰æ‹©å…ˆéªŒï¼Œ<strong>è€Œæ˜¯åœ¨è®­ç»ƒé›†è¾¹ç•Œæ¡†ä¸Šè¿è¡Œ k-means èšç±»ä»¥è‡ªåŠ¨æ‰¾åˆ°å¥½çš„å…ˆéªŒ</strong>ã€‚ å¦‚æœæˆ‘ä»¬ä½¿ç”¨å…·æœ‰æ¬§å‡ é‡Œå¾·è·ç¦»çš„æ ‡å‡† k-meansï¼Œåˆ™è¾ƒå¤§çš„æ¡†ä¼šæ¯”è¾ƒå°çš„æ¡†äº§ç”Ÿæ›´å¤šçš„é”™è¯¯ã€‚ ç„¶è€Œï¼Œæˆ‘ä»¬çœŸæ­£æƒ³è¦çš„æ˜¯å¯¼è‡´è‰¯å¥½ IOU åˆ†æ•°çš„å…ˆéªŒï¼Œè¿™ä¸æ¡†çš„å¤§å°æ— å…³ã€‚ å› æ­¤ï¼Œå¯¹äºæˆ‘ä»¬çš„è·ç¦»åº¦é‡ï¼Œæˆ‘ä»¬ä½¿ç”¨ï¼š <span class="math display">\[ d(\text{box, centroid}) = 1 - \text{IoU(box, centroid)} \]</span> We run k-means for various values of k and plot the average IOU with closest centroid, see Figure 2. We choose k = 5 as a good tradeoff between model complexity and high recall. The cluster centroids are significantly different than hand-picked anchor boxes. There are fewer short, wide boxes and more tall, thin boxes.</p><p>â€‹ æˆ‘ä»¬å¯¹ä¸åŒçš„ k å€¼è¿è¡Œ k-means å¹¶ç»˜åˆ¶å…·æœ‰æœ€è¿‘è´¨å¿ƒçš„å¹³å‡ IOUï¼Œè§å›¾ 2ã€‚æˆ‘ä»¬é€‰æ‹© k = 5 ä½œä¸ºæ¨¡å‹å¤æ‚æ€§å’Œé«˜å¬å›ç‡ä¹‹é—´çš„è‰¯å¥½æŠ˜è¡·ã€‚ èšç±»è´¨å¿ƒä¸æ‰‹å·¥æŒ‘é€‰çš„é”šæ¡†æœ‰å¾ˆå¤§ä¸åŒã€‚ çŸ­è€Œå®½çš„ç›’å­æ›´å°‘ï¼Œè€Œé«˜è€Œè–„çš„ç›’å­æ›´å¤šã€‚</p><blockquote><p>çŸ®èƒ–çš„å…ˆéªŒæ¡†æ¯”è¾ƒå°‘ï¼Œé«˜ç˜¦çš„å…ˆéªŒæ¡†æ¯”è¾ƒå¤š â€”â€” è¿™å–å†³äºè®­ç»ƒé›†Objectçš„æ¯”ä¾‹</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181137911.png" style="zoom:50%"></p><p>We compare the average IOU to closest prior of our clustering strategy and the hand-picked anchor boxes in Table 1. At only 5 priors the centroids perform similarly to 9 anchor boxes with an average IOU of 61.0 compared to 60.9. If we use 9 centroids we see a much higher average IOU. This indicates that using k-means to generate our bounding box starts the model off with a better representation and makes the task easier to learn.</p><p>æˆ‘ä»¬å°†å¹³å‡ IOU ä¸æˆ‘ä»¬çš„èšç±»ç­–ç•¥çš„æœ€æ¥è¿‘å…ˆéªŒå’Œè¡¨ 1 ä¸­æ‰‹å·¥æŒ‘é€‰çš„é”šæ¡†è¿›è¡Œæ¯”è¾ƒã€‚åœ¨åªæœ‰ 5 ä¸ªå…ˆéªŒæ—¶ï¼Œè´¨å¿ƒçš„æ€§èƒ½ä¸ 9 ä¸ªé”šæ¡†ç›¸ä¼¼ï¼Œå¹³å‡ IOU ä¸º 61.0ï¼Œè€Œå¹³å‡ IOU ä¸º 60.9ã€‚ å¦‚æœæˆ‘ä»¬ä½¿ç”¨ 9 ä¸ªè´¨å¿ƒï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°æ›´é«˜çš„å¹³å‡ IOUã€‚ è¿™è¡¨æ˜ä½¿ç”¨ k-means ç”Ÿæˆæˆ‘ä»¬çš„è¾¹ç•Œæ¡†ä»¥æ›´å¥½çš„è¡¨ç¤ºå¯åŠ¨æ¨¡å‹å¹¶ä½¿ä»»åŠ¡æ›´å®¹æ˜“å­¦ä¹ ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181137172.png" style="zoom:50%"></p><h3 id="direct-location-predictionç›´æ¥å®šä½é¢„æµ‹-é¢„æµ‹è¾¹ç•Œæ¡†å®šä½å›å½’">2.2.5 Direct Location Predictionï¼Œç›´æ¥å®šä½é¢„æµ‹ â€”â€” é¢„æµ‹è¾¹ç•Œæ¡†å®šä½å›å½’</h3><p>When using anchor boxes with YOLO we encounter a second issue: model instability, especially during early iterations. Most of the instability comes from predicting the ( x , y ) (x, y)(x,y) locations for the box. In region proposal networks the network predicts values t x t_xtx and t y t_yty and the ( x , y ) (x, y)(x,y) center coordinates are calculated as:</p><p>åœ¨ YOLO ä¸­ä½¿ç”¨é”šæ¡†æ—¶ï¼Œæˆ‘ä»¬é‡åˆ°äº†ç¬¬äºŒä¸ªé—®é¢˜ï¼š<strong>æ¨¡å‹ä¸ç¨³å®šï¼Œå°¤å…¶æ˜¯åœ¨æ—©æœŸè¿­ä»£æœŸé—´</strong>ã€‚ å¤§å¤šæ•°ä¸ç¨³å®šæ€§æ¥è‡ªäºé¢„æµ‹è¾¹ç•Œæ¡†çš„<span class="math inline">\((x, y)\)</span>ä½ç½®ã€‚ åœ¨RPNç½‘ç»œä¸­ï¼Œç½‘ç»œé¢„æµ‹å€¼ <span class="math inline">\(t_x\)</span> å’Œ<span class="math inline">\(t_y\)</span> ä»¥åŠ<span class="math inline">\((x, y)\)</span> ä¸­å¿ƒåæ ‡è®¡ç®—å¦‚ä¸‹ï¼š <span class="math display">\[ x=(txÃ—wa)+wa \]</span></p><p><span class="math display">\[ y=(tyÃ—ha)+ya \]</span></p><blockquote><p>è®ºæ–‡ä¸­ç»™å‡ºçš„å…¬å¼å…¶å®æ˜¯é”™è¯¯çš„ï¼Œä¸æ˜¯<code>-</code>è€Œåº”è¯¥æ˜¯<code>+</code> å…¶ä¸­ï¼š</p><ul><li><span class="math inline">\(t_x, t_y\)</span>ä¸ºé¢„æµ‹æ¡†çš„ä¸­å¿ƒç‚¹å›å½’å‚æ•°</li><li><span class="math inline">\(x, y\)</span>ä¸ºé¢„æµ‹æ¡†çš„ä¸­å¿ƒç‚¹åæ ‡</li><li><span class="math inline">\(x_a, y_a, w_a, h_a\)</span>ä¸ºanchorçš„ä¸­å¿ƒç‚¹åæ ‡å’Œanchorå®½åº¦ã€é«˜åº¦ã€‚</li></ul></blockquote><p>For example, a prediction of <span class="math inline">\(t_x = 1\)</span> would shift the box to the right by the width of the anchor box, a prediction of <span class="math inline">\(t_x = âˆ’1\)</span> would shift it to the left by the same amount.</p><p>ä¾‹å¦‚ï¼Œ<span class="math inline">\(t_x = 1\)</span>çš„é¢„æµ‹ä¼šå°†æ¡†å‘å³ç§»åŠ¨é”šæ¡†çš„å®½åº¦ï¼Œ<span class="math inline">\(t_x = -1\)</span> çš„é¢„æµ‹ä¼šå°†å…¶å‘å·¦ç§»åŠ¨ç›¸åŒçš„é‡ã€‚</p><p>This formulation is unconstrained so any anchor box can end up at any point in the image, regardless of what location predicted the box. With random initialization the model takes a long time to stabilize to predicting sensible offsets. Instead of predicting offsets we follow the approach of YOLO and predict location coordinates relative to the location of the grid cell. This bounds the ground truth to fall between 0 and 1. We use a logistic activation to constrain the networkâ€™s predictions to fall in this range.</p><p><strong>ç”±äºè¿™ä¸ªå…¬å¼æ˜¯ä¸å—çº¦æŸçš„ï¼Œå› æ­¤ä»»ä½•é”šæ¡†éƒ½å¯ä»¥åœ¨å›¾åƒä¸­çš„ä»»ä½•ç‚¹ç»“æŸ</strong>ï¼Œè€Œä¸ç®¡é¢„æµ‹æ¡†çš„ä½ç½®å¦‚ä½•ã€‚ é€šè¿‡éšæœºåˆå§‹åŒ–ï¼Œ<strong>æ¨¡å‹éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½ç¨³å®šåˆ°é¢„æµ‹åˆç†çš„åç§»é‡</strong>ã€‚ æˆ‘ä»¬éµå¾ª YOLO çš„æ–¹æ³•å¹¶é¢„æµ‹ç›¸å¯¹äºç½‘æ ¼å•å…ƒä½ç½®çš„ä½ç½®åæ ‡ï¼Œè€Œä¸æ˜¯é¢„æµ‹åç§»é‡ã€‚ è¿™å°†åŸºæœ¬äº‹å®é™åˆ¶åœ¨ 0 å’Œ 1 ä¹‹é—´ã€‚æˆ‘ä»¬ä½¿ç”¨é€»è¾‘æ¿€æ´»æ¥é™åˆ¶ç½‘ç»œçš„é¢„æµ‹è½åœ¨è¿™ä¸ªèŒƒå›´å†…ã€‚</p><blockquote><p>ç”±äºä¸Šé¢é‚£ä¸ªå…¬å¼ä¸­çš„é¢„æµ‹å€¼<span class="math inline">\(t_x, t_y\)</span>æ²¡æœ‰é™åˆ¶ï¼Œæ‰€ä»¥è¿™ç§å›å½’æ–¹å¼çš„é¢„æµ‹æ¡†<strong>å¯èƒ½å‡ºç°åœ¨å›¾åƒä¸­çš„ä»»æ„ä¸€ä¸ªåœ°æ–¹</strong>ï¼Œä¸¾ä¸ªæç«¯çš„ä¾‹å­ï¼š <img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181145698.png" style="zoom:50%"> ä¸ºäº†æ”¹å–„è¿™ç§æƒ…å†µï¼Œv2ä¸­é‡‡ç”¨äº†å¦å¤–ä¸€ç§æ–¹æ³•ã€‚</p></blockquote><p>â€‹ å‡è®¾å°†priorsè®¾ç½®åœ¨æ¯ä¸€ä¸ªgrid cellçš„å·¦ä¸Šè§’ï¼Œå®ƒçš„ä¸­å¿ƒç‚¹åæ ‡ä¸º<span class="math inline">\(c_x, c_y\)</span>ï¼Œå®½åº¦å’Œé«˜åº¦ä¸º<span class="math inline">\(p_w, p_h\)</span>ï¼Œåˆ™å›å½’åçš„anchoråæ ‡ä¸ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181146285.png" style="zoom:80%"></p><blockquote><p>å…¶ä¸­ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181147044.png"></p></blockquote><blockquote><p>ä¸Faster R-CNNçš„å…¬å¼ç›¸æ¯”ï¼Œ<span class="math inline">\(\sigma(t_x)\)</span>å’Œ<span class="math inline">\(\sigma(t_y)\)</span>å¯¹é¢„æµ‹å€¼è¿›è¡Œäº†é™åˆ¶ï¼ˆå°†å…¶é™åˆ¶åœ¨[0, 1]ï¼‰â€”â€” å›å½’åanchorsçš„ä¸­å¿ƒåæ ‡ä¸ä¼šè·‘å‡ºå®ƒçš„grid cellï¼ˆå› ä¸ºåç§»é‡æ˜¯ç›¸å¯¹anchorçš„å·¦ä¸Šè§’è€Œè¨€çš„ï¼Œæ‰€ä»¥ç»å¯¹è·‘ä¸å‡ºå»ï¼ï¼‰ï¼Œä¾‹å­å¦‚ä¸‹ï¼š <img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181147711.png" style="zoom:50%"> è¿™æ ·å°±å®ç°äº† ç›®æ ‡ä¸­å¿ƒç‚¹è½åœ¨æŸä¸ªgrid cellåŒºåŸŸå†…çš„ç›®æ ‡è¢«å…¶grid celläº§ç”Ÿçš„anchorsï¼ˆpriors)é¢„æµ‹ï¼Œä¸­å¿ƒç‚¹æ²¡æœ‰è½åœ¨è¯¥grid cellä¸­ï¼Œé‚£ä¹ˆå°±ä¸ç”±è¯¥grid cellå»è´Ÿè´£é¢„æµ‹äº†ã€‚â€”â€” è§£å†³äº†anchorä¼šå‡ºç°åœ¨å›¾åƒä¸­çš„ä»»æ„åœ°æ–¹ã€‚</p></blockquote><p>Since we constrain the location prediction the parametrization is easier to learn, making the network more stable. Using dimension clusters along with directly predicting the bounding box center location improves YOLO by almost 5% over the version with anchor boxes.</p><p><strong>ç”±äºæˆ‘ä»¬é™åˆ¶äº†ä½ç½®é¢„æµ‹ï¼Œå‚æ•°åŒ–æ›´å®¹æ˜“å­¦ä¹ ï¼Œä½¿ç½‘ç»œæ›´ç¨³å®š</strong>ã€‚ ä½¿ç”¨ç»´åº¦èšç±»ä»¥åŠç›´æ¥é¢„æµ‹è¾¹ç•Œæ¡†ä¸­å¿ƒä½ç½®ï¼Œä¸ä½¿ç”¨é”šæ¡†çš„ç‰ˆæœ¬ç›¸æ¯”ï¼ŒYOLO æé«˜äº†è¿‘ 5%ã€‚</p><p><strong>å¥½å¤„</strong>ï¼š</p><ol type="1"><li>ç›¸æ¯”ä½¿ç”¨Faster R-CNNé‚£æ ·çš„åæ ‡å›å½’ï¼Œä½¿ç”¨â‘ ç»´åº¦èšç±»å¾—åˆ°priorså’Œâ‘¡é™åˆ¶é¢„æµ‹ä½ç½®çš„æ–¹æ³•ï¼ŒmAPæé«˜äº†5%ã€‚</li></ol><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181148737.png" style="zoom:50%"></p><h3 id="fine-grained-featuresç»†ç²’åº¦ç‰¹å¾">2.2.6 Fine-Grained Featuresï¼Œç»†ç²’åº¦ç‰¹å¾</h3><p>This modified YOLO predicts detections on a 13 Ã— 13 feature map. While this is sufficient for large objects, it may benefit from finer grained features for localizing smaller objects. Faster R-CNN and SSD both run their proposal networks at various feature maps in the network to get a range of resolutions. We take a different approach, simply adding a passthrough layer that brings features from an earlier layer at 26 Ã— 26 resolution.</p><p>è¿™ä¸ªä¿®æ”¹åçš„ YOLO é¢„æµ‹ 13 Ã— 13 ç‰¹å¾å›¾ä¸Šçš„æ£€æµ‹ã€‚ è™½ç„¶è¿™å¯¹äºå¤§å‹ç‰©ä½“æ¥è¯´å·²ç»è¶³å¤Ÿäº†ï¼Œä½†å®ƒå¯èƒ½ä¼šå—ç›Šäºç”¨äºå®šä½è¾ƒå°ç‰©ä½“çš„æ›´ç»†ç²’åº¦çš„ç‰¹å¾ã€‚ Faster R-CNN å’Œ SSD éƒ½åœ¨ç½‘ç»œä¸­çš„å„ç§ç‰¹å¾å›¾ä¸Šè¿è¡Œä»–ä»¬çš„proposalç½‘ç»œï¼Œä»¥è·å¾—ä¸€ç³»åˆ—åˆ†è¾¨ç‡ã€‚ æˆ‘ä»¬é‡‡ç”¨ä¸åŒçš„æ–¹æ³•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç›´é€šå±‚ï¼Œä»¥ 26 Ã— 26 çš„åˆ†è¾¨ç‡ä»è¾ƒæ—©çš„å±‚å¼•å…¥ç‰¹å¾ã€‚</p><blockquote><p>æ·±å±‚çš„ç‰¹å¾å›¾å› ä¸ºæ„Ÿå—é‡å¤§ï¼Œæ‰€ä»¥å¯¹äºæ£€æµ‹å¤§ç›®æ ‡æ˜¯æ¯”è¾ƒåˆé€‚çš„ã€‚<strong>ä½†å¯¹äºå°ç›®æ ‡æ¥è¯´ï¼Œå¤ªå¤§çš„æ„Ÿå—é‡å¹¶ä¸æ˜¯ä¸€ä»¶å¥½äº‹ã€‚</strong>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…åŠ å…¥äº†ä¸€ä¸ªç›´é€šå±‚ï¼ˆpassthrough layerï¼‰æ¥èåˆç›¸å¯¹æ²¡é‚£ä¹ˆæ·±çš„ç‰¹å¾å›¾ï¼Œä»¥æ­¤æ¥åŠ å¼ºå°ç›®æ ‡çš„æ£€æµ‹æ•ˆæœã€‚ 13Ã—13çš„ç‰¹å¾å›¾èåˆ26Ã—26çš„ç‰¹å¾å›¾</p></blockquote><p>The passthrough layer concatenates the higher resolution features with the low resolution features by stacking adjacent features into different channels instead of spatial locations, similar to the identity mappings in ResNet. This turns the 26 Ã— 26 Ã— 512 feature map into a 13 Ã— 13 Ã— 2048 feature map, which can be concatenated with the original features. Our detector runs on top of this expanded feature map so that it has access to fine grained features. This gives a modest 1% performance increase.</p><p>ç›´é€šå±‚é€šè¿‡å°†ç›¸é‚»ç‰¹å¾å †å åˆ°ä¸åŒçš„é€šé“è€Œä¸æ˜¯ç©ºé—´ä½ç½®æ¥è¿æ¥æ›´é«˜åˆ†è¾¨ç‡çš„ç‰¹å¾å’Œä½åˆ†è¾¨ç‡çš„ç‰¹å¾ï¼Œç±»ä¼¼äº ResNet ä¸­çš„æ’ç­‰æ˜ å°„ã€‚ è¿™å°† 26 Ã— 26 Ã— 512 çš„ç‰¹å¾å›¾å˜æˆäº† 13 Ã— 13 Ã— 2048 çš„ç‰¹å¾å›¾ï¼Œå¯ä»¥ä¸åŸå§‹ç‰¹å¾è¿›è¡Œæ‹¼æ¥ã€‚ æˆ‘ä»¬çš„æ£€æµ‹å™¨åœ¨è¿™ä¸ªæ‰©å±•çš„ç‰¹å¾å›¾ä¹‹ä¸Šè¿è¡Œï¼Œå› æ­¤å®ƒå¯ä»¥è®¿é—®ç»†ç²’åº¦çš„ç‰¹å¾ã€‚ è¿™ä¼šå¸¦æ¥ 1% çš„é€‚åº¦æ€§èƒ½æå‡ã€‚</p><blockquote><p>è¿™é‡Œçš„2048æ˜¯æ²¡æœ‰ä½¿ç”¨1Ã—1å·ç§¯é™ç»´çš„æƒ…å†µ</p><p>ä½†åœ¨æºç ä¸­ï¼Œä½œè€…ä½¿ç”¨äº†1Ã—1å·ç§¯è¿›è¡Œäº†é™ç»´</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181231042.png"></p><h3 id="multi-scale-trainingå¤šå°ºåº¦è®­ç»ƒ">2.2.7 Multi-scale Trainingï¼Œå¤šå°ºåº¦è®­ç»ƒ</h3><p>The original YOLO uses an input resolution of 448 Ã— 448. With the addition of anchor boxes we changed the resolution to 416Ã—416. However, since our model only uses convolutional and pooling layers it can be resized on the fly. We want YOLOv2 to be robust to running on images of different sizes so we train this into the model.</p><p>åŸå§‹ YOLO ä½¿ç”¨ 448 Ã— 448 çš„è¾“å…¥åˆ†è¾¨ç‡ã€‚é€šè¿‡æ·»åŠ é”šæ¡†ï¼Œæˆ‘ä»¬å°†åˆ†è¾¨ç‡æ›´æ”¹ä¸º 416Ã—416ã€‚ ç„¶è€Œï¼Œç”±äºæˆ‘ä»¬çš„æ¨¡å‹åªä½¿ç”¨å·ç§¯å±‚å’Œæ± åŒ–å±‚ï¼Œå®ƒå¯ä»¥åŠ¨æ€è°ƒæ•´å¤§å°ã€‚ æˆ‘ä»¬å¸Œæœ› YOLOv2 èƒ½å¤Ÿåœ¨ä¸åŒå¤§å°çš„å›¾åƒä¸Šè¿è¡Œï¼Œå› æ­¤æˆ‘ä»¬å°†å…¶è®­ç»ƒåˆ°æ¨¡å‹ä¸­ã€‚</p><blockquote><p>416Ã—416æ˜¯å› ä¸ºæƒ³è¦å¾—åˆ°å¥‡æ•°ä¸ªgrid cellï¼Œè¿™æ ·å®ƒä»¬çš„ä¸­å¿ƒç‚¹å°±æ˜¯ä¸€ä¸ªåƒç´ è€Œä¸æ˜¯æ¯”0.5ä¸ªåƒç´ ï¼Œç»è¿‡ä¸‹é‡‡æ ·åï¼Œæœ€ç»ˆçš„é¢„æµ‹ç‰¹å¾å›¾å¤§å°ä¸º13Ã—13ï¼Œå®ƒæ˜¯å¥‡æ•°çš„ï¼Œæ‰€ä»¥æœ‰å¾ˆæ˜æ˜¾çš„ä¸­å¿ƒç‚¹ã€‚</p></blockquote><p>Instead of fixing the input image size we change the network every few iterations. Every 10 batches our network randomly chooses a new image dimension size. Since our model downsamples by a factor of 32, we pull from the following multiples of 32: {320, 352, â€¦, 608}. Thus the smallest option is 320 Ã— 320 and the largest is 608 Ã— 608. We resize the network to that dimension and continue training.</p><p>æˆ‘ä»¬ä¸æ˜¯å›ºå®šè¾“å…¥å›¾åƒçš„å¤§å°ï¼Œè€Œæ˜¯<strong>æ¯éš”å‡ æ¬¡è¿­ä»£å°±æ”¹å˜ç½‘ç»œ</strong>ã€‚ æ¯ 10 æ‰¹æˆ‘ä»¬çš„ç½‘ç»œéšæœºé€‰æ‹©ä¸€ä¸ªæ–°çš„å›¾åƒå°ºå¯¸ã€‚ ç”±äºæˆ‘ä»¬çš„æ¨¡å‹ä¸‹é‡‡æ ·äº† 32 å€ï¼ˆç¼©æ”¾å› å­32ï¼›416-&gt;13ï¼‰ï¼Œæˆ‘ä»¬ä»ä»¥ä¸‹ 32 çš„å€æ•°ä¸­æå–ï¼š{320, 352, â€¦, 608}ã€‚ å› æ­¤ï¼Œæœ€å°çš„é€‰é¡¹æ˜¯ 320 Ã— 320ï¼Œæœ€å¤§çš„é€‰é¡¹æ˜¯ 608 Ã— 608ã€‚æˆ‘ä»¬å°†ç½‘ç»œè°ƒæ•´åˆ°è¯¥ç»´åº¦å¹¶ç»§ç»­è®­ç»ƒã€‚</p><blockquote><p>è¿™é‡Œæ‰€è¯´çš„batchesæŒ‡çš„æ˜¯Epoch {320, 352, â€¦, 608} = {32Ã—10, 32Ã—11, â€¦, 32Ã—19}</p></blockquote><p>This regime forces the network to learn to predict well across a variety of input dimensions. This means the same network can predict detections at different resolutions. The network runs faster at smaller sizes so YOLOv2 offers an easy tradeoff between speed and accuracy.</p><p>è¿™ç§åˆ¶åº¦<strong>è¿«ä½¿ç½‘ç»œå­¦ä¼šåœ¨å„ç§è¾“å…¥ç»´åº¦ä¸Šè¿›è¡Œè‰¯å¥½çš„é¢„æµ‹</strong>ã€‚ è¿™æ„å‘³ç€åŒä¸€ä¸ªç½‘ç»œå¯ä»¥é¢„æµ‹ä¸åŒåˆ†è¾¨ç‡çš„æ£€æµ‹ã€‚ ç½‘ç»œåœ¨è¾ƒå°çš„å°ºå¯¸ä¸‹è¿è¡Œå¾—æ›´å¿«ï¼Œå› æ­¤ YOLOv2 åœ¨é€Ÿåº¦å’Œå‡†ç¡®æ€§ä¹‹é—´æä¾›äº†ä¸€ä¸ªç®€å•çš„æƒè¡¡ã€‚</p><p>At low resolutions YOLOv2 operates as a cheap, fairly accurate detector. At 288 Ã— 288 it runs at more than 90 FPS with mAP almost as good as Fast R-CNN. This makes it ideal for smaller GPUs, high framerate video, or multiple video streams.</p><p>åœ¨ä½åˆ†è¾¨ç‡ä¸‹ï¼ŒYOLOv2 æ˜¯ä¸€ç§å»‰ä»·ä¸”ç›¸å½“å‡†ç¡®çš„æ£€æµ‹å™¨ã€‚ åœ¨ 288 Ã— 288 æ—¶ï¼Œå®ƒä»¥è¶…è¿‡ 90 FPS çš„é€Ÿåº¦è¿è¡Œï¼ŒmAP å‡ ä¹ä¸ Fast R-CNN ä¸€æ ·å¥½ã€‚ è¿™ä½¿å…¶éå¸¸é€‚åˆè¾ƒå°çš„ GPUã€é«˜å¸§ç‡è§†é¢‘æˆ–å¤šä¸ªè§†é¢‘æµã€‚</p><p>At high resolution YOLOv2 is a state-of-the-art detector with 78.6 mAP on VOC 2007 while still operating above real-time speeds. See Table 3 for a comparison of YOLOv2 with other frameworks on VOC 2007 (Figure 4).</p><p>åœ¨é«˜åˆ†è¾¨ç‡ä¸‹ï¼ŒYOLOv2 æ˜¯æœ€å…ˆè¿›çš„æ£€æµ‹å™¨ï¼Œåœ¨ VOC 2007 ä¸Šå…·æœ‰ 78.6 mAPï¼ŒåŒæ—¶ä»ä»¥é«˜äºå®æ—¶é€Ÿåº¦è¿è¡Œã€‚ æœ‰å…³ YOLOv2 ä¸å…¶ä»–æ¡†æ¶åœ¨ VOC 2007 ä¸Šçš„æ¯”è¾ƒï¼Œè¯·å‚è§è¡¨ 3ï¼ˆå›¾ 4ï¼‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181251406.png"></p><blockquote><p>Note:</p><ul><li>è¿™é‡Œé‡‡ç”¨å¤šå°ºåº¦è®­ç»ƒå¹¶ä¸æ˜¯è®­ç»ƒbackboneï¼Œè€Œæ˜¯è®­ç»ƒç½‘ç»œå®šä½å’Œåˆ†ç±»å›å½’ï¼</li><li>è®­ç»ƒbackboneç”¨çš„448Ã—448çš„è¾“å…¥å›¾ç‰‡ï¼</li></ul></blockquote><h2 id="yolo-v2çš„backbone-darknet-19">2.3 YOLO v2çš„backbone â€”â€” Darknet-19</h2><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181251669.png" style="zoom:67%"> è¿™é‡Œä¸¾ä¾‹çš„Darknet-19è¾“å…¥ä¸º224Ã—224ã€‚</p><ul><li>19ä»£è¡¨å·ç§¯å±‚çš„ä¸ªæ•°</li></ul><p>Darknet-19ï¼ˆ224Ã—224ï¼‰only requires 5.58 billion operations to process an image yet achieves 72.9% top-1 accuracy and 91.2% top-5 accuracy on ImageNet.</p><p>Darknet-19 ï¼ˆ224Ã—224ï¼‰åªéœ€è¦ <strong>55.8 äº¿æ¬¡æ“ä½œ</strong>æ¥å¤„ç†å›¾åƒï¼Œä½†åœ¨ ImageNet ä¸Šå®ç°äº† <strong>72.9% çš„ top-1 å‡†ç¡®ç‡å’Œ 91.2% çš„ top-5 å‡†ç¡®ç‡</strong>ã€‚</p><blockquote><p>è™½ç„¶YOLO v2çš„backboneåœ¨è®­ç»ƒæ—¶ä½¿ç”¨çš„è¾“å…¥å›¾ç‰‡å¤§å°ä¸º448Ã—448ï¼Œä½†è¿™é‡Œä¸ºäº†å±•ç¤ºDarknet-19çš„æ€§èƒ½ï¼Œå°†å…¶è¾“å…¥è®¾ç½®ä¸ºäº†224Ã—224ï¼Œå› ä¸ºå…¶ä»–çš„åˆ†ç±»ç½‘ç»œä¸€èˆ¬çš„è¾“å…¥å‡ä¸º224Ã—224ã€‚</p></blockquote><h2 id="yolo-v2çš„æ•´ä½“æ¡†æ¶">2.4 YOLO v2çš„æ•´ä½“æ¡†æ¶</h2><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181252587.png" style="zoom:80%"> å…¶ä¸­ï¼š</p><ul><li><code>Filters</code>ä»£è¡¨å·ç§¯æ ¸çš„ä¸ªæ•°ï¼ˆä¹Ÿå°±æ˜¯è¾“å‡ºçš„é€šé“æ•°ï¼‰</li><li><code>Size</code>ä¸ºå·ç§¯æ ¸å¤§å°<ul><li>é»˜è®¤stride=1</li><li>åŠ äº†<code>/</code>ï¼Œåé¢çš„æ•°è¡¨ç¤ºstride</li></ul></li><li>æ¯ä¸€ä¸ª<code>Convolutional</code>éƒ½åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†<ul><li>Conv2dï¼ˆä¸åŒ…å«bias â€”â€” å› ä¸ºæœ‰äº†BNï¼‰</li><li>BN</li><li>LeakyReLUï¼ˆä¹Ÿå°±æ˜¯PReLUï¼‰</li></ul></li><li>æœ€åçš„<code>Conv2d 125 1Ã—1</code>å°±åªæ˜¯ä¸€ä¸ª1Ã—1å·ç§¯ï¼Œæ²¡æœ‰BNå’Œæ¿€æ´»å‡½æ•°</li></ul><p>ä½œè€…å°†è‡ªå·±æå‡ºçš„åˆ†ç±»ç½‘ç»œDarknet-19ç”¨åˆ°äº†YOLO v2è¿™ä¸ªç›®æ ‡æ£€æµ‹ç½‘ç»œä¸­å¹¶ä¿®æ”¹äº†å…¶éƒ¨åˆ†ç»“æ„ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181253939.png" style="zoom:67%"></p><ol type="1"><li>ç§»é™¤äº†æœ€åä¸€å±‚å·ç§¯å’Œå…¶ä¹‹åçš„å±‚ç»“æ„</li><li>åœ¨åé¢æ·»åŠ ä¸‰ä¸ª3Ã—3çš„å·ç§¯å±‚ï¼ˆæ¯ä¸ªå·ç§¯å±‚çš„å·ç§¯æ ¸ä¸ªæ•°ä¸º1024ï¼‰</li><li>åœ¨æ·»åŠ çš„3ä¸ªå·ç§¯å±‚ä¸­ï¼Œç¬¬äºŒä¸ªå·ç§¯å±‚ä¹‹åå¢åŠ PassThroughå±‚ï¼ˆç›´é€šå±‚ï¼‰</li><li>æœ€åæ¥ä¸Šä¸€ä¸ª1Ã—1ç«¯å·ç§¯å±‚ï¼Œå…¶è¾“å‡ºä¸ªæ•°ä¸ºæ‰€éœ€æ£€æµ‹çš„ç›®æ ‡å‚æ•°ï¼ˆè¿™é‡Œä¸º(5+20)Ã—5ï¼‰</li></ol><p><strong>æ‰€éœ€æ£€æµ‹çš„ç›®æ ‡å‚æ•°</strong>ï¼š</p><p>å¯¹äºVOCæ•°æ®é›†ï¼Œç½‘ç»œä¼šé¢„æµ‹5ä¸ªAnchorï¼Œæ¯ä¸ªAnchoræœ‰5ä¸ªå‚æ•°(x, y, w, h, confidence)ï¼Œå…¶ä¸­(x, y, w, h)ä¸ºanchorçš„å›å½’ä¿¡æ¯ï¼›confidenceä¸ºè¯¥anchorä¸GTBoxçš„IoUå€¼ã€‚VOCæ•°æ®é›†æœ‰20ä¸ªç±»åˆ«ï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸€ä¸ªAnchorå‡éœ€é¢„æµ‹20ä¸ªç±»åˆ«åˆ†æ•°ã€‚ æ•…éœ€è¦(5 + 20) * 5 = 125ä¸ªéœ€è¦é¢„æµ‹çš„å‚æ•°</p><blockquote><p>ä¸YOLO v1ä¸åŒï¼ŒYOLO v1æ˜¯grid cellé¢„æµ‹ç±»åˆ«åˆ†æ•°ï¼Œè€Œv2æ˜¯æ¯ä¸€ä¸ªanchorå‡éœ€è¦é¢„æµ‹20ä¸ªåˆ†æ•°ã€‚</p></blockquote><h2 id="yolo-v2è®­ç»ƒç»†èŠ‚">2.5 YOLO v2è®­ç»ƒç»†èŠ‚</h2><h3 id="è®ºæ–‡ä¸­æ²¡æœ‰æåŠ">2.5.1 è®ºæ–‡ä¸­æ²¡æœ‰æåŠ</h3><ol type="1"><li>å¦‚ä½•åŒ¹é…æ­£è´Ÿæ ·æœ¬</li><li>å¦‚ä½•è®¡ç®—è¯¯å·®</li></ol><p>è¿™ä¸¤éƒ¨åˆ†ä¼šåœ¨YOLO v3ä¸­è¿›è¡Œç»†è®²ğŸ˜‚</p><h3 id="è®ºæ–‡æåŠçš„è®­ç»ƒç»†èŠ‚">2.5.2 è®ºæ–‡æåŠçš„è®­ç»ƒç»†èŠ‚</h3><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211181259003.png"></p><ol type="1"><li>åœ¨ä¼˜åŒ–å™¨ä¸­ä½¿ç”¨äº†æƒé‡è¡°å‡å’ŒåŠ¨é‡</li><li>ä½¿ç”¨äº†ä¸YOLO v1ç›¸åŒçš„æ•°æ®å¢å¼ºå¤„ç†ä»¥åŠSSDä¸­é‡‡ç”¨çš„éšæœºè£å‰ªå’Œé¢œè‰²åç§»çš„å¢å¼ºæ–¹å¼</li><li>åœ¨COCOå’ŒVOCä¸Šçš„è®­ç»ƒç­–ç•¥æ˜¯ç›¸åŒ</li></ol><h1 id="yolo-v3">3. YOLO v3</h1><p>è®ºæ–‡é¢˜ç›®ï¼š<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=YOLOv3&amp;spm=1001.2101.3001.7020">YOLOv3</a>: An Incremental Improvement è®ºæ–‡åœ°å€ï¼šhttps://arxiv.org/abs/1804.02767</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211190959381.png"> 2018å¹´å‘è¡¨åœ¨CVPRï¼Œå…¶è®ºæ–‡ä¸­çš„å†…å®¹æ¯”è¾ƒå°‘ â€”â€” æ²¡æœ‰å¤ªå¤šçš„åˆ›æ–°ç‚¹ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯æ•´åˆäº†å½“æ—¶æ¯”è¾ƒä¸»æµç½‘ç»œçš„ä¼˜ç‚¹ã€‚</p><h2 id="yolo-v3ä¸å…¶ä»–ç½‘ç»œçš„å¯¹æ¯”">3.1 YOLO v3ä¸å…¶ä»–ç½‘ç»œçš„å¯¹æ¯”</h2><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191000702.png" style="zoom:67%"> æ•°æ®é›†ä¸ºMS COCOæ•°æ®ï¼Œç›¸æ¯”äºå…¶ä»–ç½‘ç»œè€Œè¨€ï¼ŒYOLO v3çš„é€Ÿåº¦æ˜¯éå¸¸å¿«çš„ï¼Œä½†å…¶APå¹¶ä¸æ˜¯å¾ˆé«˜ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191000454.png" style="zoom:50%"> è¯¥å›¾çš„çºµåæ ‡ä¸ºCOCO APIoU=0.5 â€”â€” PASCAL VOCçš„mAPã€‚é€šè¿‡è¯¥æŒ‡æ ‡æ¥çœ‹ï¼ŒYOLO v3çš„é€Ÿåº¦å’Œå‡†ç¡®ç‡éƒ½æ¯”è¾ƒé«˜ã€‚</p><h2 id="yolo-v3ç½‘ç»œæ¶æ„">3.2 YOLO v3ç½‘ç»œæ¶æ„</h2><h3 id="backbone-darknet-53">3.2.1 backbone â€”â€” Darknet-53</h3><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191001938.png" style="zoom:80%"></p><p>ä¿®æ”¹äº†backbone â€”â€” Darknet-19 -&gt; Darknet-53</p><p>æ ¹æ®å³ä¸Šè§’çš„è¡¨æ ¼æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼ŒDarknet-19å˜ä¸ºDarknet-53æå‡äº†åˆ†ç±»çš„å‡†ç¡®ç‡ï¼ˆå’ŒResNet-152æŒå¹³ï¼‰ï¼Œ<strong>ä½†å…¶FPSè…°æ–©</strong>ã€‚</p><blockquote><p>è™½ç„¶é€Ÿåº¦é™ä½äº†ï¼Œä½†é‡ç‚¹ä¸æ˜¯åœ¨è¿™é‡Œã€‚è€Œæ˜¯<strong>Darknet-53å‡†ç¡®ç‡å’ŒResNet-152æŒå¹³ï¼Œä½†é€Ÿåº¦æ˜¯å…¶2å€</strong>ï¼ â€”â€” Darknet-53ä¹Ÿæ˜¯éå¸¸å¼ºåŠ²çš„åˆ†ç±»ç½‘ç»œ</p></blockquote><p>53è¡¨ç¤ºå·ç§¯å±‚æœ‰53ä¸ªï¼Œæ³¨æ„æœ€ååˆ†ç±»å±‚ä¸­å…¨è¿æ¥å±‚è¢«å·ç§¯å±‚æ›¿ä»£ï¼Œæ‰€ä»¥æœ‰53ä¸ªå·ç§¯å±‚ã€‚</p><p><strong>Q</strong>ï¼šä¸ºä»€ä¹ˆDarknet-53çš„æ•ˆæœæ¯”ResNet-152çš„æ•ˆæœè¦å¥½ï¼Ÿ <strong>A</strong>ï¼šDarknet-53æ²¡æœ‰MaxPoolingå±‚ï¼ˆ<strong>æ‰€æœ‰ä¸‹é‡‡æ ·éƒ½æ˜¯é€šè¿‡å·ç§¯å±‚å®ç°çš„</strong>ï¼‰</p><p><strong>Q</strong>ï¼šä¸ºä»€ä¹ˆDarknet-53çš„é€Ÿåº¦æ¯”ResNet-152è¦å¿«ï¼Ÿ <strong>A</strong>ï¼šResNet-152çš„å·ç§¯æ ¸ä¸ªæ•°æ¯”Darknet-53è¦å¤šå¾ˆå¤š â€”â€” Darknet-53çš„å‚æ•°è¦å°‘ï¼Œè¿ç®—é‡å°‘ -&gt; é€Ÿåº¦å¿«</p><h3 id="æ•´ä½“æ¡†æ¶">3.2.2 æ•´ä½“æ¡†æ¶</h3><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191003619.png"> ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒYOLO v3çš„é¢„æµ‹ç‰¹å¾å›¾æœ‰3ä¸ªï¼š</p><ul><li>Predict one: 13Ã—13 -&gt; é¢„æµ‹å¤§ç›®æ ‡</li><li>Predict one: 26Ã—26 -&gt; é¢„æµ‹ä¸­ç›®æ ‡</li><li>Predict one: 52Ã—52 -&gt; é¢„æµ‹å°ç›®æ ‡</li></ul><h2 id="ç›®æ ‡æ£€æµ‹æ¡†çš„é¢„æµ‹æœºåˆ¶">3.3 ç›®æ ‡æ£€æµ‹æ¡†çš„é¢„æµ‹æœºåˆ¶</h2><p>v3é‡‡ç”¨äº†å’Œv2ä¸€æ ·çš„æœºåˆ¶ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191014118.png" style="zoom:67%"> å…¶ä¸­ï¼š</p><ul><li><p><span class="math inline">\(t_x, t_y, t_w, t_h\)</span>ä¸ºé¢„æµ‹çš„å…³äºanchorçš„åç§»é‡</p></li><li><p><span class="math inline">\(\sigma(\cdot)\)</span>ä¸ºSigmoidå‡½æ•° â€”â€” å°†è¾“å…¥æ˜ å°„åˆ° <span class="math inline">\([ 0 , 1 ]\)</span></p></li><li><p><span class="math inline">\(p_w, p_h\)</span>ä¸ºå…ˆéªŒæ¡†çš„å®½åº¦å’Œé«˜åº¦</p></li><li><p><span class="math inline">\(b_x, b_y, b_w, b_h\)</span> ä¸ºæœ€ç»ˆè¾¹ç•Œæ¡†çš„ä¸­å¿ƒç‚¹åæ ‡ä»¥åŠå®½åº¦ã€é«˜åº¦</p></li><li><p><span class="math inline">\(c_x, c_y\)</span>å½“å‰grid cellå·¦ä¸Šè§’ç‚¹çš„åæ ‡</p></li><li><p>è™šçº¿çš„çŸ©å½¢æ¡†å¯¹åº”çš„æ˜¯priorsï¼ˆanchorï¼‰ â€”â€” è¿™é‡Œæˆ‘ä»¬åªéœ€å…³å¿ƒå…¶å®½åº¦å’Œé«˜åº¦è¿™ä¸ªå‚æ•°å³å¯</p></li><li><p>å›¾ä¸­è“è‰²çŸ©å½¢æ¡†æ˜¯ç½‘ç»œé¢„æµ‹çš„æœ€ç»ˆç›®æ ‡ä½ç½®ä»¥åŠå¤§å°</p></li></ul><blockquote><p>Sigmoidå‡½æ•°çš„å­˜åœ¨ä½¿å¾—é¢„æµ‹å€¼ä¸ä¼šè¶…è¿‡å½“å‰çš„grid cell â€”â€” å’Œv2æ˜¯ä¸€æ ·çš„</p></blockquote><p>é€šè¿‡å›¾ä¸­çš„å…¬å¼å°±å¯ä»¥å°†ç½‘ç»œé¢„æµ‹çš„å›å½’å‚æ•°è½¬åŒ–ä¸ºæœ€ç»ˆçš„ç›®æ ‡è¾¹ç•Œæ¡†å…·ä½“åæ ‡ã€‚</p><h2 id="grid-cellçš„priorsçš„æ¯”ä¾‹">3.4 grid cellçš„priorsçš„æ¯”ä¾‹</h2><p>é’ˆå¯¹æ¯ä¸€ä¸ªé¢„æµ‹ç‰¹å¾å›¾è€Œè¨€ï¼Œæ¯ä¸€ä¸ªå…ˆéªŒæ¡†å‡æœ‰3ç§æ¯”ä¾‹ï¼ˆ3ç§ä¸åŒçš„anchoræ¨¡æ¿ï¼‰ã€‚ <img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191018916.png"></p><p>å› ä¸ºYOLO v3æœ‰3ç§ä¸åŒå°ºå¯¸çš„é¢„æµ‹ç‰¹å¾å›¾ï¼Œæ‰€ä»¥å°†ä¸åŒå°ºå¯¸çš„anchoråˆ†é…ç»™ä¸åŒçš„é¢„æµ‹ç‰¹å¾å›¾ï¼Œå…·ä½“ç»†èŠ‚å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191018349.png"></p><blockquote><p>æ„Ÿå—é‡è¶Šå¤§ï¼Œé¢„æµ‹çš„ç›®æ ‡å°ºå¯¸åº”è¯¥è¶Šå¤§ åä¹‹äº¦ç„¶</p></blockquote><h2 id="æ­£è´Ÿæ ·æœ¬çš„åŒ¹é…">3.5 æ­£è´Ÿæ ·æœ¬çš„åŒ¹é…</h2><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191018709.png" style="zoom:67%"> YOLOv3 ä½¿ç”¨<strong>é€»è¾‘å›å½’</strong>é¢„æµ‹æ¯ä¸ªè¾¹ç•Œæ¡†çš„å¯¹è±¡åº¦å¾—åˆ†ã€‚</p><ul><li>å¦‚æœè¾¹ç•Œæ¡†å…ˆéªŒä¸GTBoxçš„é‡å æ¯”ä»»ä½•å…¶ä»–è¾¹ç•Œæ¡†å…ˆéªŒå¤šï¼Œåˆ™è¯¥å€¼åº”ä¸º 1ã€‚</li><li>å¦‚æœè¾¹ç•Œæ¡†å…ˆéªŒä¸æ˜¯æœ€å¥½çš„ï¼Œä½†ç¡®å®ä¸GTBoxé‡å è¶…è¿‡æŸä¸ªé˜ˆå€¼ï¼Œæˆ‘ä»¬å°†å¿½ç•¥é¢„æµ‹ï¼Œéµå¾ª [17]ã€‚ æˆ‘ä»¬ä½¿ç”¨ 0.5 çš„é˜ˆå€¼ã€‚ ä¸ [17] ä¸åŒï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿåªä¸ºæ¯ä¸ªGTBoxåˆ†é…ä¸€ä¸ªè¾¹ç•Œæ¡†å…ˆéªŒã€‚ å¦‚æœ<strong>æœª</strong>å°†è¾¹ç•Œæ¡†å…ˆéªŒåˆ†é…ç»™GTBoxï¼Œåˆ™ä¸ä¼šå¯¹åæ ‡æˆ–ç±»åˆ«é¢„æµ‹é€ æˆæŸå¤±ï¼Œåªä¼šå¯¹å¯¹è±¡æ€§é€ æˆæŸå¤±ã€‚</li></ul><blockquote><p>[17]ä¸ºFaster R-CNN</p></blockquote><p>é’ˆå¯¹æ¯ä¸€ä¸ªGTè€Œè¨€éƒ½ä¼šåˆ†é…ä¸€ä¸ªæ­£æ ·æœ¬ â€”â€” ä¸€å¼ å›¾ç‰‡ä¸­æœ‰å‡ ä¸ªGTç›®æ ‡å°±æœ‰å‡ ä¸ªæ­£æ ·æœ¬ã€‚</p><p><strong>åˆ†é…åŸåˆ™</strong>ï¼š</p><ul><li>å…ˆéªŒæ¡†ä¸GTBoxçš„IoUæœ€å¤§çš„ä½œä¸ºæ­£æ ·æœ¬</li><li>å¦‚æœå…¶ä»–å…ˆéªŒæ¡†ä¸è¯¥GTBoxçš„IoUçš„å€¼ä¸æ˜¯æœ€å¤§ï¼Œä½†IoUè¶…è¿‡äº†è®¾ç½®çš„é˜ˆå€¼ï¼ˆ0.5ï¼‰ -&gt; ç›´æ¥ä¸¢å¼ƒè¿™ä¸ªå…ˆéªŒæ¡†ï¼Œå³è¿™ä¸ªå…ˆéªŒæ¡†æ—¢ä¸æ˜¯æ­£æ ·æœ¬ä¹Ÿä¸æ˜¯è´Ÿæ ·æœ¬ï¼Œè€Œæ˜¯ç›´æ¥å¼ƒç”¨</li><li>å‰©ä¸‹ä¸GTBoxçš„IoUä¸æ˜¯æœ€å¤§ä¸”å°äºè®¾å®šé˜ˆå€¼çš„å…ˆéªŒæ¡†å‡è®¾ç½®ä¸ºè´Ÿæ ·æœ¬</li><li>å¦‚æœå…ˆéªŒæ¡†æ²¡æœ‰åˆ†é…ç»™æŸä¸€ä¸ªGTBoxï¼ˆå³å½“å‰çš„å…ˆéªŒæ¡†ä¸æ˜¯æ­£æ ·æœ¬çš„è¯ï¼‰ï¼Œé‚£ä¹ˆå®ƒæ—¢æ²¡æœ‰å®šä½æŸå¤±ï¼Œä¹Ÿæ²¡æœ‰ç±»åˆ«æŸå¤±ï¼Œä»…ä»…åªæœ‰confidenceæŸå¤±ï¼ˆä¸GTBoxçš„IoUæŸå¤±ï¼‰</li></ul><h2 id="yolo-v3æºç çš„æ­£è´Ÿæ ·æœ¬åŒ¹é…ç­–ç•¥">3.6 YOLO v3æºç çš„æ­£è´Ÿæ ·æœ¬åŒ¹é…ç­–ç•¥</h2><p>å¦‚æœæˆ‘ä»¬æŒ‰ä¸Šè®ºæ–‡ä¸­ï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢çš„è¿™ç§ï¼‰æ­£è´Ÿæ ·æœ¬åŒ¹é…ç­–ç•¥çš„è¯ï¼Œä¼šå‘ç°<strong>æ­£æ ·æœ¬çš„æ•°é‡å¤ªå°‘äº†</strong> â€”â€” å¯¼è‡´ç½‘ç»œå¾ˆéš¾è®­ç»ƒã€‚</p><p>é’ˆå¯¹æ¯ä¸€ä¸ªé¢„æµ‹ç‰¹å¾å›¾è€Œè¨€ï¼Œæ¯ä¸€ä¸ªå…ˆéªŒæ¡†å‡æœ‰3ç§æ¯”ä¾‹ï¼ˆ3ç§ä¸åŒçš„anchoræ¨¡æ¿ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š <img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191021465.png"></p><hr><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191021846.png"></p><ol type="1"><li>å°†æ¯ä¸€ä¸ªAnchoræ¨¡æ¿ä¸GTBoxè¿›è¡ŒIoUçš„è®¡ç®—ï¼ˆå°†äºŒè€…çš„å·¦ä¸Šè§’é‡åˆåå†è®¡ç®—IoUï¼‰</li><li>è®¾ç½®IoUé˜ˆå€¼ï¼ˆ0.3ï¼‰ï¼Œ<strong>åªè¦Anchorä¸GTBoxçš„IoU &gt; 0.3ï¼Œè¯¥Anchoréƒ½ä¼šè¢«è®¾ç½®ä¸ºæ­£æ ·æœ¬</strong> â€”â€” åªæœ‰ç¬¬äºŒä¸ªanchoræ¨¡æ¿ç¬¦åˆæ¡ä»¶ï¼Œä¸ºæ­£æ ·æœ¬</li><li>å°†GTBoxæ˜ å°„åˆ°é¢„æµ‹ç‰¹å¾å›¾ä¸Šï¼ˆå…¶ä¸­<strong>é»‘è‰²çš„åœ†ç‚¹</strong>ä¸ºGTBoxçš„ä¸­å¿ƒç‚¹ï¼Œ<strong>Ã—</strong>ä¸ºGTBoxæ‰€å±grid cellçš„å·¦ä¸Šè§’åæ ‡ï¼‰</li><li>GTBoxä¸­å¿ƒç‚¹è½åœ¨å“ªä¸ªgrid cellï¼Œå“ªä¸ªgrid cellå¯¹åº”çš„anchoræ¨¡æ¿2å°±ä¸ºæ­£æ ·æœ¬</li></ol><hr><p><strong>Q</strong>ï¼šå¦‚æœè¿™ä¸‰ä¸ªanchoræ¨¡æ¿ä¸GTBoxçš„IoUå‡å¤§äºé˜ˆå€¼å‘¢ï¼Ÿ <strong>A</strong>ï¼šå¦‚æœå‡ºç°è¿™ç§æƒ…å†µï¼Œé‚£ä¹ˆGTBoxæ‰€å±çš„grid cellçš„3ä¸ªanchoræ¨¡æ¿<strong>å‡ä¸ºæ­£æ ·æœ¬</strong></p><p>è¿™ç§ç­–ç•¥ä¸­ï¼Œåªè¦Anchorä¸GTBoxçš„IoUå¤§äºé˜ˆå€¼ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯æ­£æ ·æœ¬ï¼Œå°äºé˜ˆå€¼å°±æ˜¯è´Ÿæ ·æœ¬ï¼ˆæ²¡æœ‰è®ºæ–‡ç­–ç•¥ä¸­åºŸå¼ƒAnchorçš„åšæ³•äº†ï¼‰ â€”â€” ç›®çš„å°±æ˜¯ä¸ºäº†<strong>æ‰©å……æ­£æ ·æœ¬çš„æ•°é‡</strong>ã€‚</p><blockquote><p>è¿™ç§ç­–ç•¥åœ¨å®è·µä¸­çš„æ•ˆæœç¡®å®æ¯”è®ºæ–‡ä¸­çš„ç­–ç•¥è¦å¥½ä¸€äº›</p></blockquote><h2 id="æŸå¤±å‡½æ•°-1">3.7 æŸå¤±å‡½æ•°</h2><p>YOLO v3æ•´ä½“æŸå¤±è®¡ç®—å¦‚ä¸‹ï¼š <span class="math display">\[ L(o, c, O, C, l, g) = \lambda_1 \underset{ç½®ä¿¡åº¦æŸå¤±}{L_{\text{conf}}(o, c)} + \lambda_2 \underset{åˆ†ç±»æŸå¤±}{L_{\text{cls}}(O, C)} + \lambda_3 \underset{å®šä½æŸå¤±}{L_{\text{loc}}(l, g)} \]</span></p><blockquote><p>å…¶ä¸­<span class="math inline">\(\lambda_1, \lambda_2, \lambda_3\)</span>ä¸ºå¹³è¡¡ç³»æ•°ã€‚</p></blockquote><h3 id="ç½®ä¿¡åº¦æŸå¤±confidence-loss">3.7.1 ç½®ä¿¡åº¦æŸå¤±ï¼ˆConfidence Lossï¼‰</h3><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191025683.png"></p><p>è®ºæ–‡ä¸­è¯´ä½¿ç”¨çš„æ˜¯é€»è¾‘å›å½’ï¼Œè€Œé€»è¾‘å›å½’ä¸€èˆ¬éƒ½æ˜¯BCEæŸå¤±ï¼ˆå³äºŒå€¼äº¤å‰ç†µæŸå¤±ï¼‰</p><p><strong>Q</strong>ï¼šé¢„æµ‹ç›®æ ‡è¾¹ç•Œæ¡†æ˜¯Anchor priorså—ï¼Ÿ <strong>A</strong>ï¼šå¹¶ä¸æ˜¯ï¼Œçœ‹ä¸‹å›¾ã€‚ <img src="https://img-blog.csdnimg.cn/6c03011d50a940d1994c2f64deaa37d8.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> å…¶ä¸­</p><ul><li>è“è‰²æ¡†ä¸ºAnchor priors</li><li>ç»¿è‰²æ¡†ä¸ºGTBox</li><li>é»„è‰²æ¡†ä¸ºé¢„æµ‹ç›®æ ‡è¾¹ç•Œæ¡†</li></ul><p>é¢„æµ‹ç›®æ ‡è¾¹ç•Œæ¡†æ˜¯Anchoræ ¹æ®é¢„æµ‹å€¼å›å½’å¾—åˆ°çš„ï¼Œå³o i o_ioiæ˜¯é»„è‰²æ¡†ä¸ç»¿è‰²æ¡†çš„IoUå€¼ã€‚</p><h3 id="åˆ†ç±»ç±»åˆ«æŸå¤±classes-loss">3.7.2 åˆ†ç±»/ç±»åˆ«æŸå¤±ï¼ˆClasses Lossï¼‰</h3><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191026829.png"></p><p>è¿™é‡Œçš„åˆ†ç±»æŸå¤±ä¹Ÿæ˜¯BCEæŸå¤±ã€‚</p><hr><p><strong>ä¾‹å­</strong>ï¼š</p><p><img src="https://img-blog.csdnimg.cn/4eab17e4943841838cbbef1163f3dbf5.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> æˆ‘ä»¬éœ€è¦æ£€æµ‹å›¾ç‰‡ä¸­çš„[è€è™ï¼Œè±¹å­ï¼ŒçŒ«]è¿™ä¸‰ä¸ªç±»åˆ«ï¼›å·¦ä¸‹è§’çš„å›¾ç‰‡ä¸­æœ‰ä¸¤ä¸ªç±»åˆ«ï¼Œä¸”å‡ä¸ºçŒ«ã€‚</p><ul><li>ç›®æ ‡1çš„GTæ¦‚ç‡ä¸º[0, 0, 1] â€”â€” one-hotç¼–ç </li><li>ç›®æ ‡2çš„GTæ¦‚ç‡ä¸º[0, 0, 1] â€”â€” one-hotç¼–ç </li></ul><p>å‡è®¾ç½‘ç»œçš„é¢„æµ‹æ¦‚ç‡ä¸ºï¼šç»è¿‡Sigmoidå‡½æ•°å¤„ç†åå¾—åˆ°çš„</p><ul><li>ç›®æ ‡1çš„é¢„æµ‹æ¦‚ç‡ä¸º[0.1, 0.8, 0.9]</li><li>ç›®æ ‡2çš„é¢„æµ‹æ¦‚ç‡ä¸º[0.2, 0.7, 0.8]</li></ul><p>æˆ‘ä»¬å‘ç°ï¼Œé¢„æµ‹æ¯ä¸ªç›®æ ‡é¢„æµ‹å€¼çš„å’Œå¹¶ä¸æ˜¯ç­‰äº1çš„ï¼Œä¹‹å‰æˆ‘ä»¬ä½¿ç”¨Softmaxäº¤å‰ç†µçš„æ—¶å€™ï¼Œé¢„æµ‹æ¦‚ç‡ä¹‹å’Œä¸º1ï¼›è€Œè¿™é‡Œç”¨çš„æ˜¯BCEäº¤å‰ç†µï¼Œæ¯ä¸€ä¸ªè¾“å‡ºå€¼æ˜¯ç›´æ¥é€šè¿‡Sigmoidå‡½æ•°è¿›è¡Œå¤„ç†çš„ï¼Œ<strong>æ¯ä¸ªé¢„æµ‹å€¼ä¹‹é—´æ˜¯äº’ä¸å¹²æ‰°ã€ç›¸äº’ç‹¬ç«‹çš„</strong>ï¼Œæ‰€ä»¥å°±å¯èƒ½ä¼šå‡ºç° â€”â€” è¯¥ç›®æ ‡æ—¢æœ‰å¯èƒ½æ˜¯è±¹å­ä¹Ÿæœ‰å¯èƒ½æ˜¯çŒ«çš„æƒ…å†µï¼ˆå°±æ˜¯å¯èƒ½å‡ºç°å¤šä¸ªæ¦‚ç‡è¾ƒå¤§çš„ç±»åˆ«ï¼‰ã€‚</p><hr><p><strong>éªŒè¯</strong>ï¼šéªŒè¯ç±»åˆ«æŸå¤±çš„BCEæ˜¯å¦æ­£ç¡®</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token triple-quoted-string string">"""
    reduction="none"è¡¨ç¤ºæ±‚å‡ºBCELossåä¸è¿›è¡Œä»»ä½•å¤„ç†
    å¦‚æœä¸è®¾ç½®ï¼Œé»˜è®¤æ˜¯å¯¹å…¶è¿›è¡Œæ±‚å‡å€¼å¤„ç† -> è¿”å›ä¸€ä¸ªå‡å€¼
"""</span>
loss <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>BCELoss<span class="token punctuation">(</span>reduction<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">)</span>
<span class="token comment"># loss = torch.nn.BCELoss()  # 0.5784000158309937</span>
predicted_cls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># ä¸Šæ–¹Sigmodå¤„ç†åçš„ä¸¤ä¸ªæ¡†å¯¹åº”ç±»åˆ«é¢„æµ‹å€¼</span>
predict_cls_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>predicted_cls<span class="token punctuation">,</span> requires_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

gt_cls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
gt_cls_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>gt_cls<span class="token punctuation">)</span>

loss_res <span class="token operator">=</span> loss<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token operator">=</span>predict_cls_tensor<span class="token punctuation">,</span> target<span class="token operator">=</span>gt_cls_tensor<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"PyTorchå®˜æ–¹å®ç°çš„ç»“æœ: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>np<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span>loss_res<span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> decimals<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># decimals: å°†æ•°ç»„å››èˆäº”å…¥åˆ°ç»™å®šçš„å°æ•°ä½æ•°ã€‚</span>


<span class="token keyword">def</span> <span class="token function">bce</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> o<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># è¿™é‡Œçš„np.logå°±æ˜¯lnï¼ˆä»¥eä¸ºåº•ï¼‰</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">(</span>o <span class="token operator">*</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> o<span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> decimals<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>


pn <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>predicted_cls<span class="token punctuation">)</span>
gn <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>gt_cls<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"è‡ªå®šä¹‰å®ç°çš„ç»“æœ: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>bce<span class="token punctuation">(</span>pn<span class="token punctuation">,</span> gt_cls<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>


<span class="token triple-quoted-string string">"""
    PyTorchå®˜æ–¹å®ç°çš„ç»“æœ: [[0.10536 1.60944 0.10536]
                         [0.22314 1.20397 0.22314]]
    è‡ªå®šä¹‰å®ç°çš„ç»“æœ: [[0.10536 1.60944 0.10536]
                    [0.22314 1.20397 0.22314]]
"""</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å®šä½æŸå¤±location-loss">3.7.3 å®šä½æŸå¤±ï¼ˆLocation Lossï¼‰</h3><p><img src="https://cdn.jsdelivr.net/gh/Unicorn-acc/blogimgs/imgs01/202211191038389.png"></p><p>åœ¨è®­ç»ƒé˜¶æ®µï¼Œå®šä½æŸå¤±ä½¿ç”¨çš„æ˜¯<strong>å¹³æ–¹è¯¯å·®å’ŒæŸå¤±</strong>ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„<span class="math inline">\(L_2\)</span>æŸå¤±ï¼‰ã€‚</p><blockquote><p>è¿™é‡Œçš„å®šä½æŸå¤±å‡½æ•°åšä¸€ä¸ªç®€å•äº†è§£å°±å¯ä»¥äº†ï¼Œå› ä¸ºåé¢çš„v3-SPPã€v4ã€v5å¹¶ä¸æ˜¯ä½¿ç”¨å¹³æ–¹è¯¯å·®å’Œæ¥è®¡ç®—å®šä½æŸå¤±ï¼Œè€Œæ˜¯ä½¿ç”¨çš„CIoU Lossã€‚</p></blockquote><h1 id="yolo-v3-spp">4. YOLO v3-SPP</h1><h2 id="v3-sppç›¸æ¯”v3çš„æ”¹è¿›ä¹‹å¤„">4.1 v3-SPPç›¸æ¯”v3çš„æ”¹è¿›ä¹‹å¤„</h2><p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼š</p><table><thead><tr class="header"><th>Model</th><th>è¾“å…¥å›¾ç‰‡å°ºå¯¸</th><th>COCO mAP@0.5:0.95</th><th>COCO mAP@0.5</th></tr></thead><tbody><tr class="odd"><td>YOLO v3</td><td>512Ã—512</td><td>32.7</td><td>57.7</td></tr><tr class="even"><td>YOLO v3-SPP</td><td>512Ã—512</td><td>35.6 (+2.90)</td><td>59.5 (+1.80)</td></tr><tr class="odd"><td>YOLO v3-SPP-ultralytics</td><td>512Ã—512</td><td><strong>42.6 (+9.90)</strong></td><td><strong>62.4 (+4.70)</strong></td></tr></tbody></table><blockquote><p>ultralyticsçš„YOLO v3-SPPä¹‹æ‰€ä»¥æ€§èƒ½æå‡æ›´å¤šæ˜¯å› ä¸ºä½¿ç”¨äº†æ›´å¤šçš„trick</p></blockquote><p><strong>tricks</strong>ï¼š</p><ol type="1"><li>Mosaicå›¾åƒå¢å¼º</li><li>SPPæ¨¡å—ï¼ˆSpatial Pyramid Poolingï¼Œç©ºé—´é‡‘å­—å¡”æ± åŒ–ï¼‰</li><li>CIoU Loss</li><li>Focal Lossï¼ˆç„¦ç‚¹æŸå¤±ï¼‰</li></ol><blockquote><p>å‰ä¸‰ä¸ªæ˜¯ultralyticsä½¿ç”¨çš„ï¼ŒFocal Lossè™½ç„¶åœ¨ç½‘ç»œæœ‰å·²ç»å®ç°äº†ï¼Œä½†é»˜è®¤ä¸ä½¿ç”¨ï¼ˆæ•ˆæœå¹¶ä¸æ˜¯å¾ˆå¥½ï¼‰</p></blockquote></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://Unicorn-acc.github.io">Miraclo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://unicorn-acc.github.io/posts/62071.html">http://unicorn-acc.github.io/posts/62071.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://Unicorn-acc.github.io" target="_blank">Miracloâ€™s Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/DeepLearning/">DeepLearning</a></div><div class="post_share"><div class="social-share" data-image="https://w.wallhaven.cc/full/1p/wallhaven-1pjml1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/25470.html"><img class="prev-cover" src="https://w.wallhaven.cc/full/zy/wallhaven-zyxvqy.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">JVMç³»åˆ—-06-æœ¬åœ°æ–¹æ³•æ¥å£</div></div></a></div><div class="next-post pull-right"><a href="/posts/60257.html"><img class="next-cover" src="https://w.wallhaven.cc/full/vq/wallhaven-vqmyq3.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">ç›®æ ‡æ£€æµ‹-03-RetinaNet</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/5074.html" title="å›¾åƒåˆ†ç±»_CIFAR10æ•°æ®é›†"><img class="cover" src="https://w.wallhaven.cc/full/kx/wallhaven-kx3p1q.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-07</div><div class="title">å›¾åƒåˆ†ç±»_CIFAR10æ•°æ®é›†</div></div></a></div><div><a href="/posts/47625.html" title="å›¾åƒåˆ†ç±»_Fashion-MNISTæ•°æ®é›†(ResNet18è¿›è¡Œè¿ç§»å­¦ä¹ )"><img class="cover" src="https://w.wallhaven.cc/full/1p/wallhaven-1pjml1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-04</div><div class="title">å›¾åƒåˆ†ç±»_Fashion-MNISTæ•°æ®é›†(ResNet18è¿›è¡Œè¿ç§»å­¦ä¹ )</div></div></a></div><div><a href="/posts/56670.html" title="ç›®æ ‡æ£€æµ‹&#x2F;åˆ†å‰²_PASCAL VOC2012æ•°æ®é›†ä¸åˆ¶ä½œè‡ªå·±çš„æ•°æ®é›†(VOCæ ¼å¼)"><img class="cover" src="https://w.wallhaven.cc/full/1p/wallhaven-1pjml1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-11</div><div class="title">ç›®æ ‡æ£€æµ‹&#x2F;åˆ†å‰²_PASCAL VOC2012æ•°æ®é›†ä¸åˆ¶ä½œè‡ªå·±çš„æ•°æ®é›†(VOCæ ¼å¼)</div></div></a></div><div><a href="/posts/2490.html" title="å›¾åƒåˆ†ç±»_èŠ±åˆ†ç±»æ•°æ®é›†"><img class="cover" src="https://w.wallhaven.cc/full/x6/wallhaven-x619o3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-06</div><div class="title">å›¾åƒåˆ†ç±»_èŠ±åˆ†ç±»æ•°æ®é›†</div></div></a></div><div><a href="/posts/64179.html" title="å›¾åƒåˆ†ç±»_00_LeNet_Pytorchå®˜æ–¹ç¤ºä¾‹"><img class="cover" src="https://w.wallhaven.cc/full/x6/wallhaven-x619o3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-07</div><div class="title">å›¾åƒåˆ†ç±»_00_LeNet_Pytorchå®˜æ–¹ç¤ºä¾‹</div></div></a></div><div><a href="/posts/5932.html" title="ç›®æ ‡æ£€æµ‹-03-FPNç‰¹å¾é‡‘å­—å¡”ç½‘ç»œ(Feature Pyramid Network)"><img class="cover" src="https://w.wallhaven.cc/full/kx/wallhaven-kx3p1q.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-17</div><div class="title">ç›®æ ‡æ£€æµ‹-03-FPNç‰¹å¾é‡‘å­—å¡”ç½‘ç»œ(Feature Pyramid Network)</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-text">0. å¼•è¨€</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E6%8E%92"><span class="toc-text">0.1 å®‰æ’</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E4%BB%A3%E7%A0%81%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="toc-text">0.2 å­¦ä¹ ä»£ç çš„æ­¥éª¤</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#yolo-v1"><span class="toc-text">1. YOLO v1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%80%9D%E6%83%B3"><span class="toc-text">1.1 æ ¸å¿ƒæ€æƒ³</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%E5%88%92%E5%88%86grid-cell"><span class="toc-text">1.2 ç¬¬ä¸€æ­¥ï¼šåˆ’åˆ†grid cell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%E6%AF%8F%E4%B8%AAgrid-cell%E9%9C%80%E8%A6%81%E5%81%9A%E7%9A%84%E4%BA%8B%E6%83%85"><span class="toc-text">1.3 ç¬¬äºŒæ­¥ï¼šæ¯ä¸ªgrid celléœ€è¦åšçš„äº‹æƒ…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84"><span class="toc-text">1.4 ç½‘ç»œç»“æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="toc-text">1.5 æŸå¤±å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bbox%E6%8D%9F%E5%A4%B1"><span class="toc-text">1.5.1 BBoxæŸå¤±</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#confidence%E6%8D%9F%E5%A4%B1"><span class="toc-text">1.5.2 confidenceæŸå¤±</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%88%AB%E6%8D%9F%E5%A4%B1"><span class="toc-text">1.5.3 ç±»åˆ«æŸå¤±</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yolo-v1%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">1.6 YOLO v1å­˜åœ¨çš„é—®é¢˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yolo-v1%E4%B8%AD%E7%9A%84bounding-box-%E5%92%8C-anchor-%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"><span class="toc-text">1.7 YOLO v1ä¸­çš„Bounding Box å’Œ Anchor æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#yolo-v2"><span class="toc-text">2. YOLO v2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#yolo-v2-%E4%B8%8E%E5%85%B6%E4%BB%96%E7%BD%91%E7%BB%9C%E7%9A%84%E6%80%A7%E8%83%BD%E5%AF%B9%E6%AF%94"><span class="toc-text">2.1 YOLO v2 ä¸å…¶ä»–ç½‘ç»œçš„æ€§èƒ½å¯¹æ¯”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yolo-v2%E7%9B%B8%E6%AF%94v1%E7%9A%84%E5%B0%9D%E8%AF%95"><span class="toc-text">2.2 YOLO v2ç›¸æ¯”v1çš„å°è¯•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#batch-normalization"><span class="toc-text">2.2.1 Batch Normalization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high-resolution-classifier%E9%AB%98%E5%88%86%E8%BE%A8%E7%8E%87%E5%88%86%E7%B1%BB%E5%99%A8"><span class="toc-text">2.2.2 High Resolution Classifierï¼Œé«˜åˆ†è¾¨ç‡åˆ†ç±»å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#convolutional-with-anchor-boxes%E5%9F%BA%E4%BA%8Eanchor-boxes%E7%9A%84%E5%8D%B7%E7%A7%AF"><span class="toc-text">2.2.3 Convolutional With Anchor Boxesï¼ŒåŸºäºAnchor Boxesçš„å·ç§¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dimension-clusters%E7%BB%B4%E5%BA%A6%E8%81%9A%E7%B1%BB-anchor%E5%85%88%E9%AA%8C%E6%A1%86%E7%9A%84%E8%81%9A%E7%B1%BB"><span class="toc-text">2.2.4 Dimension Clustersï¼Œç»´åº¦èšç±» â€”â€” anchorå…ˆéªŒæ¡†çš„èšç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#direct-location-prediction%E7%9B%B4%E6%8E%A5%E5%AE%9A%E4%BD%8D%E9%A2%84%E6%B5%8B-%E9%A2%84%E6%B5%8B%E8%BE%B9%E7%95%8C%E6%A1%86%E5%AE%9A%E4%BD%8D%E5%9B%9E%E5%BD%92"><span class="toc-text">2.2.5 Direct Location Predictionï¼Œç›´æ¥å®šä½é¢„æµ‹ â€”â€” é¢„æµ‹è¾¹ç•Œæ¡†å®šä½å›å½’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fine-grained-features%E7%BB%86%E7%B2%92%E5%BA%A6%E7%89%B9%E5%BE%81"><span class="toc-text">2.2.6 Fine-Grained Featuresï¼Œç»†ç²’åº¦ç‰¹å¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#multi-scale-training%E5%A4%9A%E5%B0%BA%E5%BA%A6%E8%AE%AD%E7%BB%83"><span class="toc-text">2.2.7 Multi-scale Trainingï¼Œå¤šå°ºåº¦è®­ç»ƒ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yolo-v2%E7%9A%84backbone-darknet-19"><span class="toc-text">2.3 YOLO v2çš„backbone â€”â€” Darknet-19</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yolo-v2%E7%9A%84%E6%95%B4%E4%BD%93%E6%A1%86%E6%9E%B6"><span class="toc-text">2.4 YOLO v2çš„æ•´ä½“æ¡†æ¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yolo-v2%E8%AE%AD%E7%BB%83%E7%BB%86%E8%8A%82"><span class="toc-text">2.5 YOLO v2è®­ç»ƒç»†èŠ‚</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BA%E6%96%87%E4%B8%AD%E6%B2%A1%E6%9C%89%E6%8F%90%E5%8F%8A"><span class="toc-text">2.5.1 è®ºæ–‡ä¸­æ²¡æœ‰æåŠ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BA%E6%96%87%E6%8F%90%E5%8F%8A%E7%9A%84%E8%AE%AD%E7%BB%83%E7%BB%86%E8%8A%82"><span class="toc-text">2.5.2 è®ºæ–‡æåŠçš„è®­ç»ƒç»†èŠ‚</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#yolo-v3"><span class="toc-text">3. YOLO v3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#yolo-v3%E4%B8%8E%E5%85%B6%E4%BB%96%E7%BD%91%E7%BB%9C%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="toc-text">3.1 YOLO v3ä¸å…¶ä»–ç½‘ç»œçš„å¯¹æ¯”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yolo-v3%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84"><span class="toc-text">3.2 YOLO v3ç½‘ç»œæ¶æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#backbone-darknet-53"><span class="toc-text">3.2.1 backbone â€”â€” Darknet-53</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E4%BD%93%E6%A1%86%E6%9E%B6"><span class="toc-text">3.2.2 æ•´ä½“æ¡†æ¶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E6%A1%86%E7%9A%84%E9%A2%84%E6%B5%8B%E6%9C%BA%E5%88%B6"><span class="toc-text">3.3 ç›®æ ‡æ£€æµ‹æ¡†çš„é¢„æµ‹æœºåˆ¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#grid-cell%E7%9A%84priors%E7%9A%84%E6%AF%94%E4%BE%8B"><span class="toc-text">3.4 grid cellçš„priorsçš„æ¯”ä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A3%E8%B4%9F%E6%A0%B7%E6%9C%AC%E7%9A%84%E5%8C%B9%E9%85%8D"><span class="toc-text">3.5 æ­£è´Ÿæ ·æœ¬çš„åŒ¹é…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yolo-v3%E6%BA%90%E7%A0%81%E7%9A%84%E6%AD%A3%E8%B4%9F%E6%A0%B7%E6%9C%AC%E5%8C%B9%E9%85%8D%E7%AD%96%E7%95%A5"><span class="toc-text">3.6 YOLO v3æºç çš„æ­£è´Ÿæ ·æœ¬åŒ¹é…ç­–ç•¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0-1"><span class="toc-text">3.7 æŸå¤±å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%AE%E4%BF%A1%E5%BA%A6%E6%8D%9F%E5%A4%B1confidence-loss"><span class="toc-text">3.7.1 ç½®ä¿¡åº¦æŸå¤±ï¼ˆConfidence Lossï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%E7%B1%BB%E5%88%AB%E6%8D%9F%E5%A4%B1classes-loss"><span class="toc-text">3.7.2 åˆ†ç±»&#x2F;ç±»åˆ«æŸå¤±ï¼ˆClasses Lossï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%BD%8D%E6%8D%9F%E5%A4%B1location-loss"><span class="toc-text">3.7.3 å®šä½æŸå¤±ï¼ˆLocation Lossï¼‰</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#yolo-v3-spp"><span class="toc-text">4. YOLO v3-SPP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#v3-spp%E7%9B%B8%E6%AF%94v3%E7%9A%84%E6%94%B9%E8%BF%9B%E4%B9%8B%E5%A4%84"><span class="toc-text">4.1 v3-SPPç›¸æ¯”v3çš„æ”¹è¿›ä¹‹å¤„</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Miraclo</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">äººåªæœ‰åœ¨èµ°ä¸Šå¡è·¯çš„æ—¶å€™æ‰ä¼šç´¯å’Œè¿·èŒ«ã€‚</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if(window.MathJax)MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset();else{window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],tags:"ams"},chtml:{scale:1.1},options:{renderActions:{findScript:[10,t=>{for(const n of document.querySelectorAll('script[type^="math/tex"]')){var e=!!n.type.match(/; *mode=display/),e=new t.options.MathItem(n.textContent,t.inputJax[0],e),a=document.createTextNode("");n.parentNode.replaceChild(a,n),e.start={node:a,delim:"",n:0},e.end={node:a,delim:"",n:0},t.math.push(e)}},""],insertScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(t=>{t.hasAttribute("display")?btf.wrap(t,"div",{class:"mathjax-overflow"}):btf.wrap(t,"span",{class:"mathjax-overflow"})})},"",!1]}}};const a=document.createElement("script");a.src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js",a.id="MathJax-script",a.async=!0,document.head.appendChild(a)}</script></div><link rel="stylesheet" href="/css/Lete.css"><script src="/js/custom.js"></script><script src="/js/mouth.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script data-pjax>var parent,child;document.getElementById("recent-posts")&&"/"===location.pathname&&(parent=document.getElementById("recent-posts"),child='<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="http://Unicorn-acc.github.io/categories/JavaæŠ€æœ¯æ ˆ/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ“š JavaæŠ€æœ¯æ ˆç›¸å…³ (54)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="http://Unicorn-acc.github.io/categories/æ·±åº¦å­¦ä¹ ç¬”è®°/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ® æ·±åº¦å­¦ä¹ ç¬”è®°ç›¸å…³ (20)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="http://Unicorn-acc.github.io/categories/æ·±åº¦å­¦ä¹ ç¬”è®°/ç½‘ç»œæ¨¡å‹/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ“’ ç½‘ç»œæ¨¡å‹ (15)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="http://Unicorn-acc.github.io/categories/æ•°æ®åº“/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">â€ğŸ‘“ æ•°æ®åº“ç›¸å…³ (36)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item" style="visibility: hidden"></div><div class="magnet_item" style="visibility: hidden"></div><a class="magnet_link_more"  href="http://Unicorn-acc.github.io/categories" style="flex:1;text-align: center;margin-bottom: 10px;">æŸ¥çœ‹æ›´å¤š...</a></div></div>',console.log("å·²æŒ‚è½½magnet"),parent.insertAdjacentHTML("afterbegin",child))</script><style>#catalog_magnet{flex-wrap:wrap;display:flex;width:100%;justify-content:space-between;padding:10px 10px 0 10px;align-content:flex-start}.magnet_item{flex-basis:calc(33.333333333333336% - 5px);background:#f2f2f2;margin-bottom:10px;border-radius:8px;transition:all .2s ease-in-out}.magnet_item:hover{background:#b30070}.magnet_link_more{color:#555}.magnet_link{color:#000}.magnet_link:hover{color:#fff}@media screen and (max-width:600px){.magnet_item{flex-basis:100%}}.magnet_link_context{display:flex;padding:10px;font-size:16px;transition:all .2s ease-in-out}.magnet_link_context:hover{padding:10px 20px}</style><style></style></body></html>
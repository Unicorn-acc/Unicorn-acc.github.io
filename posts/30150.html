<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Ajax快速入门（Ajax简介、原生Ajax、三种【jQuery\Axios\Fetch】常见发送Ajax请求、跨域与解决） | Miraclo</title><meta name="author" content="Miraclo"><meta name="copyright" content="Miraclo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="说明  本笔记为尚硅谷Web前端Ajax教程初学者零基础入门到精通全套完整版的学习笔记 该课程主要讲述原生AJAX的写法 以及 市场上常用的对于原生ajax封装的插件简单使用 地址：https:&#x2F;&#x2F;gitee.com&#x2F;hongjilin&#x2F;hongs-study-notes&#x2F;blob&#x2F;master&#x2F;  目录  [TOC]  一、Ajax简介 AJAX 简介 AJAX 全称为 Asynchronous"><meta property="og:type" content="article"><meta property="og:title" content="Ajax快速入门（Ajax简介、原生Ajax、三种【jQuery\Axios\Fetch】常见发送Ajax请求、跨域与解决）"><meta property="og:url" content="http://unicorn-acc.github.io/posts/30150.html"><meta property="og:site_name" content="Miraclo"><meta property="og:description" content="说明  本笔记为尚硅谷Web前端Ajax教程初学者零基础入门到精通全套完整版的学习笔记 该课程主要讲述原生AJAX的写法 以及 市场上常用的对于原生ajax封装的插件简单使用 地址：https:&#x2F;&#x2F;gitee.com&#x2F;hongjilin&#x2F;hongs-study-notes&#x2F;blob&#x2F;master&#x2F;  目录  [TOC]  一、Ajax简介 AJAX 简介 AJAX 全称为 Asynchronous"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://w.wallhaven.cc/full/1p/wallhaven-1pjml1.jpg"><meta property="article:published_time" content="2022-12-21T22:53:00.000Z"><meta property="article:modified_time" content="2023-01-28T12:51:56.082Z"><meta property="article:author" content="Miraclo"><meta property="article:tag" content="ajax"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://w.wallhaven.cc/full/1p/wallhaven-1pjml1.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://unicorn-acc.github.io/posts/30150"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:2e3},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:800,languages:{author:"作者: Miraclo",link:"链接: ",source:"来源: Miraclo",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Ajax快速入门（Ajax简介、原生Ajax、三种【jQueryAxiosFetch】常见发送Ajax请求、跨域与解决）",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-01-28 12:51:56"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,a){0!==a&&(a=864e5*a,t={value:t,expiry:(new Date).getTime()+a},localStorage.setItem(e,JSON.stringify(t)))},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);if(!((new Date).getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=o=>new Promise((t,e)=>{const a=document.createElement("script");a.src=o,a.async=!0,a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme"),"dark"===e?activateDarkMode():"light"===e&&activateLightMode(),e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/mouth.css"><link rel="stylesheet" href="/css/codecolor.css"><link rel="stylesheet" href="//s1.hdslb.com/bfs/static/jinkela/long/font/medium.css"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload='this.media="screen"'><meta name="generator" content="Hexo 6.0.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">139</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-film"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:randomPost();"><i class="fa-fw fa-solid fa-shuffle"></i><span></span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://w.wallhaven.cc/full/1p/wallhaven-1pjml1.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Miraclo</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-film"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:randomPost();"><i class="fa-fw fa-solid fa-shuffle"></i><span></span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Ajax快速入门（Ajax简介、原生Ajax、三种【jQuery\Axios\Fetch】常见发送Ajax请求、跨域与解决）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2022-12-21T22:53:00.000Z" title="发表于 2022-12-21 22:53:00">2022-12-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java%E6%8A%80%E6%9C%AF%E6%A0%88/">Java技术栈</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java%E6%8A%80%E6%9C%AF%E6%A0%88/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E6%A0%88/">前端技术栈</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>25分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Ajax快速入门（Ajax简介、原生Ajax、三种【jQuery\Axios\Fetch】常见发送Ajax请求、跨域与解决）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="说明">说明</h1><blockquote><p>本笔记为<code>尚硅谷Web前端Ajax教程初学者零基础入门到精通全套完整版</code>的学习笔记</p><p>该课程主要讲述原生AJAX的写法 以及 市场上常用的对于原生ajax封装的插件简单使用</p><p>地址：https://gitee.com/hongjilin/hongs-study-notes/blob/master/</p></blockquote><h1 id="目录">目录</h1><blockquote><p>[TOC]</p></blockquote><h1 id="一ajax简介">一、Ajax简介</h1><p>AJAX 简介 AJAX 全称为 Asynchronous JavaScript And XML，就是异步的 JS 和 XML。</p><p>通过 AJAX 可以在浏览器中向服务器发送异步请求，最大的优势：<code>无刷新获取数据</code>。</p><p>AJAX 不是新的编程语言，而是一种将现有的标准组合在一起使用的新方式。</p><h2 id="xml简介">1、XML简介</h2><ol type="1"><li><p>XML 可扩展标记语言。</p></li><li><p>XML 被设计用来传输和存储数据。</p></li><li><p>XML 和 HTML 类似，不同的是 HTML 中都是预定义标签，而 XML 中没有预定义标签， 全都是自定义标签，用来表示一些数据。</p></li></ol><p>比如说我有一个学生数据： name = "孙悟空" ; age = 18 ; gender = "男" ;</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml">用 XML 表示：<br><span class="hljs-tag">&lt;<span class="hljs-name">student</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>孙悟空<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">age</span>&gt;</span>18<span class="hljs-tag">&lt;/<span class="hljs-name">age</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">gender</span>&gt;</span>男<span class="hljs-tag">&lt;/<span class="hljs-name">gender</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">student</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>现在已经被 JSON 取代了。</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs JSON"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;孙悟空&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;gender&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;男&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ajax的特点">2、Ajax的特点</h2><h3 id="ajax-的优点">Ⅰ-AJAX 的优点</h3><ol type="1"><li><p>可以无需刷新页面而与服务器端进行通信。</p></li><li><p>允许你根据用户事件来更新部分页面内容。</p></li></ol><h3 id="ajax的缺点">Ⅱ-Ajax的缺点</h3><ol type="1"><li><p>没有浏览历史，不能回退</p></li><li><p>存在跨域问题(同源)</p></li><li><p>SEO 不友好</p></li></ol><h2 id="http简介">3、HTTP简介</h2><p>HTTP（hypertext transport protocol）协议『超文本传输协议』，协议详细规定了浏览器和万维网服务器之间互相通信的规则、约定,、规则</p><h3 id="请求报文">Ⅰ-请求报文</h3><p><code>重点是格式与参数</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">行   <span class="hljs-variable constant_">POST</span> /s?ie=utf-<span class="hljs-number">8</span> <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span> <br><br>头   <span class="hljs-title class_">Host</span>: atguigu.<span class="hljs-property">com</span><br><span class="hljs-title class_">Cookie</span>: name=guigu<br><span class="hljs-title class_">Content</span>-<span class="hljs-attr">type</span>: application/x-www-form-urlencoded<br><span class="hljs-title class_">User</span>-<span class="hljs-title class_">Agent</span>: chrome <span class="hljs-number">83</span><br>空行<br>体   username=admin&amp;password=admin<br></code></pre></td></tr></table></figure><h3 id="响应报文">Ⅱ-响应报文</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js">行   <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> <span class="hljs-variable constant_">OK</span><br><br>头   <span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Type</span>: text/html;charset=utf-<span class="hljs-number">8</span><br><span class="hljs-title class_">Content</span>-<span class="hljs-attr">length</span>: <span class="hljs-number">2048</span><br><span class="hljs-title class_">Content</span>-<span class="hljs-attr">encoding</span>: gzip<br>空行  <br>体   &lt;html&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>尚硅谷<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><h3 id="chrome网络控制台查看通信报文">Ⅲ-Chrome网络控制台查看通信报文</h3><p>1、Network --&gt; Hearders 请求头</p><p>2、Network --&gt; Response 响应体:通常返回的是html</p><h1 id="二原生ajax">二、原生Ajax</h1><p>1、XMLHttpRequest，AJAX 的所有操作都是通过该对象进行的。</p><p>2、当你前端想设置自定义的请求头时,需要如此后端设置响应头</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//表示接收任意类型的请求							</span><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/server&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123; <span class="hljs-comment">//响应头 允许跨域     运行自定义响应头</span><br>response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>); <br>response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);&#125;<br></code></pre></td></tr></table></figure><p>3、<code>ajax请求状态</code>:xhr.readyState 0：请求未初始化，还没有调用 open()。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1：请求已经建立，但是还没有发送，还没有调用 send()。<br><br>2：请求已发送，正在处理中（通常现在可以从响应中获取内容头）。<br><br>3：请求在处理中；通常响应中已有部分数据可用了，没有全部完成。<br><br>4：响应已完成；您可以获取并使用服务器的响应了<br></code></pre></td></tr></table></figure><h3 id="ajax的使用">〇-Ajax的使用</h3><p>使用步骤:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-number">1</span>) 创建 <span class="hljs-title class_">XMLHttpRequest</span> 对象<br><span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br><span class="hljs-number">2</span>) 设置请求信息<br>xhr.<span class="hljs-title function_">open</span>(method, url);<br><span class="hljs-comment">//可以设置请求头，一般不设置</span><br>xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&#x27;Content-Type&#x27;</span>, <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>);<br><span class="hljs-number">3</span>) 发送请求<br>xhr.<span class="hljs-title function_">send</span>(body) <span class="hljs-comment">//get 请求不传 body 参数，只有 post 请求使用</span><br><span class="hljs-number">4</span>) 接收响应<br><span class="hljs-comment">//xhr.responseXML 接收 xml 格式的响应数据</span><br><span class="hljs-comment">//xhr.responseText 接收文本格式的响应数据</span><br>xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> == <span class="hljs-number">4</span> &amp;&amp; xhr.<span class="hljs-property">status</span> == <span class="hljs-number">200</span>)&#123;<br><span class="hljs-keyword">var</span> text = xhr.<span class="hljs-property">responseText</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(text);<br>&#125;&#125;<br></code></pre></td></tr></table></figure><h3 id="get方式">Ⅰ-Get方式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//绑定事件</span><br>btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">//1. 创建对象</span><br>  <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>  <span class="hljs-comment">//2. 初始化 设置请求方法和 url</span><br>  xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;http://127.0.0.1:8000/server?a=100&amp;b=200&amp;c=300&#x27;</span>);<br>  <span class="hljs-comment">//3. 发送</span><br>  xhr.<span class="hljs-title function_">send</span>();<br>  <span class="hljs-comment">//4. 事件绑定 处理服务端返回的结果</span><br>  <span class="hljs-comment">// on  when 当....时候</span><br>  <span class="hljs-comment">// readystate 是 xhr 对象中的属性, 表示状态 0 1 2 3 4</span><br>  <span class="hljs-comment">// change  改变</span><br>  xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">//判断 (服务端返回了所有的结果)</span><br>    <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) &#123;<br>      <span class="hljs-comment">//判断响应状态码 200  404  403 401 500</span><br>      <span class="hljs-comment">// 2xx 成功</span><br>      <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>) &#123;<br>        <span class="hljs-comment">//处理结果  行 头 空行 体</span><br>        <span class="hljs-comment">//响应 </span><br>        <span class="hljs-comment">// console.log(xhr.status);//状态码</span><br>        <span class="hljs-comment">// console.log(xhr.statusText);//状态字符串</span><br>        <span class="hljs-comment">// console.log(xhr.getAllResponseHeaders());//所有响应头</span><br>        <span class="hljs-comment">// console.log(xhr.response);//响应体</span><br>        <span class="hljs-comment">//设置 result 的文本</span><br>        result.<span class="hljs-property">innerHTML</span> = xhr.<span class="hljs-property">response</span>;<br>      &#125; <span class="hljs-keyword">else</span> &#123;&#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="post方式">Ⅱ-Post方式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;result&quot;</span>);<br><span class="hljs-comment">//绑定事件 mouseover鼠标放在元素上时触发事件</span><br>result.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;mouseover&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-comment">//1. 创建对象</span><br>    <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>    <span class="hljs-comment">//2. 初始化 设置类型与 URL</span><br>    xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;http://127.0.0.1:8000/server&#x27;</span>);<br>    <span class="hljs-comment">//设置请求头</span><br>    xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&#x27;Content-Type&#x27;</span>,<span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>);<br>    xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;atguigu&#x27;</span>);<br>    <span class="hljs-comment">//3. 发送</span><br>    xhr.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;a=100&amp;b=200&amp;c=300&#x27;</span>);<br>    <span class="hljs-comment">// xhr.send(&#x27;a:100&amp;b:200&amp;c:300&#x27;);</span><br>    <span class="hljs-comment">// xhr.send(&#x27;1233211234567&#x27;);</span><br>    <span class="hljs-comment">//4. 事件绑定</span><br>    xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-comment">//判断</span><br>        <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>)&#123;<br>            <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>)&#123;<br>                <span class="hljs-comment">//处理服务端返回的结果</span><br>                result.<span class="hljs-property">innerHTML</span> = xhr.<span class="hljs-property">response</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="解决ie缓存问题">Ⅲ-解决ie缓存问题</h3><p>问题：在一些浏览器中(IE),由于<code>缓存机制</code>的存在，ajax 只会发送的第一次请求，剩余多次请求不会再发送给浏览器而是直接加载缓存中的数据。</p><p>解决方式：浏览器的缓存是根据 url地址来记录的，所以我们只需要修改 url 地址 即可避免缓存问题</p><ul><li><code>xhr.open("get","/testAJAX?t="+Date.now());</code></li></ul><h3 id="请求超时与网络异常">Ⅳ-请求超时与网络异常</h3><p>当你的请求时间过长,或者无网络时,进行的相应处理</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js">btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>    <span class="hljs-comment">//超时设置 2s 设置</span><br>    xhr.<span class="hljs-property">timeout</span> = <span class="hljs-number">2000</span>;<br>    <span class="hljs-comment">//超时回调</span><br>    xhr.<span class="hljs-property">ontimeout</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;网络异常, 请稍后重试!!&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">//网络异常回调</span><br>    xhr.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;你的网络似乎出了一些问题!&quot;</span>);<br>    &#125;<br><br>    xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;GET&quot;</span>,<span class="hljs-string">&#x27;http://127.0.0.1:8000/delay&#x27;</span>);<br>    xhr.<span class="hljs-title function_">send</span>();<br>    xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>)&#123;<br>            <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span>&lt; <span class="hljs-number">300</span>)&#123;<br>                result.<span class="hljs-property">innerHTML</span> = xhr.<span class="hljs-property">response</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="取消请求">Ⅴ-取消请求</h3><p>在请求发出去后<code>但是未响应完成</code>时可以进行取消请求操作</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> btns = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;button&#x27;</span>);<br><span class="hljs-keyword">let</span> x = <span class="hljs-literal">null</span>;<br>btns[<span class="hljs-number">0</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    x = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>    x.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;GET&quot;</span>,<span class="hljs-string">&#x27;http://127.0.0.1:8000/delay&#x27;</span>);<br>    x.<span class="hljs-title function_">send</span>();<br>&#125;<br><span class="hljs-comment">// abort</span><br>btns[<span class="hljs-number">1</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    x.<span class="hljs-title function_">abort</span>();<span class="hljs-comment">//取消请求</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="重复请求问题">Ⅵ-重复请求问题</h3><p>利用之前Ⅴ中取消请求知识点,当我点击时判断之前请求是否在发送中,如果是,则停止请求</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js">btns[<span class="hljs-number">0</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-comment">//判断标识变量</span><br>    <span class="hljs-keyword">if</span>(isSending) x.<span class="hljs-title function_">abort</span>();<span class="hljs-comment">// 如果正在发送, 则取消该请求, 创建一个新的请求</span><br>    x = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>    <span class="hljs-comment">//修改 标识变量的值</span><br>    isSending = <span class="hljs-literal">true</span>;<br>    x.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;GET&quot;</span>,<span class="hljs-string">&#x27;http://127.0.0.1:8000/delay&#x27;</span>);<br>    x.<span class="hljs-title function_">send</span>();<br>    x.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">if</span>(x.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>)&#123;<br>            <span class="hljs-comment">//修改标识变量</span><br>            isSending = <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="三常见三种ajax请求方式">三、常见三种Ajax请求方式</h1><h2 id="jquery发送ajax请求">1、jQuery发送AJAX请求</h2><p>jQuery有三种发送请求方法:</p><p>当你只是简单的请求数据,可以直接使用前两种方式请求,当你需要设置的东西较多的时候,可以使用<code>$.ajax()</code>方法</p><h3 id="get">Ⅰ-$.get()</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">$(<span class="hljs-string">&#x27;button&#x27;</span>).<span class="hljs-title function_">eq</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    $.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;http://127.0.0.1:8000/jquery-server&#x27;</span>, &#123;<span class="hljs-attr">a</span>:<span class="hljs-number">100</span>, <span class="hljs-attr">b</span>:<span class="hljs-number">200</span>&#125;, <span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);<br>    &#125;,<span class="hljs-string">&#x27;json&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="post">Ⅱ-$.post()</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">$(<span class="hljs-string">&#x27;button&#x27;</span>).<span class="hljs-title function_">eq</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    $.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;http://127.0.0.1:8000/jquery-server&#x27;</span>, &#123;<span class="hljs-attr">a</span>:<span class="hljs-number">100</span>, <span class="hljs-attr">b</span>:<span class="hljs-number">200</span>&#125;, <span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);<br>    &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="ajax">Ⅲ-$.ajax</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js">$(<span class="hljs-string">&#x27;button&#x27;</span>).<span class="hljs-title function_">eq</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    $.<span class="hljs-title function_">ajax</span>(&#123;<br>        <span class="hljs-comment">//url</span><br>        <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;http://127.0.0.1:8000/jquery-server&#x27;</span>,<br>        <span class="hljs-comment">//参数</span><br>        <span class="hljs-attr">data</span>: &#123;<span class="hljs-attr">a</span>:<span class="hljs-number">100</span>, <span class="hljs-attr">b</span>:<span class="hljs-number">200</span>&#125;,<br>        <span class="hljs-comment">//请求类型</span><br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;GET&#x27;</span>,<br>        <span class="hljs-comment">//响应体结果</span><br>        <span class="hljs-attr">dataType</span>: <span class="hljs-string">&#x27;json&#x27;</span>,<br>        <span class="hljs-comment">//成功的回调</span><br>        <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)&#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);<br>        &#125;,<br>        <span class="hljs-comment">//超时时间</span><br>        <span class="hljs-attr">timeout</span>: <span class="hljs-number">2000</span>,<br>        <span class="hljs-comment">//失败的回调</span><br>        <span class="hljs-attr">error</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;出错啦!!&#x27;</span>);<br>        &#125;,<br>        <span class="hljs-comment">//头信息</span><br>        <span class="hljs-attr">headers</span>: &#123;<br>            <span class="hljs-attr">c</span>:<span class="hljs-number">300</span>,<br>            <span class="hljs-attr">d</span>:<span class="hljs-number">400</span><br>        &#125;<br>    &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><h2 id="axios发送ajax请求">2、Axios发送AJAX请求</h2><h3 id="axios.get">Ⅰ-axios.get()</h3><p>axios.get(url,data,params)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//配置 baseURL</span><br>axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">baseURL</span> = <span class="hljs-string">&#x27;http://127.0.0.1:8000&#x27;</span>;<br><br>btns[<span class="hljs-number">0</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">//GET 请求</span><br>  axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/axios-server&#x27;</span>, &#123;<br>    <span class="hljs-comment">//url 参数</span><br>    <span class="hljs-attr">params</span>: &#123;<br>      <span class="hljs-attr">id</span>: <span class="hljs-number">100</span>,<br>      <span class="hljs-attr">vip</span>: <span class="hljs-number">7</span><br>    &#125;,<br>    <span class="hljs-comment">//请求头信息</span><br>    <span class="hljs-attr">headers</span>: &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;atguigu&#x27;</span>,<br>      <span class="hljs-attr">age</span>: <span class="hljs-number">20</span><br>    &#125;<br>  &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123; <span class="hljs-comment">// 回调函数then</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);<br>  &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="axios.post">Ⅱ-axios.post()</h3><p>axios.post(url,data,params)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//配置 baseURL</span><br>axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">baseURL</span> = <span class="hljs-string">&#x27;http://127.0.0.1:8000&#x27;</span>;  <br>btns[<span class="hljs-number">1</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/axios-server&#x27;</span>, &#123;<br>    <span class="hljs-attr">username</span>: <span class="hljs-string">&#x27;admin&#x27;</span>,<br>    <span class="hljs-attr">password</span>: <span class="hljs-string">&#x27;admin&#x27;</span><br>  &#125;, &#123;<br>    <span class="hljs-comment">//url </span><br>    <span class="hljs-attr">params</span>: &#123;<br>      <span class="hljs-attr">id</span>: <span class="hljs-number">200</span>,<br>      <span class="hljs-attr">vip</span>: <span class="hljs-number">9</span><br>    &#125;,<br>    <span class="hljs-comment">//请求头参数</span><br>    <span class="hljs-attr">headers</span>: &#123;<br>      <span class="hljs-attr">height</span>: <span class="hljs-number">180</span>,<br>      <span class="hljs-attr">weight</span>: <span class="hljs-number">180</span>,<br>    &#125;<br>  &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="axios-函数发送请求常用">Ⅲ-✨axios() 函数发送请求（常用）</h3><p>axios({})</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//配置 baseURL</span><br>axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">baseURL</span> = <span class="hljs-string">&#x27;http://127.0.0.1:8000&#x27;</span>;<br>btns[<span class="hljs-number">2</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-title function_">axios</span>(&#123;<br>    <span class="hljs-comment">//请求方法</span><br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>    <span class="hljs-comment">//url</span><br>    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/axios-server&#x27;</span>,<br>    <span class="hljs-comment">//url参数</span><br>    <span class="hljs-attr">params</span>: &#123;<br>      <span class="hljs-attr">vip</span>: <span class="hljs-number">10</span>,<br>      <span class="hljs-attr">level</span>: <span class="hljs-number">30</span><br>    &#125;,<br>    <span class="hljs-comment">//头信息,此部分如果使用自定义的头信息,需要服务端进行相应修改,正常不设置</span><br>    <span class="hljs-attr">headers</span>: &#123;<br>      <span class="hljs-attr">a</span>: <span class="hljs-number">100</span>,<br>      <span class="hljs-attr">b</span>: <span class="hljs-number">200</span><br>    &#125;,<br>    <span class="hljs-comment">//请求体参数</span><br>    <span class="hljs-attr">data</span>: &#123;<br>      <span class="hljs-attr">username</span>: <span class="hljs-string">&#x27;admin&#x27;</span>,<br>      <span class="hljs-attr">password</span>: <span class="hljs-string">&#x27;admin&#x27;</span><br>    &#125;<br>  &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">//响应状态码</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">status</span>);<br>    <span class="hljs-comment">//响应状态字符串</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">statusText</span>);<br>    <span class="hljs-comment">//响应头信息</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">headers</span>);<br>    <span class="hljs-comment">//响应体</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">data</span>);<br>  &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="fetch发送ajax请求">3、Fetch发送AJAX请求</h2><p>代码示例</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js">btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://127.0.0.1:8000/fetch-server?vip=10&#x27;</span>, &#123;<br>    <span class="hljs-comment">//请求方法</span><br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>    <span class="hljs-comment">//请求头</span><br>    <span class="hljs-attr">headers</span>: &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;atguigu&#x27;</span><br>    &#125;,<br>    <span class="hljs-comment">//请求体</span><br>    <span class="hljs-attr">body</span>: <span class="hljs-string">&#x27;username=admin&amp;password=admin&#x27;</span><br>  &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">// return response.text();</span><br>    <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>();<br>  &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);<br>  &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="四跨域与解决">四、跨域与解决</h1><p><strong>1、什么是跨域？</strong></p><ul><li>一个网页向另一个不同域名/不同协议/不同端口的网页请求资源，这就是跨域。</li><li>跨域原因产生：在当前域名请求网站中，默认不允许通过ajax请求发送其他域名。</li></ul><p><strong>2、为什么会产生跨域请求？</strong></p><ul><li>因为浏览器使用了同源策略</li></ul><p><strong>3、什么是同源策略？</strong></p><ul><li>同源策略是Netscape提出的一个著名的安全策略，现在所有支持JavaScript的浏览器都会使用这个策略。同源策略是浏览器最核心也最基本的安全功能，如果缺少同源策略，浏览器的正常功能可能受到影响。可以说web是构建在同源策略的基础之上的，浏览器只是针对同源策略的一种实现。</li><li>同源： 协议、域名、端口号 必须完全相同。 <code>违背同源策略就是跨域</code>。</li></ul><p><strong>4、为什么浏览器要使用同源策略？</strong></p><ul><li>是为了保证用户的信息安全，防止恶意网站窃取数据，如果网页之间不满足同源要求，将不能:</li><li><ul><li>1、共享Cookie、LocalStorage、IndexDB</li></ul></li><li><ul><li>2、获取DOM</li></ul></li><li><ul><li>3、AJAX请求不能发送</li></ul></li></ul><p><strong>5、跨域的五个解决方式:</strong></p><p>1、前端使用jsonp （不推荐使用）</p><p>2、后台Http请求转发</p><p>3、后台配置同源Cors （推荐）</p><p>4、使用SpringCloud网关</p><p>5、使用nginx做转发 (推荐)</p><p>本课程提到了其中的两种:</p><h2 id="jsonp">1、jsonP</h2><ol type="1"><li>JSONP 是什么?</li></ol><p>JSONP(JSON with Padding)，是一个非官方的跨域解决方案，纯粹凭借程序员的聪明 才智开发出来，只支持 get 请求。</p><ol start="2" type="1"><li>JSONP 怎么工作的？</li></ol><p>在网页有一些标签天生具有跨域能力，比如：img link iframe script。 JSONP 就是利用 script 标签的跨域能力来发送请求的。</p><h3 id="jsonp的使用">Ⅰ-jsonP的使用</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1. 动态的创建一个 script 标签------------------------------------------------------------</span><br><span class="hljs-keyword">var</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;script&quot;</span>);<br><span class="hljs-comment">//2. 设置 script 的 src， 设置回调函数</span><br>script.<span class="hljs-property">src</span> = <span class="hljs-string">&quot;http://localhost:3000/testAJAX?callback=abc&quot;</span>;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">abc</span>(<span class="hljs-params">data</span>) &#123;<br>  <span class="hljs-title function_">alert</span>(data.<span class="hljs-property">name</span>);<br>&#125;;<br><span class="hljs-comment">// 3. 将 script 添加到 body 中</span><br><span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(script);<br><br><span class="hljs-comment">// 4. 服务器中路由的处理------------------------------------------------------</span><br>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/testAJAX&quot;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;收到请求&quot;</span>);<br>  <span class="hljs-keyword">var</span> callback = req.<span class="hljs-property">query</span>.<span class="hljs-property">callback</span>;<br>  <span class="hljs-keyword">var</span> obj = &#123;<br>    <span class="hljs-attr">ame</span>: <span class="hljs-string">&quot;孙悟空&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span><br>  &#125;<br>  res.<span class="hljs-title function_">send</span>(callback + <span class="hljs-string">&quot;(&quot;</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(obj) + <span class="hljs-string">&quot;)&quot;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="jquery发送jsonp请求">Ⅱ-jQuery发送jsonP请求</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//前端代码-----------------------------------------------------------------------------------</span><br>$(<span class="hljs-string">&#x27;button&#x27;</span>).<span class="hljs-title function_">eq</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  $.<span class="hljs-title function_">getJSON</span>(<span class="hljs-string">&#x27;http://127.0.0.1:8000/jquery-jsonp-server?callback=?&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>    $(<span class="hljs-string">&#x27;#result&#x27;</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">`</span><br><span class="hljs-string">                名称: <span class="hljs-subst">$&#123;data.name&#125;</span>&lt;br&gt;</span><br><span class="hljs-string">                校区: <span class="hljs-subst">$&#123;data.city&#125;</span></span><br><span class="hljs-string">            `</span>)<br>  &#125;);<br>&#125;);<br><br><span class="hljs-comment">//服务端代码-----------------------------------------------------------</span><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/jquery-jsonp-server&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// response.send(&#x27;console.log(&quot;hello jsonp&quot;)&#x27;);</span><br>  <span class="hljs-keyword">const</span> data = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;尚硅谷&#x27;</span>,<br>    <span class="hljs-attr">city</span>: [<span class="hljs-string">&#x27;北京&#x27;</span>, <span class="hljs-string">&#x27;上海&#x27;</span>, <span class="hljs-string">&#x27;深圳&#x27;</span>]<br>  &#125;;<br>  <span class="hljs-comment">//将数据转化为字符串</span><br>  <span class="hljs-keyword">let</span> str = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data);<br>  <span class="hljs-comment">//接收 callback 参数</span><br>  <span class="hljs-keyword">let</span> cb = request.<span class="hljs-property">query</span>.<span class="hljs-property">callback</span>;<br><br>  <span class="hljs-comment">//返回结果</span><br>  response.<span class="hljs-title function_">end</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;cb&#125;</span>(<span class="hljs-subst">$&#123;str&#125;</span>)`</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="我自己开发封装的jsonp插件">Ⅲ-我自己开发封装的jsonP插件</h3><p>1、代价:需要前后端联动</p><p>2、精髓:自动的由插件生成方法名,并在当前的页面动态的生成函数,然后再生成的函数里头调用用户预留的回调函数</p><p>3、插件：自动化的去模拟基于script去实现跨域请求的过程（对用户来说是黑盒子）</p><p>4、参数拼接：url已经是带参的。和不带参的</p><p>5、id优化 额可以添加一个容器来管理id</p><hr><p>1、前端调用测试封装好的jsonP代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//测试调用函数</span><br>    <span class="hljs-keyword">let</span> test=<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        jsonP.<span class="hljs-title function_">req</span>(&#123;<br>            <span class="hljs-attr">url</span>:<span class="hljs-string">&quot;http://localhost:3000/jsonpx&quot;</span>,<br>            <span class="hljs-attr">data</span>:&#123;<br>                <span class="hljs-attr">a</span>:<span class="hljs-string">&quot;111&quot;</span><br>            &#125;,<br>            <span class="hljs-attr">callback</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">result</span>) &#123;<br>                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;成功&quot;</span>+result)<br>            &#125;<br>        &#125;)<br>    &#125;<br></code></pre></td></tr></table></figure><p>2、服务端测试代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/jsonpx&#x27;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">req, resp, next</span>) &#123;<br>    <span class="hljs-keyword">let</span> callback=req.<span class="hljs-property">query</span>.<span class="hljs-property">callback</span>;<br>    <span class="hljs-keyword">let</span> data=req.<span class="hljs-property">query</span>.<span class="hljs-property">a</span>;<br>    <span class="hljs-keyword">if</span> (!data)&#123;<br>        resp.<span class="hljs-title function_">send</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;callback&#125;</span>(&#x27;洪jl:我是服务端代码&#x27;)`</span>)<br>    &#125;<br>    resp.<span class="hljs-title function_">send</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;callback&#125;</span>(&#x27;洪jl:我是服务端代码`</span>+data+<span class="hljs-string">`&#x27;)`</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><p>3、封装原生代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script&gt;<br>    <span class="hljs-comment">/**author:<span class="hljs-doctag">@hongjilin</span></span><br><span class="hljs-comment">     * 1.声明一个jsonP插件对象</span><br><span class="hljs-comment">     * 作用：隔开作用域</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">let</span> jsonP = &#123;&#125;;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *2.在插件对象中创建两个名字备用符数组</span><br><span class="hljs-comment">     */</span><br>    jsonP.<span class="hljs-property">char</span> = &#123;<br>        <span class="hljs-title class_">Number</span>: <span class="hljs-string">&#x27;0123456789&#x27;</span>,<br>        <span class="hljs-title class_">Letter</span>: <span class="hljs-string">&#x27;qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&#x27;</span><br>    &#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 通过随机数抽取备用字符数组库拼凑函数id</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> <span class="hljs-variable">charLen</span></span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> <span class="hljs-variable">numLen</span></span><br><span class="hljs-comment">     */</span><br>    jsonP.<span class="hljs-property">newFunId</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">charLen, numLen</span>) &#123;<br>        <span class="hljs-keyword">let</span> id = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; charLen; i++) &#123;<br>            id += <span class="hljs-variable language_">this</span>.<span class="hljs-property">char</span>.<span class="hljs-property">Letter</span>.<span class="hljs-title function_">charAt</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">52</span>)<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; numLen; j++) &#123;<br>            id += <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> id;<br>    &#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 拼接路径</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> <span class="hljs-variable">url</span></span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> <span class="hljs-variable">key</span></span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> <span class="hljs-variable">value</span></span><br><span class="hljs-comment">     */</span><br>    jsonP.<span class="hljs-property">jointUrl</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">url, key, value</span>) &#123;<br>        <span class="hljs-keyword">if</span> (url &amp;&amp; key &amp;&amp; value) &#123;<br>            <span class="hljs-keyword">let</span> sign = <span class="hljs-string">&quot;&amp;&quot;</span><br>            <span class="hljs-comment">//如果是第一次</span><br>            <span class="hljs-keyword">if</span> (url.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;?&#x27;</span>) == -<span class="hljs-number">1</span>) &#123;<br>                sign = <span class="hljs-string">&#x27;?&#x27;</span><br>            &#125;<br><br>            url += sign + key + <span class="hljs-string">&quot;=&quot;</span> + value<br>        &#125;<br>        <span class="hljs-keyword">return</span> url;<br>    &#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     封装err属性方便</span><br><span class="hljs-comment">     */</span><br>    jsonP.<span class="hljs-property">err</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">msg</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(msg)<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 发送请求函数</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> <span class="hljs-variable">options</span></span><br><span class="hljs-comment">     */</span><br>    jsonP.<span class="hljs-property">req</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">options</span>) &#123;<br>        <span class="hljs-keyword">let</span> jsonId=&#123;&#125;;<br>        <span class="hljs-comment">//1.生成方法名</span><br>        jsonId.<span class="hljs-property">funId</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">newFunId</span>(<span class="hljs-number">4</span>,<span class="hljs-number">8</span>);<br>        <span class="hljs-keyword">let</span> <span class="hljs-title class_">Userurl</span> = options.<span class="hljs-property">url</span>;<br>        <span class="hljs-keyword">let</span> <span class="hljs-title class_">Userdata</span> = options.<span class="hljs-property">data</span>;<br>        <span class="hljs-keyword">if</span> (!options) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">err</span>(<span class="hljs-string">&quot;输入不能空&quot;</span>)<br>            <span class="hljs-keyword">return</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Userurl</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">err</span>(<span class="hljs-string">&quot;url不能空&quot;</span>)<br>            <span class="hljs-keyword">return</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Userdata</span>) &#123;<br>            <span class="hljs-comment">//如果没有data,初始化</span><br>            <span class="hljs-title class_">Userdata</span> = &#123;&#125;;<br>        &#125;<br>        <span class="hljs-comment">//将函数名赋值给userdata的回调函数属性中</span><br>        <span class="hljs-title class_">Userdata</span>.<span class="hljs-property">callback</span> = jsonId.<span class="hljs-property">funId</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> <span class="hljs-title class_">Userdata</span>) &#123;<br>            <span class="hljs-title class_">Userurl</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">jointUrl</span>(<span class="hljs-title class_">Userurl</span>, key, <span class="hljs-title class_">Userdata</span>[key])<br>        &#125;<br>        <span class="hljs-keyword">let</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;script&#x27;</span>);<br>        script.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;id&quot;</span> , jsonId.<span class="hljs-property">funId</span>);<br>        script.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;src&quot;</span> , <span class="hljs-title class_">Userurl</span>);<br>        <span class="hljs-comment">//动态生成函数</span><br>        <span class="hljs-keyword">let</span> callback=<span class="hljs-keyword">function</span> (<span class="hljs-params">result</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;xxxxxxx&quot;</span>)<br>            <span class="hljs-comment">//业务逻辑回调</span><br>            <span class="hljs-keyword">if</span> (options.<span class="hljs-property">callback</span>)&#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    options.<span class="hljs-title function_">callback</span>(result)<br>                &#125;<span class="hljs-keyword">catch</span> (e) &#123;<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">err</span>(e.<span class="hljs-property">message</span>)<br>                &#125;<br>            &#125;<br>            <span class="hljs-comment">//善后</span><br>            <span class="hljs-keyword">let</span> tmp=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(jsonId.<span class="hljs-property">funId</span>)<br>            tmp.<span class="hljs-property">parentNode</span>.<span class="hljs-title function_">removeChild</span>(tmp);<br>            <span class="hljs-built_in">eval</span>(jsonId.<span class="hljs-property">funId</span>+<span class="hljs-string">&#x27;=null&#x27;</span>)<br>        &#125;<br>        <span class="hljs-built_in">eval</span>(<span class="hljs-string">&quot;window.&quot;</span>+jsonId.<span class="hljs-property">funId</span>+<span class="hljs-string">&quot;=function(result)&#123; callback(result) &#125;&quot;</span>)<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(script)<br><br>    &#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><h2 id="cors">2、CORS</h2><p>1、<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS">CORS文档链接</a></p><p>2、CORS是什么?</p><p>CORS（Cross-Origin Resource Sharing），跨域资源共享。CORS 是官方的跨域解决方 案，它的特点是不需要在客户端做任何特殊的操作，完全在服务器中进行处理，支持 get 和 post 请求。跨域资源共享标准新增了一组 HTTP 首部字段，允许服务器声明哪些 源站通过浏览器有权限访问哪些资源</p><p>3、CORS是怎么工作的?</p><p>CORS 是通过设置一个响应头来告诉浏览器，该请求允许跨域，浏览器收到该响应 以后就会对响应放行。</p><h3 id="代码示例">Ⅰ-代码示例</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js">app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/cors-server&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">//设置响应头</span><br>    <span class="hljs-comment">//响应首部中可以携带一个 Access-Control-Allow-Origin 字段</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="hljs-string">&quot;*&quot;</span>);<br>    <span class="hljs-comment">//Access-Control-Allow-Headers 首部字段用于预检请求的响应。其指明了实际请求中允许携带的首部字</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>    <span class="hljs-comment">//Access-Control-Allow-Methods 首部字段用于预检请求的响应。其指明了实际请求所允许使用的 HTTP</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;Access-Control-Allow-Method&quot;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  <span class="hljs-comment">// response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;http://127.0.0.1:5500&quot;);</span><br>  response.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;hello CORS&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="http-响应首部字段">Ⅱ-<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS#http_响应首部字段">HTTP 响应首部字段</a></h3><p>本节列出了规范所定义的响应首部字段。上一小节中，我们已经看到了这些首部字段在实际场景中是如何工作的。</p><h4 id="access-control-allow-origin">1、<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS#access-control-allow-origin">Access-Control-Allow-Origin</a></h4><p>响应首部中可以携带一个 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Origin"><code>Access-Control-Allow-Origin</code></a> 字段，其语法如下:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Origin</span>: &lt;origin&gt; | *<br></code></pre></td></tr></table></figure><p>其中，origin 参数的值指定了允许访问该资源的外域 URI。对于不需要携带身份凭证的请求，服务器可以指定该字段的值为通配符，表示允许来自所有域的请求。</p><p>例如，下面的字段值将允许来自 http://mozilla.com 的请求：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Origin</span>: <span class="hljs-attr">http</span>:<span class="hljs-comment">//mozilla.com</span><br></code></pre></td></tr></table></figure><p>如果服务端指定了具体的域名而非“*”，那么响应首部中的 Vary 字段的值必须包含 Origin。这将告诉客户端：服务器对不同的源站返回不同的内容。</p><h4 id="access-control-expose-headers">2、<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS#access-control-expose-headers">Access-Control-Expose-Headers</a></h4><p>译者注：在跨源访问时，XMLHttpRequest对象的getResponseHeader()方法只能拿到一些最基本的响应头，Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma，如果要访问其他头，则需要服务器设置本响应头。</p><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Expose-Headers"><code>Access-Control-Expose-Headers</code></a> 头让服务器把允许浏览器访问的头放入白名单，例如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Expose</span>-<span class="hljs-title class_">Headers</span>: X-<span class="hljs-title class_">My</span>-<span class="hljs-title class_">Custom</span>-<span class="hljs-title class_">Header</span>, X-<span class="hljs-title class_">Another</span>-<span class="hljs-title class_">Custom</span>-<span class="hljs-title class_">Header</span><br></code></pre></td></tr></table></figure><p>这样浏览器就能够通过getResponseHeader访问<code>X-My-Custom-Header</code>和 <code>X-Another-Custom-Header</code> 响应头了。</p><h4 id="access-control-max-age">3、<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS#access-control-max-age">Access-Control-Max-Age</a></h4><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Max-Age"><code>Access-Control-Max-Age</code></a> 头指定了preflight请求的结果能够被缓存多久，请参考本文在前面提到的preflight例子。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Max</span>-<span class="hljs-title class_">Age</span>: &lt;delta-seconds&gt;<br></code></pre></td></tr></table></figure><p><code>delta-seconds</code> 参数表示preflight请求的结果在多少秒内有效。</p><h4 id="access-control-allow-credentials">4、<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS#access-control-allow-credentials">Access-Control-Allow-Credentials</a></h4><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials"><code>Access-Control-Allow-Credentials</code></a> 头指定了当浏览器的<code>credentials</code>设置为true时是否允许浏览器读取response的内容。当用在对preflight预检测请求的响应中时，它指定了实际的请求是否可以使用<code>credentials</code>。请注意：简单 GET 请求不会被预检；如果对此类请求的响应中不包含该字段，这个响应将被忽略掉，并且浏览器也不会将相应内容返回给网页。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Credentials</span>: <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><h4 id="access-control-allow-methods">5、<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS#access-control-allow-methods">Access-Control-Allow-Methods</a></h4><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Methods"><code>Access-Control-Allow-Methods</code></a> 首部字段用于预检请求的响应。其指明了实际请求所允许使用的 HTTP 方法。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Methods</span>: &lt;method&gt;[, &lt;method&gt;]*<br></code></pre></td></tr></table></figure><h4 id="access-control-allow-headers">6、<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS#access-control-allow-headers">Access-Control-Allow-Headers</a></h4><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Headers"><code>Access-Control-Allow-Headers</code></a> 首部字段用于预检请求的响应。其指明了实际请求中允许携带的首部字段。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Allow</span>-<span class="hljs-title class_">Headers</span>: &lt;field-name&gt;[, &lt;field-name&gt;]*<br></code></pre></td></tr></table></figure><h3 id="http-请求首部字段">Ⅲ-<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS#http_请求首部字段">HTTP 请求首部字段</a></h3><p>本节列出了可用于发起跨源请求的首部字段。请注意，这些首部字段无须手动设置。 当开发者使用 XMLHttpRequest 对象发起跨源请求时，它们已经被设置就绪。</p><h4 id="origin">1、<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS#origin">Origin</a></h4><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Origin"><code>Origin</code></a> 首部字段表明预检请求或实际请求的源站。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Origin</span>: &lt;origin&gt;<br></code></pre></td></tr></table></figure><p>origin 参数的值为源站 URI。它不包含任何路径信息，只是服务器名称。</p><p><strong>Note:</strong> 有时候将该字段的值设置为空字符串是有用的，例如，当源站是一个 data URL 时。</p><p>注意，在所有访问控制请求（Access control request）中，<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Origin"><code>Origin</code></a> 首部字段<strong>总是</strong>被发送</p><h4 id="access-control-request-method">2、<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS#access-control-request-method">Access-Control-Request-Method</a></h4><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Request-Method"><code>Access-Control-Request-Method</code></a> 首部字段用于预检请求。其作用是，将实际请求所使用的 HTTP 方法告诉服务器。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Request</span>-<span class="hljs-title class_">Method</span>: &lt;method&gt;<br></code></pre></td></tr></table></figure><h4 id="access-control-request-headers">3、<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS#access-control-request-headers">Access-Control-Request-Headers</a></h4><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Request-Headers"><code>Access-Control-Request-Headers</code></a> 首部字段用于预检请求。其作用是，将实际请求所携带的首部字段告诉服务器。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Access</span>-<span class="hljs-title class_">Control</span>-<span class="hljs-title class_">Request</span>-<span class="hljs-title class_">Headers</span>: &lt;field-name&gt;[, &lt;field-name&gt;]*<br></code></pre></td></tr></table></figure><hr><hr><h1 id="五服务端代码示例">五、服务端代码示例</h1><p>配合以上前端代码的服务端代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//1. 引入express</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><br><span class="hljs-comment">//2. 创建应用对象</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br><br><span class="hljs-comment">//3. 创建路由规则</span><br><span class="hljs-comment">// request 是对请求报文的封装</span><br><span class="hljs-comment">// response 是对响应报文的封装</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/server&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">//设置响应头  设置允许跨域</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  <span class="hljs-comment">//设置响应体</span><br>  response.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;HELLO AJAX - 2&#x27;</span>);<br>&#125;);<br><br><span class="hljs-comment">//可以接收任意类型的请求 </span><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/server&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">//设置响应头  设置允许跨域</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  <span class="hljs-comment">//响应头</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  <span class="hljs-comment">//设置响应体</span><br>  response.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;HELLO AJAX POST&#x27;</span>);<br>&#125;);<br><br><span class="hljs-comment">//JSON 响应</span><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/json-server&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">//设置响应头  设置允许跨域</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  <span class="hljs-comment">//响应头</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  <span class="hljs-comment">//响应一个数据</span><br>  <span class="hljs-keyword">const</span> data = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;atguigu&#x27;</span><br>  &#125;;<br>  <span class="hljs-comment">//对对象进行字符串转换</span><br>  <span class="hljs-keyword">let</span> str = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data);<br>  <span class="hljs-comment">//设置响应体</span><br>  response.<span class="hljs-title function_">send</span>(str);<br>&#125;);<br><br><span class="hljs-comment">//针对 IE 缓存</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/ie&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">//设置响应头  设置允许跨域</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  <span class="hljs-comment">//设置响应体</span><br>  response.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;HELLO IE - 5&#x27;</span>);<br>&#125;);<br><br><span class="hljs-comment">//延时响应</span><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/delay&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">//设置响应头  设置允许跨域</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">//设置响应体</span><br>    response.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;延时响应&#x27;</span>);<br>  &#125;, <span class="hljs-number">1000</span>)<br>&#125;);<br><br><span class="hljs-comment">//jQuery 服务</span><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/jquery-server&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">//设置响应头  设置允许跨域</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  <span class="hljs-comment">// response.send(&#x27;Hello jQuery AJAX&#x27;);</span><br>  <span class="hljs-keyword">const</span> data = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;尚硅谷&#x27;</span><br>  &#125;;<br>  response.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));<br>&#125;);<br><br><span class="hljs-comment">//axios 服务</span><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/axios-server&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">//设置响应头  设置允许跨域</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  <span class="hljs-comment">// response.send(&#x27;Hello jQuery AJAX&#x27;);</span><br>  <span class="hljs-keyword">const</span> data = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;尚硅谷&#x27;</span><br>  &#125;;<br>  response.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));<br>&#125;);<br><br><span class="hljs-comment">//fetch 服务</span><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/fetch-server&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">//设置响应头  设置允许跨域</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  <span class="hljs-comment">// response.send(&#x27;Hello jQuery AJAX&#x27;);</span><br>  <span class="hljs-keyword">const</span> data = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;尚硅谷&#x27;</span><br>  &#125;;<br>  response.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));<br>&#125;);<br><br><span class="hljs-comment">//jsonp服务</span><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/jsonp-server&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// response.send(&#x27;console.log(&quot;hello jsonp&quot;)&#x27;);</span><br>  <span class="hljs-keyword">const</span> data = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;尚硅谷atguigu&#x27;</span><br>  &#125;;<br>  <span class="hljs-comment">//将数据转化为字符串</span><br>  <span class="hljs-keyword">let</span> str = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data);<br>  <span class="hljs-comment">//返回结果</span><br>  response.<span class="hljs-title function_">end</span>(<span class="hljs-string">`handle(<span class="hljs-subst">$&#123;str&#125;</span>)`</span>);<br>&#125;);<br><br><span class="hljs-comment">//用户名检测是否存在</span><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/check-username&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// response.send(&#x27;console.log(&quot;hello jsonp&quot;)&#x27;);</span><br>  <span class="hljs-keyword">const</span> data = &#123;<br>    <span class="hljs-attr">exist</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;用户名已经存在&#x27;</span><br>  &#125;;<br>  <span class="hljs-comment">//将数据转化为字符串</span><br>  <span class="hljs-keyword">let</span> str = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data);<br>  <span class="hljs-comment">//返回结果</span><br>  response.<span class="hljs-title function_">end</span>(<span class="hljs-string">`handle(<span class="hljs-subst">$&#123;str&#125;</span>)`</span>);<br>&#125;);<br><br><span class="hljs-comment">//</span><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/jquery-jsonp-server&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// response.send(&#x27;console.log(&quot;hello jsonp&quot;)&#x27;);</span><br>  <span class="hljs-keyword">const</span> data = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;尚硅谷&#x27;</span>,<br>    <span class="hljs-attr">city</span>: [<span class="hljs-string">&#x27;北京&#x27;</span>, <span class="hljs-string">&#x27;上海&#x27;</span>, <span class="hljs-string">&#x27;深圳&#x27;</span>]<br>  &#125;;<br>  <span class="hljs-comment">//将数据转化为字符串</span><br>  <span class="hljs-keyword">let</span> str = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data);<br>  <span class="hljs-comment">//接收 callback 参数</span><br>  <span class="hljs-keyword">let</span> cb = request.<span class="hljs-property">query</span>.<span class="hljs-property">callback</span>;<br><br>  <span class="hljs-comment">//返回结果</span><br>  response.<span class="hljs-title function_">end</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;cb&#125;</span>(<span class="hljs-subst">$&#123;str&#125;</span>)`</span>);<br>&#125;);<br><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/cors-server&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">//设置响应头</span><br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="hljs-string">&quot;*&quot;</span>);<br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  response.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;Access-Control-Allow-Method&quot;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>  <span class="hljs-comment">// response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;http://127.0.0.1:5500&quot;);</span><br>  response.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;hello CORS&#x27;</span>);<br>&#125;);<br><br><span class="hljs-comment">//4. 监听端口启动服务</span><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">8000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;服务已经启动, 8000 端口监听中....&quot;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://Unicorn-acc.github.io">Miraclo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://unicorn-acc.github.io/posts/30150.html">http://unicorn-acc.github.io/posts/30150.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://Unicorn-acc.github.io" target="_blank">Miraclo</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ajax/">ajax</a></div><div class="post_share"><div class="social-share" data-image="https://w.wallhaven.cc/full/1p/wallhaven-1pjml1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/52919.html"><img class="prev-cover" src="https://w.wallhaven.cc/full/x6/wallhaven-x619o3.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">硅谷权限系统-03-角色管理前端</div></div></a></div><div class="next-post pull-right"><a href="/posts/13474.html"><img class="next-cover" src="https://w.wallhaven.cc/full/p9/wallhaven-p9273e.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">硅谷权限系统-02-前端基础知识、Nodejs、NPM、前端模块化开发ES6</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%B4%E6%98%8E"><span class="toc-text">说明</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-text">目录</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80ajax%E7%AE%80%E4%BB%8B"><span class="toc-text">一、Ajax简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#xml%E7%AE%80%E4%BB%8B"><span class="toc-text">1、XML简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ajax%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-text">2、Ajax的特点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ajax-%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-text">Ⅰ-AJAX 的优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ajax%E7%9A%84%E7%BC%BA%E7%82%B9"><span class="toc-text">Ⅱ-Ajax的缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#http%E7%AE%80%E4%BB%8B"><span class="toc-text">3、HTTP简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87"><span class="toc-text">Ⅰ-请求报文</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87"><span class="toc-text">Ⅱ-响应报文</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#chrome%E7%BD%91%E7%BB%9C%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%9F%A5%E7%9C%8B%E9%80%9A%E4%BF%A1%E6%8A%A5%E6%96%87"><span class="toc-text">Ⅲ-Chrome网络控制台查看通信报文</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E5%8E%9F%E7%94%9Fajax"><span class="toc-text">二、原生Ajax</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ajax%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">〇-Ajax的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#get%E6%96%B9%E5%BC%8F"><span class="toc-text">Ⅰ-Get方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#post%E6%96%B9%E5%BC%8F"><span class="toc-text">Ⅱ-Post方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3ie%E7%BC%93%E5%AD%98%E9%97%AE%E9%A2%98"><span class="toc-text">Ⅲ-解决ie缓存问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E8%B6%85%E6%97%B6%E4%B8%8E%E7%BD%91%E7%BB%9C%E5%BC%82%E5%B8%B8"><span class="toc-text">Ⅳ-请求超时与网络异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82"><span class="toc-text">Ⅴ-取消请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%A4%8D%E8%AF%B7%E6%B1%82%E9%97%AE%E9%A2%98"><span class="toc-text">Ⅵ-重复请求问题</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E5%B8%B8%E8%A7%81%E4%B8%89%E7%A7%8Dajax%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F"><span class="toc-text">三、常见三种Ajax请求方式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#jquery%E5%8F%91%E9%80%81ajax%E8%AF%B7%E6%B1%82"><span class="toc-text">1、jQuery发送AJAX请求</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#get"><span class="toc-text">Ⅰ-$.get()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#post"><span class="toc-text">Ⅱ-$.post()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ajax"><span class="toc-text">Ⅲ-$.ajax</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#axios%E5%8F%91%E9%80%81ajax%E8%AF%B7%E6%B1%82"><span class="toc-text">2、Axios发送AJAX请求</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#axios.get"><span class="toc-text">Ⅰ-axios.get()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#axios.post"><span class="toc-text">Ⅱ-axios.post()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#axios-%E5%87%BD%E6%95%B0%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%E5%B8%B8%E7%94%A8"><span class="toc-text">Ⅲ-✨axios() 函数发送请求（常用）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fetch%E5%8F%91%E9%80%81ajax%E8%AF%B7%E6%B1%82"><span class="toc-text">3、Fetch发送AJAX请求</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E8%B7%A8%E5%9F%9F%E4%B8%8E%E8%A7%A3%E5%86%B3"><span class="toc-text">四、跨域与解决</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#jsonp"><span class="toc-text">1、jsonP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#jsonp%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">Ⅰ-jsonP的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jquery%E5%8F%91%E9%80%81jsonp%E8%AF%B7%E6%B1%82"><span class="toc-text">Ⅱ-jQuery发送jsonP请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E8%87%AA%E5%B7%B1%E5%BC%80%E5%8F%91%E5%B0%81%E8%A3%85%E7%9A%84jsonp%E6%8F%92%E4%BB%B6"><span class="toc-text">Ⅲ-我自己开发封装的jsonP插件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cors"><span class="toc-text">2、CORS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="toc-text">Ⅰ-代码示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http-%E5%93%8D%E5%BA%94%E9%A6%96%E9%83%A8%E5%AD%97%E6%AE%B5"><span class="toc-text">Ⅱ-HTTP 响应首部字段</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#access-control-allow-origin"><span class="toc-text">1、Access-Control-Allow-Origin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#access-control-expose-headers"><span class="toc-text">2、Access-Control-Expose-Headers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#access-control-max-age"><span class="toc-text">3、Access-Control-Max-Age</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#access-control-allow-credentials"><span class="toc-text">4、Access-Control-Allow-Credentials</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#access-control-allow-methods"><span class="toc-text">5、Access-Control-Allow-Methods</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#access-control-allow-headers"><span class="toc-text">6、Access-Control-Allow-Headers</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http-%E8%AF%B7%E6%B1%82%E9%A6%96%E9%83%A8%E5%AD%97%E6%AE%B5"><span class="toc-text">Ⅲ-HTTP 请求首部字段</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#origin"><span class="toc-text">1、Origin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#access-control-request-method"><span class="toc-text">2、Access-Control-Request-Method</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#access-control-request-headers"><span class="toc-text">3、Access-Control-Request-Headers</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="toc-text">五、服务端代码示例</span></a></li></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By Miraclo</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">人只有在走上坡路的时候才会累和迷茫。</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if(window.MathJax)MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset();else{window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],tags:"ams"},chtml:{scale:1.1},options:{renderActions:{findScript:[10,t=>{for(const n of document.querySelectorAll('script[type^="math/tex"]')){var e=!!n.type.match(/; *mode=display/),e=new t.options.MathItem(n.textContent,t.inputJax[0],e),a=document.createTextNode("");n.parentNode.replaceChild(a,n),e.start={node:a,delim:"",n:0},e.end={node:a,delim:"",n:0},t.math.push(e)}},""],insertScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(t=>{t.hasAttribute("display")?btf.wrap(t,"div",{class:"mathjax-overflow"}):btf.wrap(t,"span",{class:"mathjax-overflow"})})},"",!1]}}};const a=document.createElement("script");a.src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js",a.id="MathJax-script",a.async=!0,document.head.appendChild(a)}</script></div><link rel="stylesheet" href="/css/Lete.css"><script src="/js/custom.js"></script><script src="/js/mouth.js"></script><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div class="js-pjax"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration","1s"),arr[i].setAttribute("data-wow-delay","1ms"),arr[i].setAttribute("data-wow-offset","100"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script></body></html>